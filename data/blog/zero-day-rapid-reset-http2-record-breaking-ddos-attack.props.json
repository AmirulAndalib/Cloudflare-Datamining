{
	"post": {
		"id": "652490e57a356a000a77ada2",
		"uuid": "8f40972d-79cf-489e-872d-78047959c618",
		"title": "HTTP/2 Zero-Day vulnerability results in record-breaking DDoS attacks",
		"slug": "zero-day-rapid-reset-http2-record-breaking-ddos-attack",
		"html": "<!--kg-card-begin: markdown--><p><small>This post is also available in <a href=\"http://blog.cloudflare.com/zh-cn/zero-day-rapid-reset-http2-record-breaking-ddos-attack-zh-cn/\">简体中文</a>, <a href=\"http://blog.cloudflare.com/zh-tw/zero-day-rapid-reset-http2-record-breaking-ddos-attack-zh-tw/\">繁體中文</a>, <a href=\"http://blog.cloudflare.com/ja-jp/zero-day-rapid-reset-http2-record-breaking-ddos-attack-ja-jp/\">日本語</a>, <a href=\"http://blog.cloudflare.com/ko-kr/zero-day-rapid-reset-http2-record-breaking-ddos-attack-ko-kr/\">한국어</a>, <a href=\"http://blog.cloudflare.com/de-de/zero-day-rapid-reset-http2-record-breaking-ddos-attack-de-de/\">Deutsch</a>, <a href=\"http://blog.cloudflare.com/fr-fr/zero-day-rapid-reset-http2-record-breaking-ddos-attack-fr-fr/\">Français</a> and <a href=\"http://blog.cloudflare.com/es-es/zero-day-rapid-reset-http2-record-breaking-ddos-attack-es-es/\">Español</a>.</small></p>\n<!--kg-card-end: markdown--><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2023/10/Screenshot-2023-10-09-at-10.41.56-PM.png\" class=\"kg-image\" alt loading=\"lazy\" width=\"1150\" height=\"612\"></figure><p>Earlier today, Cloudflare, along with Google and Amazon AWS, disclosed the existence of a novel zero-day vulnerability dubbed the “HTTP/2 Rapid Reset” attack. This attack exploits a weakness in the HTTP/2 protocol to generate enormous, hyper-volumetric Distributed Denial of Service (DDoS) attacks. Cloudflare has mitigated a barrage of these attacks in recent months, including an attack three times larger than <a href=\"http://blog.cloudflare.com/cloudflare-mitigates-record-breaking-71-million-request-per-second-ddos-attack/\">any previous attack we’ve observed</a>, which exceeded 201 million requests per second (rps). Since the end of August 2023, Cloudflare has mitigated more than 1,100 other attacks with over 10 million rps — and 184 attacks that were greater than our previous DDoS record of 71 million rps. </p><!--kg-card-begin: html--><center><em><small>Under attack or need additional protection? <a href=https://www.cloudflare.com/h2/>Click here to get help</a>.</small></em></center><br><!--kg-card-end: html--><p>This zero-day provided threat actors with a critical new tool in their Swiss Army knife of vulnerabilities to exploit and attack their victims at a magnitude that has never been seen before. While at times complex and challenging to combat, these attacks allowed Cloudflare the opportunity to develop purpose-built technology to mitigate the effects of the zero-day vulnerability.</p><p>If you are using Cloudflare for HTTP DDoS mitigation, you are protected. And below, we’ve included more information on this vulnerability, and resources and recommendations on what you can do to secure yourselves.</p><h3 id=\"deconstructing-the-attack-what-every-cso-needs-to-know\">Deconstructing the attack: What every CSO needs to know</h3><p>In late August 2023, our team at Cloudflare noticed a new zero-day vulnerability, developed by an unknown threat actor, that exploits the standard HTTP/2 protocol — a fundamental protocol that is critical to how the Internet and all websites work. This novel zero-day vulnerability attack, dubbed Rapid Reset, leverages HTTP/2’s stream cancellation feature by sending a request and immediately canceling it over and over.  </p><p>By automating this trivial “request, cancel, request, cancel” pattern at scale, threat actors are able to create a denial of service and take down any server or application running the standard implementation of HTTP/2. Furthermore, one crucial thing to note about the record-breaking attack is that it involved a modestly-sized botnet, consisting of roughly 20,000 machines. Cloudflare regularly detects botnets that are orders of magnitude larger than this — comprising hundreds of thousands and even millions of machines. For a relatively small botnet to output such a large volume of requests, with the potential to incapacitate nearly any server or application supporting HTTP/2, underscores how menacing this vulnerability is for unprotected networks.</p><p></p><!--kg-card-begin: html--><a href=\"https://www.cloudflare.com/the-net/?utm_campaign=thenet&utm_medium=blog\">\n  <img src=\"http://blog.cloudflare.com/content/images/2023/12/theNET_blog_1-1.png\" alt=\"theNET\">\n</a><!--kg-card-end: html--><p></p><p>Threat actors used botnets in tandem with the HTTP/2 vulnerability to amplify requests at rates we have never seen before. As a result, our team at Cloudflare experienced some intermittent edge instability. While our systems were able to mitigate the overwhelming majority of incoming attacks, the volume overloaded some components in our network, impacting a small number of customers’ performance with intermittent 4xx and 5xx errors — all of which were quickly resolved. </p><p>Once we successfully mitigated these issues and halted potential attacks for all customers, our team immediately kicked off a responsible disclosure process. We entered into conversations with industry peers to see how we could work together to help move our mission forward and safeguard the large percentage of the Internet that relies on our network prior to releasing this vulnerability to the general public. </p><p>We cover the technical details of the attack in more detail in a separate blog post: <a href=\"https://cfl.re/rapid-reset-breakdown\">HTTP/2 Rapid Reset: deconstructing the record-breaking attack</a>.</p><h3 id=\"how-is-cloudflare-and-the-industry-thwarting-this-attack\">How is Cloudflare and the industry thwarting this attack?</h3><p>There is no such thing as a “perfect disclosure.” Thwarting attacks and responding to emerging incidents requires organizations and security teams to live by an assume-breach mindset — because there will always be another zero-day, new evolving threat actor groups, and never-before-seen novel attacks and techniques. </p><p>This “assume-breach” mindset is a key foundation towards information sharing and ensuring in instances such as this that the Internet remains safe. While Cloudflare was experiencing and mitigating these attacks, we were also working with industry partners to guarantee that the industry at-large could withstand this attack.  </p><p>During the process of mitigating this attack, our Cloudflare team developed and purpose-built new technology to stop these DDoS attacks and further improve our own mitigations for this and other future attacks of massive scale. These efforts have significantly increased our overall mitigation capabilities and resiliency. If you are using Cloudflare, we are confident that you are protected. </p><p>Our team also alerted web server software partners who are developing patches to ensure this vulnerability cannot be exploited — check their websites for more information.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2023/10/Zero-Day-protection-4.png\" class=\"kg-image\" alt loading=\"lazy\" width=\"1600\" height=\"416\"></figure><p>Disclosures are never one and done. The lifeblood of Cloudflare is to ensure a better Internet, which stems from instances such as these. When we have the opportunity to work with our industry partners and governments to ensure there are no widespread impacts on the Internet, we are doing our part in increasing the cyber resiliency of every organization no matter the size or vertical.</p><p>To gain more of an understanding around mitigation tactics and next steps on patching, <a href=\"https://event.on24.com/wcc/r/4378646/EC4EB4A6CE2B363BC6378891E495BEBF\">register for our webinar</a>.</p><h3 id=\"what-are-the-origins-of-the-http2-rapid-reset-and-these-record-breaking-attacks-on-cloudflare\">What are the origins of the HTTP/2 Rapid Reset and these record-breaking attacks on Cloudflare?</h3><p>It may seem odd that Cloudflare was one of the first companies to witness these attacks. Why would threat actors attack a company that has some of the most robust defenses against DDoS attacks in the world?  </p><p>The reality is that Cloudflare often sees attacks before they are turned on more vulnerable targets. Threat actors need to develop and test their tools before they deploy them in the wild. Threat actors who possess record-shattering attack methods can have an extremely difficult time testing and understanding how large and effective they are, because they don't have the infrastructure to absorb the attacks they are launching. Because of the transparency that we share on our network performance, and the measurements of attacks they could glean from our public performance charts, this threat actor was likely targeting us to understand the capabilities of the exploit.</p><p>But that testing, and the ability to see the attack early, helps us develop mitigations for the attack that benefit both our customers and industry as a whole.</p><h3 id=\"from-cso-to-cso-what-should-you-do\">From CSO to CSO: What should you do?</h3><p>I have been a CSO for over 20 years, on the receiving end of countless disclosures and  announcements like this. But whether it was <a href=\"http://blog.cloudflare.com/exploitation-of-cve-2021-44228-before-public-disclosure-and-evolution-of-waf-evasion-patterns/\">Log4J</a>, <a href=\"http://blog.cloudflare.com/solarwinds-orion-compromise-trend-data/\">Solarwinds</a>, <a href=\"https://www.cloudflare.com/learning/security/ransomware/how-to-prevent-ransomware/\">EternalBlue</a> <a href=\"https://www.cloudflare.com/learning/security/ransomware/petya-notpetya-ransomware/\">WannaCry/NotPetya</a>, <a href=\"http://blog.cloudflare.com/heartbleed-revisited/\">Heartbleed</a>, or <a href=\"http://blog.cloudflare.com/inside-shellshock/\">Shellshock</a>, all of these security incidents have a commonality. A tremendous explosion that ripples across the world and creates an opportunity to completely disrupt any of the organizations that I have led — regardless of the industry or the size. </p><p>Many of these were attacks or vulnerabilities that we may have not been able to control. But regardless of whether the issue arose from something that was in my control or not, what has set any successful initiative I have led apart from those that did not lean in our favor was the ability to respond when zero-day vulnerabilities and exploits like this are identified.    </p><p>While I wish I could say that Rapid Reset may be different this time around, it is not. I am calling all CSOs — no matter if you’ve lived through the decades of security incidents that I have, or this is your first day on the job — this is the time to<a href=\"https://www.cloudflare.com/products/zero-trust/threat-defense/\"> ensure you are protected</a> and stand up your cyber incident response team. </p><p>We’ve kept the information restricted until today to give as many security vendors as possible the opportunity to react. However, at some point, the responsible thing becomes to publicly disclose zero-day threats like this. Today is that day. That means that after today, threat actors will be largely aware of the HTTP/2 vulnerability; and it will inevitably become trivial to exploit and kickoff the race between defenders and attacks — first to patch vs. first to exploit. Organizations should assume that systems will be tested, and take proactive measures to ensure protection.</p><p>To me, this is reminiscent of a vulnerability like Log4J, due to the many variants that are emerging daily, and will continue to come to fruition in the weeks, months, and years to come. As more researchers and threat actors experiment with the vulnerability, we may find different variants with even shorter exploit cycles that contain even more advanced bypasses.  </p><p>And just like Log4J, managing incidents like this isn’t as simple as “run the patch, now you’re done”. You need to turn incident management, patching, and evolving your security protections into ongoing processes — because the patches for each variant of a vulnerability reduce your risk, but they don’t eliminate it.</p><p>I don’t mean to be alarmist, but I will be direct: you must take this seriously. Treat this as a full active incident to ensure nothing happens to your organization.</p><h3 id=\"recommendations-for-a-new-standard-of-change\">Recommendations for a New Standard of Change</h3><p>While no one security event is ever identical to the next, there are lessons that can be learned. CSOs, here are my recommendations that must be implemented immediately. Not only in this instance, but for years to come:</p><ul><li>Understand your external and partner network’s external connectivity to remediate any Internet facing systems with the mitigations below.</li><li>Understand your existing security protection and capabilities you have to protect, detect and respond to an attack and immediately remediate any issues you have in your network.</li><li>Ensure your DDoS Protection resides outside of your data center because if the traffic gets to your datacenter, it will be difficult to mitigate the DDoS attack.</li><li>Ensure you have DDoS protection for Applications (Layer 7) and ensure you have Web Application Firewalls. Additionally as a best practice, ensure you have complete DDoS protection for DNS, Network Traffic (Layer 3) and API Firewalls</li><li>Ensure web server and operating system patches are deployed across all Internet Facing Web Servers. Also, ensure all automation like Terraform builds and images are fully patched so older versions of web servers are not deployed into production over the secure images by accident.</li><li>As a last resort, consider turning off HTTP/2 and HTTP/3 (likely also vulnerable) to mitigate the threat.  This is a last resort only, because there will be a significant performance issues if you downgrade to HTTP/1.1</li><li>Consider a secondary, cloud-based DDoS L7 provider at perimeter for resilience.</li></ul><p>Cloudflare’s mission is to help build a better Internet. If you are concerned with your current state of DDoS protection, we are more than happy to provide you with our DDoS capabilities and resilience for free to mitigate any attempts of a successful DDoS attack.  We know the stress that you are facing as we have fought off these attacks for the last 30 days and made our already best in class systems, even better. </p><p>If you’re interested in finding out more, <a href=\"https://event.on24.com/wcc/r/4378646/EC4EB4A6CE2B363BC6378891E495BEBF\">view our webinar</a> on the details of the zero-day and how to respond. <a href=\"https://www.cloudflare.com/h2/\">Contact us</a> if you’re unsure whether you’re protected or want to understand how you can be. We also have more technical details of the attack in more detail in a separate blog post: <a href=\"https://cfl.re/rapid-reset-breakdown\">HTTP/2 Rapid Reset: deconstructing the record-breaking attack</a>. Finally, if you’re being targeted or need immediate protection, please contact your local Cloudflare representative or visit <a href=\"https://www.cloudflare.com/under-attack-hotline/\">https://www.cloudflare.com/under-attack-hotline/</a>. </p>",
		"comment_id": "652490e57a356a000a77ada2",
		"feature_image": "http://blog.cloudflare.com/content/images/2023/10/Screenshot-2023-10-09-at-10.41.56-PM-1.png",
		"featured": false,
		"visibility": "public",
		"created_at": "2023-10-10T00:46:45.000+01:00",
		"updated_at": "2024-03-14T14:52:18.000+00:00",
		"published_at": "2023-10-10T13:02:09.000+01:00",
		"custom_excerpt": "The “HTTP/2 Rapid Reset” attack exploits a weakness in the HTTP/2 protocol to generate enormous, hyper-volumetric DDoS attacks. Cloudflare has mitigated a barrage of these attacks in recent months, including an attack three times larger than any previous attack we’ve observed",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "64414e272e6788000a880bd3",
				"name": "Grant Bourzikas",
				"slug": "grant",
				"profile_image": "http://blog.cloudflare.com/content/images/2023/04/Headshot---GB_LinkedIn.jpg",
				"cover_image": null,
				"bio": null,
				"website": null,
				"location": "https://www.linkedin.com/in/grantbourzikas/",
				"facebook": null,
				"twitter": "@GrantBourzikas",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/grant/"
			}
		],
		"tags": [
			{
				"id": "6524e4317a356a000a77aeab",
				"name": "#BLOG-2133",
				"slug": "hash-blog-2133",
				"description": null,
				"feature_image": null,
				"visibility": "internal",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/404/"
			},
			{
				"id": "5d16450341acde0011a95265",
				"name": "Security",
				"slug": "security",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Security.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Security",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Security'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/security/"
			},
			{
				"id": "5d16450341acde0011a951aa",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities",
				"description": "Vulnerabilities (EN)",
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/vulnerabilities/"
			},
			{
				"id": "5d16450341acde0011a95169",
				"name": "Attacks",
				"slug": "attacks",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/attacks/"
			},
			{
				"id": "5d16450341acde0011a951e3",
				"name": "DDoS",
				"slug": "ddos",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/ddos/"
			},
			{
				"id": "65972b26aa281c000a8acc51",
				"name": "#theNET",
				"slug": "hash-thenet",
				"description": null,
				"feature_image": null,
				"visibility": "internal",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/404/"
			}
		],
		"primary_author": {
			"id": "64414e272e6788000a880bd3",
			"name": "Grant Bourzikas",
			"slug": "grant",
			"profile_image": "http://blog.cloudflare.com/content/images/2023/04/Headshot---GB_LinkedIn.jpg",
			"cover_image": null,
			"bio": null,
			"website": null,
			"location": "https://www.linkedin.com/in/grantbourzikas/",
			"facebook": null,
			"twitter": "@GrantBourzikas",
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/grant/"
		},
		"primary_tag": null,
		"url": "http://blog.cloudflare.com/zero-day-rapid-reset-http2-record-breaking-ddos-attack/",
		"excerpt": "The “HTTP/2 Rapid Reset” attack exploits a weakness in the HTTP/2 protocol to generate enormous, hyper-volumetric DDoS attacks. Cloudflare has mitigated a barrage of these attacks in recent months, including an attack three times larger than any previous attack we’ve observed",
		"reading_time": 8,
		"access": true,
		"comments": false,
		"og_image": "http://blog.cloudflare.com/content/images/2023/10/ZeroDayBlog1-1.png",
		"og_title": null,
		"og_description": null,
		"twitter_image": "http://blog.cloudflare.com/content/images/2023/10/ZeroDayBlog1.png",
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": null,
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	},
	"locale": "en-us"
}