{
	"locale": "en-us",
	"post": {
		"access": true,
		"authors": [
			{
				"id": "61296cb499b32402a7c0e188",
				"name": "Bas Westerbaan",
				"slug": "bas",
				"profile_image": "http://blog.cloudflare.com/content/images/2021/11/me.png",
				"cover_image": null,
				"bio": null,
				"website": "https://bas.westerbaan.name",
				"location": "The Netherlands",
				"facebook": null,
				"twitter": "@bwesterb",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/bas/"
			}
		],
		"canonical_url": null,
		"codeinjection_foot": null,
		"codeinjection_head": null,
		"comment_id": "633aa15f0139ba000afab430",
		"comments": false,
		"created_at": "2022-10-03T09:46:23.000+01:00",
		"custom_excerpt": "Every connection we make post-quantum secure, we remove one opportunity for compromise: that's why we are announcing post-quantum Cloudflare Tunnel to help you secure every connection to our network",
		"custom_template": null,
		"email_subject": null,
		"excerpt": "Every connection we make post-quantum secure, we remove one opportunity for compromise: that's why we are announcing post-quantum Cloudflare Tunnel to help you secure every connection to our network",
		"feature_image": "http://blog.cloudflare.com/content/images/2022/10/image2.png",
		"feature_image_alt": null,
		"feature_image_caption": null,
		"featured": false,
		"frontmatter": null,
		"html": "<!--kg-card-begin: markdown--><p><em><small>This post is also available in <a href=\"http://blog.cloudflare.com/zh-cn/post-quantum-tunnel-zh-cn/\">简体中文</a>, <a href=\"http://blog.cloudflare.com/ja-jp/post-quantum-tunnel-ja-jp/\">日本語</a>, <a href=\"http://blog.cloudflare.com/de-de/post-quantum-tunnel-de-de/\">Deutsch</a>, <a href=\"http://blog.cloudflare.com/fr-fr/post-quantum-tunnel-fr-fr/\">Français</a> and <a href=\"http://blog.cloudflare.com/es-es/post-quantum-tunnel-es-es/\">Español</a>.</small></em></p>\n<!--kg-card-end: markdown--><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2022/10/image2-1.png\" class=\"kg-image\" alt=\"Introducing post-quantum Cloudflare Tunnel\" loading=\"lazy\"></figure><p>Undoubtedly, one of the big themes in IT for the next decade will be <em>the migration</em> to <em>post-quantum cryptography</em>. From tech giants to small businesses: we will all have to make sure our hardware and software is updated so that our data is protected against the arrival of <a href=\"http://blog.cloudflare.com/the-quantum-menace/\">quantum computers</a>. It seems far away, but it’s not a problem for later: any encrypted data captured today (not protected by post-quantum cryptography) can be broken by a sufficiently powerful quantum computer in the future.</p><p>Luckily we’re almost there: after a tremendous worldwide effort by the cryptographic community, <a href=\"http://blog.cloudflare.com/nist-post-quantum-surprise/\">we know</a> what will be the gold standard of post-quantum cryptography for the next decades. Release date: somewhere in 2024. Hopefully, for most, the transition will be a simple software update then, but it will not be that simple for everyone: not all software is maintained, and it could well be that hardware needs an upgrade as well. Taking a step back, many companies don’t even have a full list of all software running on their network.</p><p>For Cloudflare Tunnel customers, this migration will be much simpler: introducing <strong>Post-Quantum</strong> <strong>Cloudflare Tunnel</strong>. In this blog post, first we give an overview of how Cloudflare Tunnel works and explain how it can help you with your post-quantum migration. Then we’ll explain how to get started and finish with the nitty-gritty technical details.</p><h2 id=\"cloudflare-tunnel\">Cloudflare Tunnel</h2><p>With <a href=\"https://www.cloudflare.com/en-gb/products/tunnel/\">Cloudflare Tunnel</a> you can securely expose a server sitting within an internal network to the Internet by running the <a href=\"https://github.com/cloudflare/cloudflared\"><code>cloudflared</code></a> service next to it. For instance, after having installed <a href=\"https://github.com/cloudflare/cloudflared\"><code>cloudflared</code></a> on your internal network, you can expose your on-prem webapp on the Internet under, say example.com, so that <a href=\"https://www.cloudflare.com/products/zero-trust/remote-workforces/\">remote workers</a> can access it from anywhere,</p><figure class=\"kg-card kg-image-card kg-width-wide kg-card-hascaption\"><img src=\"http://blog.cloudflare.com/content/images/2022/10/image1.png\" class=\"kg-image\" alt=\"Life of a Cloudflare Tunnel request.\" loading=\"lazy\"><figcaption>Life of a Cloudflare Tunnel request.</figcaption></figure><p>How does it work? <code>cloudflared</code> creates long-running connections to two nearby Cloudflare data centers, for instance San Francisco (connection 3) and one other. When your employee visits your domain, they connect (1) to a Cloudflare server close to them, say in Frankfurt. That server knows that this is a Cloudflare Tunnel and that your <code>cloudflared</code> has a connection to a server in San Francisco, and thus it relays (2) the request to it. In turn, via the reverse connection, the request ends up at <code>cloudflared</code>, which passes it (4) to the webapp via your internal network.</p><p>In essence, Cloudflare Tunnel is a simple but convenient tool, but the magic is in what you can do on top with it: you get <a href=\"https://www.cloudflare.com/en-gb/ddos/\">Cloudflare’s DDoS protection</a> for free; fine-grained access control with <a href=\"https://www.cloudflare.com/en-gb/products/zero-trust/access/\">Cloudflare Access</a> (even if the application didn’t support it) and <a href=\"https://developers.cloudflare.com/cloudflare-one/analytics/logs/audit-logs/\">request logs</a> just to name a few. And let’s not forget the matter at hand:</p><h2 id=\"post-quantum-tunnels\">Post-quantum tunnels</h2><p>Our goal is to make it easy for everyone to have a fully post-quantum secure connection from users to origin. For this, Post-Quantum Cloudflare Tunnel is a powerful tool, because with it, your users can benefit from a post-quantum secure connection without upgrading your application (connection 4 in the diagram).</p><p>Today, we make two important steps towards this goal: <code>cloudflared</code> <a href=\"https://github.com/cloudflare/cloudflared/releases/tag/2022.9.1\">2022.9.1</a> adds the <code>--post-quantum</code> flag, that when given, makes the connection from <code>cloudflared</code> to our network (connection 3) post-quantum secure.</p><p>Also today, <a href=\"http://blog.cloudflare.com/post-quantum-for-all\">we have announced</a> support for post-quantum browser connections (connection 1).</p><p>We aren’t there yet: browsers (and other HTTP clients) do not support the post-quantum security offered by our network, yet, and we still have to make the connections between our data centers (connection 2) post-quantum secure.</p><p>An attacker only needs to have access to one vulnerable connection, but attackers don’t have access everywhere: with every connection we make post-quantum secure, we remove one opportunity for compromise.</p><p>We are eager to make post-quantum tunnels the default, but for now it is a beta feature. The reason is that the cryptography used and its integration into the network protocol are not yet final. Making post-quantum the default now, would require users to update <code>cloudflared</code> more often than we can reasonably expect them to.</p><h2 id=\"getting-started\">Getting started</h2><p>Are frequent updates to <code>cloudflared</code> not a problem for you? Then please do give post-quantum Cloudflare Tunnel a try. Make sure you’re on at least <a href=\"https://github.com/cloudflare/cloudflared/releases/tag/2022.9.1\">2022.9.1</a> and simply run <code>cloudflared</code> with the <code>--post-quantum</code> flag:</p><!--kg-card-begin: markdown--><pre><code>$ cloudflared tunnel run --post-quantum tunnel-name\n2022-09-23T11:44:42Z INF Starting tunnel tunnelID=[...]\n2022-09-23T11:44:42Z INF Version 2022.9.1\n2022-09-23T11:44:42Z INF GOOS: darwin, GOVersion: go1.19.1, GoArch: amd64\n2022-09-23T11:44:42Z INF Settings: map[post-quantum:true pq:true]\n2022-09-23T11:44:42Z INF Generated Connector ID: [...]\n2022-09-23T11:44:42Z INF cloudflared will not automatically update if installed by a package manager.\n2022-09-23T11:44:42Z INF Initial protocol quic\n2022-09-23T11:44:42Z INF Using experimental hybrid post-quantum key agreement X25519Kyber768Draft00\n2022-09-23T11:44:42Z INF Starting metrics server on 127.0.0.1:53533/metrics\n2022-09-23T11:44:42Z INF Connection [...] registered connIndex=0 ip=[...] location=AMS\n2022-09-23T11:44:43Z INF Connection [...] registered connIndex=1 ip=[...] location=AMS\n2022-09-23T11:44:44Z INF Connection [...] registered connIndex=2 ip=[...] location=AMS\n2022-09-23T11:44:45Z INF Connection [...] registered connIndex=3 ip=[...] location=AMS\n</code></pre>\n<!--kg-card-end: markdown--><p>If you run <code>cloudflared</code> <a href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-guide/local/as-a-service/\">as a service</a>, you can turn on post-quantum by adding <code>post-quantum: true</code> to the tunnel configuration file. Conveniently, the <code>cloudflared</code> service will <a href=\"https://developers.cloudflare.com/cloudflare-one/connections/connect-apps/install-and-setup/tunnel-guide/local/local-management/arguments/#no-autoupdate\">automatically update itself</a> if not installed by a package manager.</p><p>If, for some reason, creating a post-quantum tunnel fails, you’ll see an error message like</p><!--kg-card-begin: markdown--><pre><code>2022-09-22T17:30:39Z INF Starting tunnel tunnelID=[...]\n2022-09-22T17:30:39Z INF Version 2022.9.1\n2022-09-22T17:30:39Z INF GOOS: darwin, GOVersion: go1.19.1, GoArch: amd64\n2022-09-22T17:30:39Z INF Settings: map[post-quantum:true pq:true]\n2022-09-22T17:30:39Z INF Generated Connector ID: [...]\n2022-09-22T17:30:39Z INF cloudflared will not automatically update if installed by a package manager.\n2022-09-22T17:30:39Z INF Initial protocol quic\n2022-09-22T17:30:39Z INF Using experimental hybrid post-quantum key agreement X25519Kyber512Draft00\n2022-09-22T17:30:39Z INF Starting metrics server on 127.0.0.1:55889/metrics\n2022-09-22T17:30:39Z INF \n\n===================================================================================\nYou are hitting an error while using the experimental post-quantum tunnels feature.\n\nPlease check:\n\n   https://pqtunnels.cloudflareresearch.com\n\nfor known problems.\n===================================================================================\n\n\n2022-09-22T17:30:39Z ERR Failed to create new quic connection error=&quot;failed to dial to edge with quic: CRYPTO_ERROR (0x128): tls: handshake failure&quot; connIndex=0 ip=[...]\n</code></pre>\n<!--kg-card-end: markdown--><p>When the post-quantum flag is given, <code>cloudflared</code> will <em>not</em> fall back to a non post-quantum connection.</p><h3 id=\"what-to-look-for\">What to look for</h3><p>The setup phase is the crucial part: once established, the tunnel is the same as a normal tunnel. That means that performance and reliability should be identical once the tunnel is established.</p><p>The post-quantum cryptography we use is very fast, but requires roughly a kilobyte of extra data to be exchanged during the handshake. The difference will be hard to notice in practice.</p><p>Our biggest concern is that some network equipment/middleboxes might be confused by the bigger handshake. If the post-quantum Cloudflare Tunnel isn’t working for you, we’d love to hear about it. Contact us at <a href=\"mailto:ask-research@cloudflare.com\">ask-research@cloudflare.com</a> and tell us which middleboxes or ISP you’re using.</p><h2 id=\"under-the-hood\">Under the hood</h2><p>When the <code>--post-quantum</code> flag is given, <code>cloudflared</code> restricts itself to the QUIC transport for the tunnel connection to our network and will only allow the post-quantum hybrid key exchanges <code>X25519Kyber512Draft00</code> and <code>X25519Kyber768Draft00</code> with TLS identifiers <code>0xfe30</code> and <code>0xfe31</code> respectively. These are <a href=\"https://datatracker.ietf.org/doc/draft-stebila-tls-hybrid-design/\">hybrid</a> key exchanges between the classical <a href=\"https://cr.yp.to/ecdh.html\">X25519</a> and the post-quantum secure <a href=\"https://pq-crystals.org/kyber/index.shtml\">Kyber</a>. Thus, on the off-chance that Kyber turns out to be insecure, we can still rely on the non-post quantum security of X25519. These are the same key exchanges <a href=\"http://blog.cloudflare.com/post-quantum-for-all\">supported on our network</a>.</p><p><code>cloudflared</code> randomly picks one of these two key exchanges. The reason is that the latter usually requires two initial packets for the TLS <em>ClientHello</em> whereas the former only requires one. That allows us to test whether a fragmented <em>ClientHello</em> causes trouble.</p><p>When <code>cloudflared</code> fails to set up the post-quantum connection, it will report the attempted key exchange, <code>cloudflared</code> version and error to <a href=\"https://pqtunnels.cloudflareresearch.com\">pqtunnels.cloudflareresearch.com</a> so that we have visibility into network issues. Have a look at that page for updates on our post-quantum tunnel deployment.</p><p>The control connection and authentication of the tunnel between <code>cloudflared</code> and our network are not post-quantum secure yet. This is less urgent than the <em>store-now-decrypt-later</em> issue of the data on the tunnel itself.</p><p>We have <a href=\"https://github.com/cloudflare/qtls-pq\">open-sourced</a> support for these post-quantum QUIC key exchanges in Go.</p><h2 id=\"outlook\">Outlook</h2><p>In the coming decade the industry will roll out post-quantum data protection. Some cases will be as simple as a software update and others will be much more difficult. Post-Quantum Cloudflare Tunnel will secure the connection between Cloudflare’s network and your origin in a simple and user-friendly way — an important step towards the Post-Quantum Internet, so that everyone may continue to enjoy a private and secure Internet.</p>",
		"id": "633aa15f0139ba000afab430",
		"meta_description": "Every connection we make post-quantum secure, we remove one opportunity for compromise: that's why we are announcing post-quantum Cloudflare Tunnel to help you secure every connection to our network.",
		"meta_title": null,
		"og_description": null,
		"og_image": "http://blog.cloudflare.com/content/images/2022/10/Introducing-post-quantum-Cloudflare-Tunnel-OG-1.png",
		"og_title": null,
		"primary_author": {
			"id": "61296cb499b32402a7c0e188",
			"name": "Bas Westerbaan",
			"slug": "bas",
			"profile_image": "http://blog.cloudflare.com/content/images/2021/11/me.png",
			"cover_image": null,
			"bio": null,
			"website": "https://bas.westerbaan.name",
			"location": "The Netherlands",
			"facebook": null,
			"twitter": "@bwesterb",
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/bas/"
		},
		"primary_tag": null,
		"published_at": "2022-10-03T14:00:00.000+01:00",
		"reading_time": 6,
		"slug": "post-quantum-tunnel",
		"tags": [
			{
				"id": "633aa2c60139ba000afab43f",
				"name": "#BLOG-1347",
				"slug": "hash-blog-1347",
				"description": null,
				"feature_image": null,
				"visibility": "internal",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/404/"
			},
			{
				"id": "5d16450341acde0011a95211",
				"name": "Birthday Week",
				"slug": "birthday-week",
				"description": "Collection of Cloudflare blog posts tagged 'Birthday Week'.",
				"feature_image": "http://blog.cloudflare.com/content/images/2023/09/Welcome-to-Birthday-Week-2023.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Birthday Week",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Birthday Week'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/birthday-week/"
			},
			{
				"id": "60008826c93df003f34848e4",
				"name": "Post-Quantum",
				"slug": "post-quantum",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2022/02/image1-32.png",
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/post-quantum/"
			},
			{
				"id": "5fce48a395ca4301baec175e",
				"name": "Research",
				"slug": "research",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/research/"
			},
			{
				"id": "5d16450341acde0011a95277",
				"name": "Cryptography",
				"slug": "cryptography",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/cryptography/"
			},
			{
				"id": "5d16450341acde0011a951ee",
				"name": "Product News",
				"slug": "product-news",
				"description": "Product News (EN)",
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Product-News-1.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Product News",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Product News'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/product-news/"
			}
		],
		"title": "Introducing post-quantum Cloudflare Tunnel",
		"twitter_description": null,
		"twitter_image": "http://blog.cloudflare.com/content/images/2022/10/Introducing-post-quantum-Cloudflare-Tunnel-OG.png",
		"twitter_title": null,
		"updated_at": "2023-11-14T15:27:51.000+00:00",
		"url": "http://blog.cloudflare.com/post-quantum-tunnel/",
		"uuid": "e09b8250-a217-460e-8efe-071ce79e49c3",
		"visibility": "public"
	}
}