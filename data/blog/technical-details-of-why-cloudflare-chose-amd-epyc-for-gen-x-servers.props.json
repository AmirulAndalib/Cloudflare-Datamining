{
	"locale": "en-us",
	"post": {
		"access": true,
		"authors": [
			{
				"id": "5d1644b141acde0011a94f3b",
				"name": "Nitin Rao",
				"slug": "nitin-rao",
				"profile_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2019/08/WtxhLSEUSgqYRMdQUwWp_1204a20b3d1d96bba523a6a2a5fa3cd73bd4fe59240a27ad6eb8c064c6792446.jpg",
				"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-105.png",
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": "@NitinBRao",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/nitin-rao/"
			}
		],
		"canonical_url": null,
		"codeinjection_foot": null,
		"codeinjection_head": null,
		"comment_id": "5e59e62182886b01bd034427",
		"comments": false,
		"created_at": "2020-02-29T04:18:40.000+00:00",
		"custom_excerpt": "Looking back at this week's posts on the design, specifications, and performance of Cloudflare’s Gen X servers using AMD CPUs. Every server can run every service. This architectural decision has helped us achieve higher efficiency across the Cloudflare network. ",
		"custom_template": null,
		"email_subject": null,
		"excerpt": "Looking back at this week's posts on the design, specifications, and performance of Cloudflare’s Gen X servers using AMD CPUs. Every server can run every service. This architectural decision has helped us achieve higher efficiency across the Cloudflare network. ",
		"feature_image": "http://blog.cloudflare.com/content/images/2020/02/gen-x-color-Friday--twitter@2x-2.png",
		"feature_image_alt": null,
		"feature_image_caption": null,
		"featured": false,
		"frontmatter": null,
		"html": "<p>From the very beginning Cloudflare used Intel CPU-based servers (and, also, Intel components for things like NICs and SSDs). But we're always interested in optimizing the cost of running our service so that we can provide products at a low cost and high gross margin.</p><p>We're also mindful of events like the <a href=\"http://blog.cloudflare.com/meltdown-spectre-non-technical/\">Spectre and Meltdown </a>vulnerabilities and have been working with outside parties on research into mitigation and exploitation which we hope to publish later this year.</p><p>We looked very seriously at <a href=\"http://blog.cloudflare.com/arm-takes-wing/\">ARM-based CPUs</a> and continue to keep our software up to date for the ARM architecture so that we can use ARM-based CPUs when the requests per watt is interesting to us.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2020/02/gen-x-color-Friday--twitter@2x.png\" class=\"kg-image\" alt loading=\"lazy\"></figure><p>In the meantime, we've deployed AMD's EPYC processors as part of Gen X server platform and for the first time are not using any Intel components at all. This week, we announced details of this tenth generation of servers. Below is a recap of why we're excited about the design, specifications, and performance of our newest hardware.</p><h2 id=\"servers-for-an-accelerated-future\"><a href=\"http://blog.cloudflare.com/cloudflares-gen-x-servers-for-an-accelerated-future/\">Servers for an Accelerated Future</a></h2><p>Every server can run every service. This architectural decision has helped us achieve higher efficiency across the Cloudflare network. It has also given us more flexibility to build new software or adopt the newest available hardware. </p><p>Notably, Intel is not inside. We are not using their hardware for any major server components such as the CPU, board, memory, storage, network interface card (or any type of accelerator).</p><p>This time, AMD is inside.</p><p>Compared with our prior server (<a href=\"http://blog.cloudflare.com/a-tour-inside-cloudflares-g9-servers/\">Gen 9</a>), our Gen X server processes as much as 36% more requests while costing substantially less. Additionally, it enables a ~50% decrease in L3 cache miss rate and up to 50% decrease in NGINX p99 latency, powered by a CPU rated at 25% lower TDP (thermal design power) per core.</p><h2 id=\"gen-x-cpu-benchmarks\"><a href=\"http://blog.cloudflare.com/an-epyc-trip-to-rome-amd-is-cloudflares-10th-generation-edge-server-cpu/\">Gen X CPU benchmarks</a></h2><p>To identify the most efficient CPU for our software stack, we ran several benchmarks for key workloads such as cryptography, compression, regular expressions, and LuaJIT. Then, we simulated typical requests we see, before testing servers in live production to measure requests per watt.    <br><br>Based on our findings, we selected the single socket 48-core AMD 2nd Gen EPYC 7642.<br></p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2020/02/pasted-image-0.png\" class=\"kg-image\" alt loading=\"lazy\"></figure><h2 id=\"impact-of-cache-locality\"><a href=\"http://blog.cloudflare.com/impact-of-cache-locality/\">Impact of Cache Locality</a></h2><p>The single AMD EPYC 7642 performed very well during our lab testing, beating our <a href=\"http://blog.cloudflare.com/a-tour-inside-cloudflares-g9-servers/\">Gen 9</a> server with dual Intel Xeon Platinum 6162 with the same total number of cores. Key factors we noticed were its large L3 cache, which led to a low L3 cache miss rate, as well as a higher sustained operating frequency.</p><h2 id=\"gen-x-performance-tuning\"><a href=\"http://blog.cloudflare.com/gen-x-performance-tuning/\">Gen X Performance Tuning</a></h2><p>Partnering with AMD, we tuned the 2nd Gen EPYC 7642 processor to achieve additional 6% performance. We achieved this by using power determinism and configuring the CPU's Thermal Design Power (TDP).</p><h2 id=\"securing-memory-at-epyc-scale\"><a href=\"http://blog.cloudflare.com/securing-memory-at-epyc-scale/\">Securing Memory at EPYC Scale</a></h2><p>Finally, we described how we use Secure Memory Encryption (SME), an interesting security feature within the System on a Chip architecture of the AMD EPYC line. We were impressed by how we could achieve RAM encryption without significant decrease in performance. This reduces the worry that any data could be exfiltrated from a stolen server.</p><p>We enjoy designing hardware that improves the security, performance and reliability of our global network, trusted by over 26 million Internet properties.</p><p>Want to help us evaluate new hardware? <a href=\"https://www.cloudflare.com/careers/\">Join us</a>!</p>",
		"id": "5e59e62182886b01bd034427",
		"meta_description": "Looking back at this week's posts on the design, specifications, and performance of Cloudflare’s Gen X servers using AMD EPYC CPUs.",
		"meta_title": null,
		"og_description": "Looking back at this week's posts on the design, specifications, and performance of Cloudflare’s Gen X servers using AMD EPYC CPUs.",
		"og_image": null,
		"og_title": null,
		"primary_author": {
			"id": "5d1644b141acde0011a94f3b",
			"name": "Nitin Rao",
			"slug": "nitin-rao",
			"profile_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2019/08/WtxhLSEUSgqYRMdQUwWp_1204a20b3d1d96bba523a6a2a5fa3cd73bd4fe59240a27ad6eb8c064c6792446.jpg",
			"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-105.png",
			"bio": null,
			"website": null,
			"location": null,
			"facebook": null,
			"twitter": "@NitinBRao",
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/nitin-rao/"
		},
		"primary_tag": {
			"id": "5e4ebd0664d11901bd1fa947",
			"name": "EPYC",
			"slug": "epyc",
			"description": null,
			"feature_image": null,
			"visibility": "public",
			"meta_title": null,
			"meta_description": null,
			"og_image": null,
			"og_title": null,
			"og_description": null,
			"twitter_image": null,
			"twitter_title": null,
			"twitter_description": null,
			"codeinjection_head": null,
			"codeinjection_foot": null,
			"canonical_url": null,
			"accent_color": null,
			"url": "http://blog.cloudflare.com/tag/epyc/"
		},
		"published_at": "2020-03-01T13:00:00.000+00:00",
		"reading_time": 3,
		"slug": "technical-details-of-why-cloudflare-chose-amd-epyc-for-gen-x-servers",
		"tags": [
			{
				"id": "5e4ebd0664d11901bd1fa947",
				"name": "EPYC",
				"slug": "epyc",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/epyc/"
			},
			{
				"id": "5e5370a464d11901bd1fab42",
				"name": "AMD",
				"slug": "amd",
				"description": "AMD",
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/amd/"
			},
			{
				"id": "5e5766f082886b01bd03419b",
				"name": "Gen X",
				"slug": "gen-x",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/gen-x/"
			},
			{
				"id": "5d16450341acde0011a95157",
				"name": "Cache",
				"slug": "cache",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/cache/"
			},
			{
				"id": "5e4ec3f164d11901bd1fa991",
				"name": "Hardware",
				"slug": "hardware",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/hardware/"
			},
			{
				"id": "5d16450341acde0011a95265",
				"name": "Security",
				"slug": "security",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Security.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Security",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Security'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/security/"
			}
		],
		"title": "Why Cloudflare Chose AMD EPYC for Gen X Servers",
		"twitter_description": "Looking back at this week's posts on the design, specifications, and performance of Cloudflare’s Gen X servers using AMD EPYC CPUs.",
		"twitter_image": null,
		"twitter_title": null,
		"updated_at": "2020-03-03T17:50:55.000+00:00",
		"url": "http://blog.cloudflare.com/technical-details-of-why-cloudflare-chose-amd-epyc-for-gen-x-servers/",
		"uuid": "85f93f91-b291-4107-bc55-b7ca1c722c26",
		"visibility": "public"
	}
}