<div class="mb2 gray5">11 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2024/02/image2-2-3.png" class="kg-image" alt="" loading="lazy" width="1200" height="676"></figure>
	<p><br>Para que un dispositivo pueda comunicarse con otros dispositivos en Internet a través del llamado, <a href="https://en.wikipedia.org/wiki/Internet_Protocol">Protocolo de Internet</a> (IP), primero se le debe asignar una dirección numérica única. El aspecto de esta dirección depende de la versión de dirección IP que se utilice: <a href="https://en.wikipedia.org/wiki/Internet_Protocol_version_4">IPv4</a> o <a href="https://en.wikipedia.org/wiki/IPv6">IPv6</a>.<br></p>
	<p>IPv4 se implementó por primera vez en 1983. Es la versión de dirección IP que dio origen a la red de Internet moderna y sigue siendo el protocolo dominante hoy en día. IPv6 se remonta a 1998, pero no ha sido hasta la última década cuando ha empezado a cobrar impulso, de hecho, su adopción aumentó desde menos del 1 % al 30-40 % (el porcentaje varía según quien elabore el informe, los datos que midan y la forma en que lo hagan).<br></p>
	<p>Teniendo en cuenta el aumento del número de dispositivos conectados, que supera con creces el número de direcciones IPv4 disponibles, <a href="https://blog.cloudflare.com/amazon-2bn-ipv4-tax-how-avoid-paying">y el incremento de sus costes</a>, el espacio de direcciones mucho mayor que ofrece IPv6 debería haberlo convertido ya en el protocolo dominante. Sin embargo, vamos a ver que no es así.<br></p><!--kg-card-begin: markdown-->
	<p>Cloudflare ha sido un firme defensor de IPv6 <a href="https://www.cloudflare.com/press-releases/2011/cloudflare-announces-the-automatic-ipv6-gateway">durante muchos años</a> y, gracias a <a href="https://radar.cloudflare.com">Cloudflare Radar</a>, hemos seguido de cerca la adopción de IPv6 en Internet. Radar, que nació hace tres años, sigue siendo una plataforma relativamente reciente. Si nos remontamos atrás en el tiempo, podemos recurrir brevemente a nuestros amigos de <a href="https://stats.labs.apnic.net/ipv6/XA">APNIC</a><sup>1</sup>, uno de los cinco registros regionales de Internet (<a href="https://en.wikipedia.org/wiki/Regional_Internet_registry">RIR</a>). Sus datos, que se remontan a 2012, nos permiten ver que el protocolo IPv6 experimentó un periodo de crecimiento aparentemente exponencial hasta mediados de 2017, manteniendo después un crecimiento lineal que aún continúa:</p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--7--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="700"></figure>
	<p>La adopción de IPv6 se ve frenada por la falta de compatibilidad entre ambos protocolos — los dispositivos deben tener asignadas tanto una dirección IPv4 <em>como</em> una IPv6 — y el hecho de que prácticamente todos los dispositivos de Internet siguen siendo compatibles con IPv4. No obstante, IPv6 es fundamental para el futuro de Internet y es necesario seguir tratando de aumentar su implementación.</p>
	<p>Cloudflare Radar, al igual que APNIC y la mayoría de las demás fuentes actuales, publica cifras que reflejan principalmente hasta qué punto los proveedores de acceso a Internet han implementado IPv6: el <em>lado cliente</em>. Se trata de un aspecto muy importante y que afecta directamente a los usuarios finales, pero también está el otro extremo de la ecuación : el <em>lado servidor</em>.</p>
	<p>Teniendo esto presente, te invitamos a que nos acompañes en un rápido experimento para conocer la adopción de IPv6 en el lado servidor, así como la frecuencia con la que los clientes son realmente (o probablemente) capaces de comunicarse con los servidores a través de IPv6. Nos basaremos en el DNS en este análisis y, como se suele decir, los resultados pueden sorprenderte.</p>
	<h3 id="adopci%C3%B3n-de-ipv6-en-el-lado-cliente-desde-la-perspectiva-de-http">Adopción de IPv6 en el lado cliente (desde la perspectiva de HTTP)</h3>
	<p>A finales de octubre de 2023, desde la <a href="https://radar.cloudflare.com/adoption-and-usage?dateStart=2023-08-01&amp;dateEnd=2023-10-31">perspectiva</a> de Cloudflare, la adopción de IPv6 en Internet era de aproximadamente el <strong>36 %</strong> de todo el tráfico, si bien había ligeras variaciones según la hora del día y el día de la semana. Si se excluyen los bots, la estimación se eleva a algo más del 46 %, mientras que si se excluyen los usuarios humanos, se reduce a cerca del 24 %. Estas cifras se refieren a la proporción de solicitudes HTTP servidas a través de IPv6 <a href="https://developers.cloudflare.com/radar/glossary/#ipv6-adoption">en todo el contenido habilitado para IPv6</a> (la configuración por defecto).</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0-2.png" class="kg-image" alt="" loading="lazy" width="1600" height="900"></figure>
	<p>Para este ejercicio, lo que más importa es el número que corresponde a humanos <em>y</em> a bots. Hay muchas razones que explican la diferencia de adopción entre ambos tipos de tráfico, desde los distintos niveles de compatibilidad de IPv6 en la gran variedad de software cliente utilizado, hasta los distintos niveles de implementación de IPv6 dentro de las numerosas redes de las que procede el tráfico, pasando por el tamaño variable de dichas redes, etc. Sin embargo, dejamos esta encrucijada para otro día. Si tienes curiosidad por conocer las cifras de un país o una red en concreto, puedes consultar <a href="https://radar.cloudflare.com/adoption-and-usage">Cloudflare Radar</a> y nuestro informe <a href="https://radar.cloudflare.com/year-in-review/2023#ipv6-adoption">Resumen del año</a> de 2023.</p>
	<h2 id="con-uno-no-basta">Con uno no basta<br></h2>
	<p>Tu, como lector, podrías pensar que el cálculo del lado cliente de la ecuación cliente-servidor solo nos cuenta la mitad de la historia. Para que un cliente IPv6 establezca una conexión con un servidor a través de IPv6, el servidor también debe ser compatible con IPv6.</p>
	<p>Aquí se nos plantean dos preguntas:</p>
	<ol>
		<li>¿Cuál es el alcance de la adopción de IPv6 en el lado servidor?</li>
		<li>¿Hasta qué punto coincide la adopción de IPv6 en el lado cliente con la adopción en el lado servidor?</li>
	</ol>
	<p>Hay varias respuestas posibles, dependiendo de si estamos hablando de usuarios, dispositivos, bytes transferidos, etc. Nos centraremos en las <em>conexiones</em> (quedará claro por qué en un momento), y la pregunta conjunta que planteamos es:</p>
	<blockquote><em>¿Con qué frecuencia puede un cliente compatible con IPv6 utilizar el protocolo IPv6 al conectarse a servidores en Internet, según patrones de uso típicos?</em></blockquote>
	<p>Los patrones de uso típicos incluyen usuarios que pasan el día visitando algún sitio web con más frecuencia que otros o clientes automatizados que llaman a la API. Recurriremos al DNS para conocer esta perspectiva.</p>
	<h3 id="entra-en-escena-el-dns">Entra en escena el DNS</h3>
	<p>Antes de que un cliente pueda intentar establecer una conexión con un servidor por su nombre, utilizando el protocolo clásico IPv4 o el más moderno IPv6, debe buscar la dirección IP del servidor en la <a href="https://en.wikipedia.org/wiki/Telephone_directory">agenda de</a> Internet, el <a href="https://www.cloudflare.com/learning/dns/what-is-dns">sistema de nombres de dominio (DNS)</a>.</p><!--kg-card-begin: markdown-->
	<p>Buscar un nombre de host en el DNS es <a href="https://www.cloudflare.com/learning/dns/what-is-dns">un proceso recursivo</a>. Para encontrar la dirección IP de un servidor, hay que seguir la jerarquía de dominios (los componentes separados por puntos del nombre de un servidor) en varios servidores DNS autoritativos hasta que uno de ellos devuelva la <a href="https://www.cloudflare.com/learning/dns/what-is-recursive-dns">respuesta deseada</a>. La mayoría de los clientes, sin embargo, no lo hacen así directamente, en su lugar piden a un servidor intermediario llamado solucionador recursivo que lo haga por ellos. Cloudflare opera uno de estos solucionadores recursivos que todo el mundo puede utilizar: <a href="https://one.one.one.one/dns">1.1.1.1</a>.</p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--1--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="800"></figure><!--kg-card-begin: markdown-->
	<p>A modo de ejemplo sencillo, cuando un cliente pregunta a 1.1.1.1 por la dirección IP donde se aloja " www.example.com", 1.1.1.1 preguntará al servidor raíz de DNS<sup>3</sup> por ".com", luego preguntará al servidor DNS de .com por "example.com", y finalmente preguntará al servidor DNS de example.com por "www.example.com", que tiene el conocimiento directo y responderá con una dirección IP. Para agilizar la tarea del siguiente cliente que haga una pregunta similar, 1.1.1.1 almacena en caché (recuerda durante un tiempo) tanto la respuesta final como los pasos intermedios.</p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--2--3.png" class="kg-image" alt="" loading="lazy" width="1600" height="384"></figure>
	<p>Esto significa que 1.1.1.1 está en muy buena posición para calcular la frecuencia con la que los clientes intentan buscar direcciones IPv4 (consultas de tipo A) <em>frente a</em> la frecuencia con la que intentan buscar direcciones IPv6 (consultas de tipo AAAA), cubriendo la mayor parte de la red de Internet observable.</p>
	<p>Pero, ¿cómo sabe un cliente cuándo debe solicitar la dirección IPv4 de un servidor o su dirección IPv6?</p>
	<p>La respuesta corta es que los clientes que disponen de IPv6 solicitan ambos. Realizan búsquedas <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-a-record">A</a> y <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-aaaa-record">AAAA</a> por separado para cada servidor al que desean conectarse. Estos clientes IPv6 priorizarán la conexión a través de IPv6 cuando obtengan una respuesta AAAA no vacía, independientemente de que también obtengan una respuesta A no vacía (que casi siempre obtienen, como veremos). El algoritmo que impulsa esta preferencia por la modernidad se llama <a href="https://en.wikipedia.org/wiki/Happy_Eyeballs">Happy Eyeballs</a>, por si te interesan los detalles.</p>
	<p>Ya estamos listos para comenzar a analizar algunos datos reales...</p>
	<h3 id="adopci%C3%B3n-de-ipv6-en-el-lado-cliente-desde-la-perspectiva-del-dns">Adopción de IPv6 en el lado cliente (desde la perspectiva del DNS)</h3>
	<p>El primer paso consiste en establecer un punto de referencia midiendo la implementación de IPv6 de los clientes a partir de 1.1.1.1 y compararlo con los números de las solicitudes HTTP con las que partimos.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--3--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="529"></figure>
	<p>Es tentador calcular la frecuencia con la que los clientes se conectan a 1.1.1.1 utilizando IPv6, pero los resultados son engañosos por un par de razones, la más importante de las cuales está oculta a simple vista: 1.1.1.1 es la <strong>dirección</strong> más recordada del conjunto de direcciones IPv4 e IPv6 que los clientes pueden utilizar para realizar búsquedas de DNS a través del <strong>servicio</strong> 1.1.1.1. Lo ideal es que el cliente IPv6 que utilice 1.1.1.1 como su solucionador recursivo tenga configuradas las cuatro direcciones IP siguientes, no solo las dos primeras:</p>
	<ul>
		<li><strong>1.1.1.1</strong> (IPv4)</li>
		<li><strong>1.0.0.1</strong> (IPv4)</li>
		<li><strong>2606:4700:4700::1111</strong> (IPv6)</li>
		<li><strong>2606:4700:4700::1001</strong> (IPv6)</li>
	</ul><!--kg-card-begin: markdown-->
	<p>Pero, cuando se trata de una configuración manual<sup>4</sup>, los usuarios encuentran que las direcciones IPv6 son menos fáciles de recordar que las direcciones IPv4y es menos probable que las configuren, ya que consideran que las direcciones IPv4 son suficientes.</p>
	<!--kg-card-end: markdown-->
	<p>Un factor de confusión relacionado, pero menos obvio, es que muchos clientes IPv6 seguirán realizando búsquedas de DNS en IPv4 aunque las direcciones IPv6 de 1.1.1.1. estén configuradas, ya que la distribución de las búsquedas entre las direcciones disponibles es una opción predeterminada popular.</p><!--kg-card-begin: markdown-->
	<p>Un enfoque más sensato para evaluar la adopción de IPv6 a partir de la actividad de los clientes DNS es calcular el porcentaje de consultas de tipo AAAA sobre la cantidad total de consultas de tipo A, asumiendo que los clientes IPv6 siempre realizan ambas<sup>5</sup>, como se ha mencionado anteriormente.</p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--4--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="555"></figure>
	<p>Entonces, desde la perspectiva de 1.1.1.1, la adopción de IPv6 en el <strong>lado cliente</strong> se estima en un<strong> 30,5 %</strong> por volumen de consultas. Esta cifra es algo inferior a la observada en el tráfico HTTP durante el mismo periodo (35,9 %), pero esta diferencia entre dos perspectivas distintas no es extraña.</p>
	<h3 id="un-apunte-sobre-los-ttl">Un apunte sobre los TTL</h3>
	<p>No solo los solucionadores recursivos almacenan en caché las respuestas DNS, la mayoría de los clientes DNS también tienen sus propias cachés locales. Tu navegador web, tu sistema operativo e incluso tu enrutador doméstico guardan las respuestas con la esperanza de agilizar las consultas posteriores.</p>
	<p>El tiempo que cada respuesta permanece en la caché depende del campo <a href="https://developers.cloudflare.com/dns/manage-dns-records/reference/ttl">tiempo de vida</a> (TTL) devuelto con el registro DNS. Si estás familiarizado con el DNS, puede que te preguntes si los registros A y AAAA tienen TTL similares. Si no es así, es posible que estemos recibiendo menos consultas para uno de estos dos tipos (porque se almacena en caché durante más tiempo a nivel de cliente), sesgando las cifras de adopción resultantes.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--5--2.png" class="kg-image" alt="" loading="lazy" width="1256" height="708"></figure><!--kg-card-begin: markdown-->
	<p>Los gráficos desglosan los TTL mínimos devueltos por 1.1.1.1 en respuesta a las consultas A y AAAA<sup>6</sup>. Hay alguna diferencia entre ambos tipos, pero la diferencia es mínima.</p>
	<!--kg-card-end: markdown-->
	<h3 id="adopci%C3%B3n-de-ipv6-en-el-lado-servidor">Adopción de IPv6 en el lado servidor</h3>
	<p>El siguiente gráfico muestra la frecuencia con la que las consultas de tipo A y AAAA obtienen respuestas no vacías, lo que arroja luz sobre la adopción de IPv6 <strong>del lado servidor </strong> y nos acerca a la respuesta que buscamos:</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--6--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="549"></figure>
	<p>La adopción de IPv6 de los servidores se estima en un <strong>43,3 %</strong> por volumen de consultas, notablemente superior a la observada para los clientes.</p>
	<h3 id="frecuencia-con-la-que-el-cliente-y-el-servidor-realizan-conexiones">Frecuencia con la que el cliente y el servidor realizan conexiones</h3>
	<p>Si el 30,5 % de las búsquedas de direcciones IP gestionadas por 1.1.1.1 pudieran hacer uso de una dirección IPv6 para conectarse a sus destinos previstos, pero solo el 43,3 % de esas búsquedas obtuvieran una respuesta no vacía, eso nos daría una buena indicación de la frecuencia con la que se realizan conexiones IPv6 entre cliente y servidor, aproximadamente el <strong>13,2 %</strong> del tiempo.</p>
	<h3 id="el-impacto-potencial-de-los-dominios-populares">El impacto potencial de los dominios populares</h3>
	<p>La adopción de IPv6 del lado servidor, medida por el volumen de consultas para los dominios de la lista <a href="https://radar.cloudflare.com/domains">Top 100</a> de Radar es del 60,8 %. Si excluimos estos dominios de nuestros cálculos generales, la cifra anterior del 13,2 % se reduce al 8 %. Esta es una diferencia significativa, pero no es extraña, ya que los 100 dominios principales representan más del 55 % de todas las consultas A y AAAA a 1.1.1.1.</p>
	<p></p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/12/pasted-image-0--8--2.png" class="kg-image" alt="" loading="lazy" width="1600" height="552"></figure>
	<p>La evaluación de la adopción de IPv6 en Internet supone:<br></p>
	<ul>
		<li>Contabilizar los <strong>usuarios</strong> con acceso a Internet compatible con IPv6.</li>
		<li>Contabilizar los <strong>dispositivos</strong> compatibles con IPv6 o software en dichos dispositivos (cliente y/o servidores).</li>
		<li>Calcular la cantidad de <strong>tráfico</strong> que pasa a través de las conexiones IPv6, medida en bytes.</li>
		<li>Contabilizar la proporción de <strong>conexiones</strong> (o solicitudes <strong>individuales</strong>) en IPv6.</li>
	</ul>
	<p>En este ejercicio elegimos analizar las conexiones y las solicitudes. Teniendo en cuenta que la realidad subyacente solo se puede entender realmente considerando varias perspectivas diferentes, observamos tres cifras diferentes de adopción de IPv6:</p>
	<ul>
		<li><strong>35,9 %</strong> (del lado cliente) cuando se contabilizan las solicitudes HTTP servidas desde la CDN de Cloudflare.</li>
		<li><strong>30,5 %</strong> (del lado cliente) si se cuentan las consultas DNS de tipo A y AAAA gestionadas por <a href="https://one.one.one.one/dns">1.1.1.1</a>.</li>
		<li><strong>43,3 %</strong> (del lado servidor) de respuestas positivas a consultas DNS de tipo AAAA, también desde 1.1.1.1.</li>
	</ul>
	<p>Combinamos las cifras del <em>lado cliente</em> y del <em>lado servidor</em> desde la perspectiva del DNS para calcular con qué frecuencia es probable que las conexiones a servidores de terceros se establezcan a través de IPv6 en lugar de IPv4, y el resultado es solo el <strong>13,2%</strong> de las veces.</p>
	<p>Para mejorar estas cifras, los proveedores de acceso a Internet, los proveedores de nube y alojamiento, y las empresas deben acelerar la implementación de IPv6 en los dispositivos de sus redes. Sin embargo, los sitios web importantes y las fuentes de contenido también tienen un papel fundamental a la hora de permitir que los clientes IPv6 utilicen IPv6 más a menudo, ya que el <strong>39, 2%</strong> de las consultas de dominios en el <a href="https://radar.cloudflare.com/domains">Top 100</a> de Radar (que representan más de la mitad de todas las consultas A y AAAA a 1.1.1.1) todavía se limitan a respuestas IPv4 únicamente.</p>
	<p>En el camino hacia la plena adopción de IPv6, Internet va a la zaga. Sin embargo, el esfuerzo continuo de todos los involucrados puede ayudar a que siga avanzando, y tal vez incluso a acelerar el progreso.</p>
	<p><em>En el lado servidor, Cloudflare lleva muchos años trabajando para este fin, y por ello ofrece </em><a href="https://developers.cloudflare.com/support/network/understanding-and-configuring-cloudflares-ipv6-support"><em>compatibilidad IPv6</em></a><em> gratuita para todos los dominios. En el lado cliente, la </em><a href="https://one.one.one.one"><em>aplicación 1.1.1.1</em></a><em> habilita automáticamente tu dispositivo para IPv6 incluso si tu proveedor de acceso a Internet no la facilita. Y, si por casualidad gestionas una red solo IPv6, la </em><a href="https://developers.cloudflare.com/1.1.1.1/infrastructure/ipv6-networks"><em>compatibilidad DNS64</em></a><em> de 1.1.1.1 también te cubre.</em></p><!--kg-card-begin: markdown-->
	<p><small>***</small><br>
		<small><sup>1</sup>La resolución DNS pública de Cloudflare (1.1.1.1) opera en asociación con APNIC. Puedes obtener más información en la publicación del blog del <a href="https://blog.cloudflare.com/dns-resolver-1-1-1-1">anuncio original</a> y en la <a href="https://developers.cloudflare.com/1.1.1.1/privacy/public-dns-resolver">política de privacidad</a> de 1.1.1.1..<br>
			<sup>2</sup>Sigue leyendo sobre el funcionamiento de DNS en la sección "<a href="https://www.cloudflare.com/learning/dns/what-is-dns">¿Qué es DNS?</a>” de nuestro sitio web. Si prefieres aprender de forma práctica, te sugerimos que eches un vistazo a "<a href="https://messwithdns.net">mess with dns</a>" de Julia Evans.<br>
			<sup>3</sup>Cualquier solucionador recursivo ya conocerá de antemano las direcciones IP de los <a href="https://www.iana.org/domains/root/servers">13 servidores raíz</a>. Cloudflare también participa en el nivel superior de DNS <a href="https://blog.cloudflare.com/f-root">proporcionando servicio Anycast a las instancias E y F-Root</a>, lo que facilita a 1.1.1.1 ese primer paso de búsqueda.<br>
			<sup>4</sup>Cuando se utiliza la aplicación <a href="https://one.one.one.one">1.1.1.1</a>, las cuatro direcciones IP se configuran automáticamente.<br>
			<sup>5</sup>Para simplificar, suponemos que la cantidad de clientes que solo utilizan IPv6 sigue siendo insignificante. Es una suposición razonable en general, y otros conjuntos de datos de los que disponemos lo confirman.<br>
			<sup>6</sup>1.1.1.1, al igual que otros solucionadores recursivos, devuelve TTL ajustados: el TTL original del registro menos el número de segundos transcurridos desde que el registro se almacenó en caché por última vez. Las respuestas A y AAAA vacías se almacenan en caché durante el tiempo definido en el registro de <a href="https://www.cloudflare.com/learning/dns/dns-records/dns-soa-record">Inicio de autoridad</a> (SOA) del dominio, tal y como se especifica en RFC 2308.<br>
		</small>
	</p>
	<!--kg-card-end: markdown-->
</div>