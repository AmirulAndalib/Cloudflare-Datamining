<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/01/image1-81-1.png" class="kg-image" alt="Schutz gegen CVE-2021-45046, die zusätzliche Log4j RCE-Sicherheitslücke"></figure>
	<p>Nach CVE-2021-44228 wurde ein zweites Log4J-CEVE eingereicht: <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">CVE-2021-45046</a>. Die Regeln, die wir zuvor für <a href="https://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation/">CVE-2021-44228 veröffentlicht haben,</a> bieten das gleiche Maß an Schutz für dieses neue CVE.</p>
	<p>Diese Sicherheitslücke wird aktiv ausgenutzt und jeder, der Log4J benutzt, sollte so schnell wie möglich auf Version 2.16.0 aktualisieren, auch wenn Sie zuvor auf 2.15.0 aktualisiert haben. Die neueste Version finden Sie auf der <a href="https://logging.apache.org/log4j/2.x/download.html" target="_blank">Log4J Download-Seite</a>.</p>
	<p>Kunden, die die Cloudflare WAF nutzen, verfügen über drei Regeln, die dazu beitragen, Exploit-Versuche abzuwehren:</p>
	<!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th style="text-align:center">Regel-ID</th>
				<th style="text-align:center">Beschreibung</th>
				<th style="text-align:center">Voreinstellung</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:center"><code>100514</code> (alte WAF)<br><code>6b1cc72dff9746469d4695a474430f12</code> (neue WAF)</td>
				<td style="text-align:center">Log4j-Header</td>
				<td style="text-align:center"><code>Sperren</code></td>
			</tr>
			<tr>
				<td style="text-align:center"><code>100515</code> (alte WAF)<br><code>0c054d4e4dd5455c9ff8f01efe5abb10</code> (neue WAF)</td>
				<td style="text-align:center">Log4j-Body</td>
				<td style="text-align:center"><code>Sperren</code></td>
			</tr>
			<tr>
				<td style="text-align:center"><code>100516</code> (alte WAF)<br><code>5f6744fa026a4638bda5b3d7d5e015dd</code> (neue WAF)</td>
				<td style="text-align:center">Log4j-URL</td>
				<td style="text-align:center"><code>Sperren</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>Die Abwehr wurde auf drei Regeln verteilt, die jeweils den HTTP-Header, den HTTP-Body und die HTTP-URL überprüfen.</p>
	<p>Zusätzlich zu den oben genannten Regeln haben wir eine vierte Regel veröffentlicht, die gegen eine viel größere Anzahl von Angriffen schützt, allerdings auf Kosten einer höheren False-Positive-Rate. Aus diesem Grund haben wir sie verfügbar gemacht, aber nicht standardmäßig auf <code>BLOCK</code> gesetzt:</p>
	<!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th style="text-align:center">Regel-ID</th>
				<th style="text-align:center">Beschreibung</th>
				<th style="text-align:center">Voreinstellung</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:center"><code>100514</code> (alte WAF)<br><code>2c5413e155db4365befe0df160ba67d7</code> (neue WAF)</td>
				<td style="text-align:center">Log4J Advanced URI, Headers</td>
				<td style="text-align:center"><code>Deaktiviert</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="wer-ist-betroffen">Wer ist betroffen?</h3>
	<p>Log4j ist eine leistungsstarke Java-basierte Protokollbibliothek, die von der Apache Software Foundation gepflegt wird.</p>
	<p>In allen Log4j-Versionen von einschließlich 2.0-beta9 bis 2.14.1 können JNDI-Funktionen, die bei der Konfiguration, in Protokollnachrichten und in Parametern verwendet werden, von Angreifern für eine Remote Code-Ausführung ausgenutzt werden. Konkret kann ein Angreifer, der in der Lage ist, Protokollnachrichten oder Protokollnachrichtenparameter zu kontrollieren, beliebigen von LDAP-Servern geladenen Code ausführen, wenn das Ersetzen der Nachrichtensuchen (Message Lookup Substitution) aktiviert ist.</p>
	<p>Darüber hinaus waren die bisherigen Abhilfemaßnahmen für CVE-2021-22448, wie sie in Version 2.15.0 zu sehen sind, nicht ausreichend, um vor CVE-2021-45046 zu schützen.</p>
</div>