<div class="mb2 gray5">2 min read</div>
<div class="post-content lh-copy gray1">
	<!--kg-card-begin: markdown-->
	<p><img alt="W3TC and WP Super Cache Vulnerability Discovered, We've Automatically Patched" src="https://blog.cloudflare.com/content/images/w3tc_w3-super-cache_vulnerability.png.scaled500.png" title="W3TC and WP Super Cache Vulnerability Discovered, We've Automatically Patched"><noscript><img alt="W3TC and WP Super Cache Vulnerability Discovered, We&apos;ve Automatically
Patched" src="http://blog.cloudflare.com/content/images/w3tc_w3-super-cache_vulnerability.png.scaled500.png" title="W3TC and WP Super Cache Vulnerability Discovered, We&apos;ve Automatically Patched"></noscript><br>
		The team at the research firm Sucuri <a href="http://www.reddit.com/r/netsec/comments/1czzyx/update_wp_super_cache_and_w3tc_immediately_remote" target="_blank">announced a serious vulnerability</a> to W3TC and WP Super Cache this afternoon. (Update: it appears the <a href="http://wordpress.org/support/topic/pwn3d" target="_blank">vulnerability was first reported</a> on WordPress.org about a month ago.) The vulnerability allows remote PHP code to be executed locally on a server for anyone running either of the two most popular WordPress caching plugins. This is a serious vulnerability as it could allow an attacker to execute code on your server.</p>
	<p>Here are the versions of each plugin that are vulnerable:</p>
	<ul>
		<li><strong>W3 Total Cache</strong> (version 0.9.2.8 and below are vulnerable,
			version 0.9.2.9 and up are not vulnerable) / <a href="http://wordpress.org/extend/plugins/w3-total-cache/changelog" target="_blank">upgrade
				here</a></li>
		<li><strong>WP Super Cache</strong> (version 1.2 and below are vulnerable, version
			1.3.x and up are not vulnerable) / <a href="http://wordpress.org/extend/plugins/wp-super-cache/changelog" target="_blank">upgrade
				here</a></li>
	</ul>
	<p>As a precaution, CloudFlare has applied a rule to our network which protects against this specific vulnerability in both plugins. The protection is applied for all CloudFlare accounts automatically, even free accounts. You do not need to do anything to enable the protection.</p>
	<p>Even with this protection in place, if you are running either of these plugins you should upgrade immediately (<a href="http://wordpress.org/extend/plugins/w3-total-cache/changelog" target="_blank">W3TC Upgrade</a> / <a href="http://wordpress.org/extend/plugins/wp-super-cache/changelog" target="_blank">WP Super Cache Upgrade</a>). The vulnerability is serious enough that we recommend you disable the plugins until you have completed an upgrade. If you're not already a CloudFlare customer, you can <a href="https://www.cloudflare.com/sign-up" target="_blank">signup for free to get protection immediately</a>.</p>
	<h4 id="technicaldetails">Technical Details</h4>
	<p>The attack takes advantage of several functions in these plugins including: mfunc, mclude, and dynamic-cached-content. An attacker can execute a PHP command running on the server by pasting a comment to a WordPress blog running a vulnerable version of W3 Total Cache or WP Super Cache. For example, if you are running a vulnerable version of the plugins, the following will result in your current PHP version being printed in the comment:</p>
	<pre>&lt;!--mfunc echo PHP_VERSION; --&gt;&lt;!--/mfunc--&gt;
</pre>
	<p>While this is harmless, the same mfunc call in either plugin can run other arbitrary commands on your server. This could be used to gain access to the server, execute arbitrary database commands, or remotely install malware. Again, this is a very severe vulnerability and all W3TC and W3 Super Cache users should upgrade immediately (<a href="http://wordpress.org/extend/plugins/w3-total-cache/changelog" target="_blank">W3TC Upgrade</a> / <a href="http://wordpress.org/extend/plugins/wp-super-cache/changelog" target="_blank">WP Super Cache Upgrade</a>).</p>
	<!--kg-card-end: markdown-->
</div>