{
	"locale": "en-us",
	"localesAvailable": [],
	"post": {
		"authors": [
			{
				"name": "Pasha Kravtsov",
				"slug": "pasha-kravtsov",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1kxwlg4kCrr3Ls2h8gJCua/883f445c7798412806279315786d89bc/pasha-kravtsov.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			}
		],
		"excerpt": "Recently, a new brute force attack method for WordPress instances was identified by Sucuri. This latest technique allows attackers to try a large number of WordPress username and password login combinations in a single HTTP request.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4W6BcZa3ilvqXHkW7YK68n/8910faebed5c9e97cae98a65917d859f/a-look-at-the-new-wordpress-brute-force-amplification-attack.png",
		"featured": false,
		"html": "<p>Recently, a new brute force attack method for WordPress instances was identified by Sucuri. This latest technique allows attackers to try a large number of WordPress username and password login combinations in a single HTTP request.</p><p>The vulnerability can easily be abused by a simple script to try a significant number of username and password combinations with a relatively small number of HTTP requests. The following diagram shows a 4-fold increase in login attempts to HTTP requests, but this can trivially be expanded to a thousand logins.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6jdeVX3b5JHTMwZvY4J7wY/5f6dad5876ad9036b9440a68ac81bf6f/wordpress-xmlrpc-brute-force-amplification.png\" alt=\"WordPress XML-RPC Brute Force Amplification Attack\" class=\"kg-image\" width=\"1137\" height=\"1663\" loading=\"lazy\"/>\n            \n            </figure><p>This form of brute force attack is harder to detect, since you won’t necessarily see a flood of requests. Fortunately, all CloudFlare paid customers have the option to enable a Web Application Firewall ruleset to stop this new attack method.</p><h3>What is XML-RPC?</h3><p>To understand the vulnerability, it’s important to understand the basics of the XML remote procedure protocol (XML-RPC).</p><p>XML-RPC uses XML encoding over HTTP to provide a remote procedure call protocol. It’s commonly used to execute various <a href=\"https://codex.wordpress.org/XML-RPC_WordPress_API\">functions in a WordPress instance</a> for APIs and other automated tasks. Requests that modify, manipulate, or view data using XML-RPC require user credentials with sufficient permissions.</p><p>Here is an example that requests a list of the user’s blogs:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\"><?xml version=\"1.0\" encoding=\"iso-8859-1\"?>\n<methodCall>\n<methodName>wp.getUsersBlogs</methodName>\n<params>\n <param>\n  <value>\n   <string>admin</string>\n  </value>\n </param>\n <param>\n  <value>\n   <string>password123</string>\n  </value>\n </param>\n</params>\n</methodCall></pre></code>\n            <p>The server responds with an XML message containing the requested information. The <code>isAdmin</code> name-value pair tells us our credentials were correct:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\"><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<methodResponse>\n<params>\n\t<param>\n\t  <value>\n\t  <array><data>\n\t  <value><struct>\n\t  <member>\n\t\t<name>isAdmin</name>\n\t\t<value><boolean>1</boolean></value>\n\t  </member>\n\t  <member>\n\t\t<name>url</name>\n\t\t<value><string>http://example.com/</string></value>\n\t  </member>\n\t  <member>\n\t\t<name>blogid</name>\n\t\t<value><string>1</string></value>\n\t  </member>\n\t  <member>\n\t\t<name>blogName</name>\n\t\t<value><string>testing</string></value>\n\t  </member>\n\t  <member>\n\t\t<name>xmlrpc</name>\n\t\t<value><string>http://example.com/xmlrpc.php</string></value>\n\t  </member>\n\t  </struct></value>\n\t  </data></array>\n\t  </value>\n\t</param>\n</params>\n</methodResponse></pre></code>\n            <p>As shown in this request, you must provide proper authentication to get a successful response. You can, in theory, create a script that tries different combinations of the username and password, but that is a noisy option that isn’t very effective and is easily detected (the server logs would show a flood of failed login attempts).</p><p>This is where the <code>system.multicall</code> functionality comes into play. You can run multiple methods with a single HTTP request. This is useful for mass editing blogs or deleting large numbers of comments, etc. Any method that requires authentication can be abused to brute force credentials. Here is what a sample XML <code>system.multicall</code> payload would look like:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\"><?xml version=\"1.0\"?>\n<methodCall>\n<methodName>system.multicall</methodName>\n<params>\n  <param><value><array><data>\n  <value><struct>\n  <member>\n\t<name>methodName</name>\n\t<value><string>wp.getUsersBlogs</string></value>\n  </member>\n  <member>\n\t<name>params</name><value><array><data>\n\t<value><array><data>\n\t<value><string>admin</string></value>\n\t<value><string>password</string></value>\n\t</data></array></value>\n\t</data></array></value>\n  </member>\n  </struct></value>\n  <value><struct>\n  <member>\n\t<name>methodName</name>\n\t<value><string>wp.getUsersBlogs</string></value>\n  </member>\n  <member>\n\t<name>params</name>\n\t<value><array><data>\n\t<value><array><data>\n\t  <value><string>admin</string></value>\n\t  <value><string>password</string></value>\n\t  </data></array></value>\n\t</data></array></value>\n  </member>\n  </struct></value>\n  </data></array></value>\n  </param>\n</params>\n</methodCall></pre></code>\n            <p>As you can see, this can lead to very obvious abuse.</p><h3>Exploitation</h3><p>During testing, I was able to call the method <code>wp.getUserBlogs</code> 1,000 times in a single HTTP request (limited only by PHP memory issues). If a user creates a simple shell loop that executes one thousand times and runs a PHP script that crafts an HTTP request with one thousand method calls all requiring authentication, then that user would be able to try one million unique logins in a very short period of time.</p><p>This makes brute forcing the login very fast and can run down a pretty large wordlist in a short period of time. Also note that the <code>wp.getUserBlogs</code> method isn’t the only RPC call requiring authentication. It’s possible to use any RPC method which requires authentication to attempt logins and brute force the Wordpress credentials.</p><h3>CloudFlare Customers Are Protected</h3><p>When using CloudFlare with a Pro level plan or higher, you have the ability to turn on the Web Application Firewall (WAF) and take advantage of the new WordPress ruleset I created to mitigate this attack—all without any major interaction or supervision on your end.</p><p>Our WAF works by checking HTTP requests for consistencies that line up with known attacks and malicious activities. If a request does appear to be malicious, we drop it at the edge so it never even reaches the customer’s origin server.</p><p>To enable the rule, navigate to your CloudFlare Firewall dashboard, and reference the rule named &quot;Blocks amplified brute force attempts to xmlrpc.php&quot; with the rule ID WP0018.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4UjJTAaaGerRJ928DM0NGv/82a687a20739dd0422d3ffa261af6efa/enabling-xmlrpc-waf-rule.png\" alt=\"Enabling WordPress XML-RPC WAF Rule\" class=\"kg-image\" width=\"950\" height=\"205\" loading=\"lazy\"/>\n            \n            </figure><p>That’s all there is to it. Now you are protected from the new WordPress XML-RPC brute force amplification attack.</p><h3>The Manual Solution</h3><p>Another way to mitigate this attack is by disabling the ability to call the<code>system.multicall</code> method in your Wordpress installation by editing your<code>functions.php</code> file. Adding the function <code>mmx_remove_xmlrpc_methods()</code> will alleviate the problem, like so:</p>\n            <pre class=\"language-bash\"><code class=\"language-bash\">function mmx_remove_xmlrpc_methods( $methods ) {\n\tunset( $methods['system.multicall'] );\n\treturn $methods;\n}\nadd_filter( 'xmlrpc_methods', 'mmx_remove_xmlrpc_methods');</pre></code>\n            <h3>Final Thoughts</h3><p>XML-RPC can be a useful tool for making changes to WordPress and other web applications; however, improper implementation of certain features can result in unintended consequences. Default-on methods like <code>system.multicall</code> and <code>pingback.ping</code> (we have a <a href=\"/wordpress-pingback-attacks-and-our-waf/\">WAF rule for that one</a>, too) are just a few examples of possible exploits.</p><p>Properly configuring the CloudFlare Web Application Firewall for your Internet facing properties will protect you from such attacks with no changes to your server configuration.</p>",
		"id": "6gLyPOxWVFfvjEC44cNrMg",
		"localeList": {
			"name": "A Look at the New WordPress Brute Force Amplification Attack Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2015-10-16T18:14:32.000+01:00",
		"reading_time": 3,
		"slug": "a-look-at-the-new-wordpress-brute-force-amplification-attack",
		"tags": [
			{
				"id": "2KrU49OQiwcLHqnSYCy9As",
				"name": "WordPress",
				"slug": "wordpress"
			},
			{
				"id": "6ftpwHnREWzIsAvyv4blrq",
				"name": "php",
				"slug": "php"
			},
			{
				"id": "5kIxDMJCg3PXQxVINDL0Cw",
				"name": "Attacks",
				"slug": "attacks"
			},
			{
				"id": "6QVJOBzgKXUO9xAPEpqxvK",
				"name": "Reliability",
				"slug": "reliability"
			}
		],
		"title": "A Look at the New WordPress Brute Force Amplification Attack",
		"updated_at": "2024-08-27T02:37:35.307Z",
		"url": "https://blog.cloudflare.com/a-look-at-the-new-wordpress-brute-force-amplification-attack"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}