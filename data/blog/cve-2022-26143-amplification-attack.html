<div class="mb2 gray5">4 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/6eQV6PQHDh8jsTmebq0aYh/9960317a748cb5e7e1defd916c35f9cc/image3-2.png" alt="CVE-2022-26143: A Zero-Day vulnerability for launching UDP amplification DDoS attacks" class="kg-image" width="1200" height="675" loading="lazy">

	</figure>
	<p>A <a href="https://www.cloudflare.com/learning/security/threats/zero-day-exploit">zero-day vulnerability</a> in the <a href="https://www.mitel.com/products/applications/collaboration/micollab">Mitel MiCollab</a> business phone system has recently been discovered (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26143">CVE-2022-26143</a>). This vulnerability, called TP240PhoneHome, which Cloudflare customers are already protected against, can be used to launch UDP amplification attacks. This type of attack reflects traffic off vulnerable servers to victims, amplifying the amount of traffic sent in the process <b>by an amplification factor of 220 billion percent</b> in this specific case.</p>
	<p>Cloudflare has been actively involved in investigating the TP240PhoneHome exploit, along with other members of the InfoSec community. <a href="https://blog.cloudflare.com/cve-2022-26143">Read our joint disclosure here for more details</a>. As far as we can tell, the vulnerability has been exploited as early as February 18, 2022. We have deployed emergency mitigation rules to protect Cloudflare customers against the amplification DDoS attacks.</p>
	<p>Mitel has been informed of the vulnerability. As of February 22, they have issued a high severity <a href="https://www.mitel.com/support/security-advisories/mitel-product-security-advisory-22-0001">security advisory</a> advising their customers to block exploitation attempts using a firewall, until a software patch is made available. Cloudflare <a href="https://www.cloudflare.com/magic-transit">Magic Transit</a> customers can use the <a href="https://www.cloudflare.com/magic-firewall">Magic Firewall</a> to block external traffic to the exposed Mitel UDP port 10074 by following the example in the screenshot below, or by pasting the following expression into their Magic Firewall rule editor and selecting the <i>Block</i> action:</p>
	<p><code>(udp.dstport eq 10074)</code>.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/2THwFEkTMEVxP01OI4EbEl/d152d8714834ef826f328b28a5063f3d/image1-4.png" alt="Creating a Magic Firewall rule to block traffic to port 10074" class="kg-image" width="1999" height="1062" loading="lazy">

	</figure>
	<p>Creating a Magic Firewall rule to block traffic to port 10074</p>
	<p>To learn more, register for our <a href="https://event.on24.com/wcc/r/3689260/FDF7748F92652EA50A2447619373709B?partnerref=announcement-blog">webinar</a> on March 23rd, 2022.</p>
	<div class="flex anchor relative">
		<h3 id="exploiting-the-vulnerability-to-launch-ddos-attacks">Exploiting the vulnerability to launch DDoS attacks</h3>
		<a href="https://blog.cloudflare.com/#exploiting-the-vulnerability-to-launch-ddos-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Mitel Networks is based in Canada and provides business communications and collaboration products to over 70 million business users around the world. Amongst their enterprise collaboration products is the aforementioned Mitel MiCollab platform, known to be used in critical infrastructure such as municipal governments, schools, and emergency services. The vulnerability was discovered in the Mitel MiCollab platform.</p>
	<p>The vulnerability manifests as an unauthenticated UDP port that is incorrectly exposed to the public Internet. The call control protocol running on this port can be used to, amongst other things, issue the debugging command <code>startblast</code>. This command does not place real telephone calls; rather, it simulates a “blast” of calls in order to test the system. For each test call that is made, two UDP packets are emitted in response to the issuer of the command.</p>
	<p>According to the security advisory, the exploit can “<i>allow a malicious actor to gain unauthorized access to sensitive information and services, cause performance degradations or a denial of service condition on the affected system. If exploited with a denial of service attack, the impacted system may cause significant outbound traffic impacting availability of other services.</i>”</p>
	<p>Since this is an unauthenticated and connectionless UDP-based protocol, you can use <a href="https://www.cloudflare.com/learning/ddos/glossary/ip-spoofing">spoofing</a> to direct the response traffic toward any IP and port number — and by doing so, reflect and amplify a DDoS attack to the victim.</p>
	<p>We’ve mainly focused on the amplification vector because it can be used to hurt the whole Internet, but the phone systems themselves can likely be hurt in other ways with this vulnerability. This UDP call control port offers many other commands. With some work, it’s likely that you could use this UDP port to commit <a href="https://www.twilio.com/learn/voice-and-video/toll-fraud">toll fraud</a>, or to simply render the phone system inoperable. We haven’t assessed these other possibilities, because we do not have access to a device that we can safely test with.</p>
	<div class="flex anchor relative">
		<h3 id="the-good-news">The good news</h3>
		<a href="https://blog.cloudflare.com/#the-good-news" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Fortunately, only a few thousand of these devices are improperly exposed to the public Internet, meaning that this vector can “only” achieve several hundred million packets per second total. This volume of traffic can cause major outages if you’re not protected by an <a href="https://www.cloudflare.com/ddos">always-on automated DDoS protection service</a>, but it’s nothing to be concerned with if you are.</p>
	<p>Furthermore, an attacker can't run multiple commands at the same time. Instead, the server queues up commands and executes them serially. The fact that you can only launch one attack at a time from these devices, mixed with the fact that you can make that attack for many hours, has fascinating implications. If an attacker chooses to start an attack by specifying a very large number of packets, then that box is “burned” – it can’t be used to attack anyone else until the attack completes.</p>
	<div class="flex anchor relative">
		<h3 id="how-cloudflare-detects-and-mitigates-ddos-attacks">How Cloudflare detects and mitigates DDoS attacks</h3>
		<a href="https://blog.cloudflare.com/#how-cloudflare-detects-and-mitigates-ddos-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>To defend organizations against DDoS attacks, we built and operate software-defined systems that run autonomously. They automatically detect and mitigate DDoS attacks across our entire network.</p>
	<p>Initially, traffic is routed through the Internet via <a href="https://www.cloudflare.com/learning/cdn/glossary/anycast-network">BGP Anycast</a> to the nearest Cloudflare edge data center. Once the traffic reaches our data center, our DDoS systems sample it asynchronously allowing for out-of-path analysis of traffic without introducing latency penalties.</p>
	<p>The analysis is done using data streaming algorithms. Packet samples are compared to the fingerprints and multiple real-time signatures are created based on the dynamic masking of various fingerprint attributes. Each time another packet matches one of the signatures, a counter is increased. When the system qualifies an attack, i.e., the activation threshold is reached for a given signature, a mitigation rule is compiled and pushed inline. The mitigation rule includes the real-time signature and the mitigation action, e.g., drop.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/7zML76BvtkeFIWND7V7QuD/5942855edd6a76aaedd9012e9ee88e43/image2-5.png" alt="" class="kg-image" width="1600" height="1041" loading="lazy">

	</figure>
	<p>You can read more about our autonomous DDoS protection systems and how they work in our <a href="https://blog.cloudflare.com/deep-dive-cloudflare-autonomous-edge-ddos-protection">joint-disclosure technical blog post</a>.</p>
	<div class="flex anchor relative">
		<h3 id="helping-build-a-better-internet">Helping build a better Internet</h3>
		<a href="https://blog.cloudflare.com/#helping-build-a-better-internet" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>Cloudflare’s mission is to help build a better Internet. A better Internet is one that is more secure, faster, and reliable for everyone — even in the face of DDoS attacks and emerging zero-day threats. As part of our mission, since 2017, we’ve been providing <a href="https://blog.cloudflare.com/unmetered-mitigation">unmetered and unlimited DDoS protection</a> for free to all of our customers. Over the years, it has become increasingly easier for attackers to launch DDoS attacks. To counter the attacker’s advantage, we want to make sure that it is also easy and free for organizations of all sizes to protect themselves against DDoS attacks of all types.</p>
	<p>Not using Cloudflare yet? <a href="https://dash.cloudflare.com/sign-up">Start now</a>.</p>
</div>