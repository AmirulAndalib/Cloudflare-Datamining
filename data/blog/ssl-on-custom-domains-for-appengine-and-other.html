<div class="mb2 gray5">2 min read</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/1v76gu0aNr8NCGGjNrVboN/b6d72cbd7fcf2a9edec515f901d6b3d7/ssl-on-custom-domains-for-appengine-and-other.jpg" alt="">
<div class="post-content lh-copy gray1">
	<p><i>Note: this post is deprecated. While it worked for a while, AppEngine made a change on their side that caused it to break. Rather than playing wack-a-mole with a brittle solution, we decided to create something that would work for the long term and across a wider range or services. Called Flexible SSL, learn more about the new solution on the</i><i>following blog post:</i></p>
	<p><a href="https://blog.cloudflare.com/ssl-on-tumblr-wordpress-blogger-appengine-pos">How to Enable SSL on Tumblr, WordPress, Blogger, AppEngine, Posterous &amp; More...</a></p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/7yFqNnKzCvuebDWhFxuZrJ/dfbf4796682c1de65ca1979d5bea434c/app-engine.jpg.scaled500.jpg" alt="SSL on Custom Domains for AppEngine and Other Cloud Services" class="kg-image" width="250" height="250" loading="lazy">

	</figure>
	<p>We read every email we get and receive terrific feature suggestions from our users all the time. One of them the other day told us about a problem he was having with Google AppEngine. It turns out that, if you want to use SSL on AppEngine, you need to use a appspot.com subdomain, not your own custom domain. This has generated <a href="https://code.google.com/p/googleappengine/issues/detail?id=792">more than 1,000 requests from AppEngine developers for a fix</a>. There have been some <a href="http://radomirml.com/2011/01/30/reverse-proxy-for-gae-application-using-nginx-and-ssl">suggested solutions</a>, but they generally require you to give up many of the benefits of running in the cloud. Google AppEngine isn't alone. SSL in the cloud ishard, and Amazon's EC2 and other cloud services suffer the same issues.</p>
	<p>Here's a bit of detail on the core problem. SSL is tied to a particular domain and, usually, an IP address. Managing SSL certificates in an elastic cloud environment is non-trivial. As a result, many cloud providers don't support SSL at all or, like AppEngine, create a wildcard SSL cert for their domain and force everyone who wants SSL to send requests to that. Unfortunately, if you try and make a request toAppEngine from your own domain then the SSL certificate won't validate. We initially thought we could solve this as a proxy just by ignoring SSLerrors from the origin, but AppEngine also routes based on the host header. If the host header isn't a subdomain off appspot.org then traffic gets rerouted to the Google home page.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/slt3lc6tev37/2COGbm2z3xSo0k2o4dCJhj/a53b2837160793e1325ca16babdfb190/host_override_header.jpg.scaled500.jpg" alt="SSL on Custom Domains for AppEngine and Other Cloud Services" class="kg-image" width="500" height="73" loading="lazy">

	</figure>
	<p>At CloudFlare, we've developed a ton of technology around managing SSL in the cloud. As a result, we realized we could do something to solve these issues with AppEngine and other cloud services. Yesterday we quietly turned on a new feature we're tentatively calling Host Override Header. It will show up in your CloudFlare Settings page if you have SSL enabled for your domain. The function works by changing the HOST header sent when CloudFlare connects to an origin server. This means that, if you're hosted on AppEngine, you can enter &lt;yourkey&gt;.appspot.com and enable the Host Override Header. Your visitors can use a HTTPS connection to visit your custom domain, but as far as AppEngine knows, they'll be entering an appspot.com subdomain. Not only does this seem more professional and usable, but it also helps developers keep sessions consistent between HTTP and HTTPS connections.</p>
	<p>We think there are many other opportunities that lie ahead with the Host Override Header functionality, including enabling functions that extend well beyond SSL support, but we want to proceed carefully and squash any bugs that may arise. We've seen two so far. The first involves if you're currently setting the domain field when you insert a SetCookie header. If you're using the appspot.com domain then cookies won't be stored because the domains won't match. The solution is to update the domain filed to your custom domain, or, as most libraries do, just omit it and it will assume the root domain.</p>
	<p>The second bug we've seen is that in some cases where you're doing redirects you can find yourself getting into a loop. We've built in loop-detection logic, but make sure you're not redirecting traffic from an appspot.com domain back to your custom domain or you may see some issues. Inevitably, other issues will crop up. If you find them yourself, please <a href="https://www.cloudflare.com/contact">let us know</a>. In the meantime, hopefully we've made the world a bit better for the 1,000+ AppEngine developers who have been looking for a way to host on the service and still use SSL.</p>
</div>