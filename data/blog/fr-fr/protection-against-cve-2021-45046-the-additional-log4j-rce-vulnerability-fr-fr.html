<div class="mb2 gray5">2 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/01/image1-80-1.png" class="kg-image" alt="Protection contre CVE-2021-45046, la vulnérabilité RCE supplémentaire de Log4J" loading="lazy"></figure>
	<p>Talonnant de près CVE-2021-44228, une deuxième vulnérabilité CVE de Log4J a été déclarée, <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046">CVE-2021-45046</a>. Les règles que nous avons <a href="https://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation">précédemment publiées pour CVE-2021-44228</a> offrent le même niveau de protection contre cette nouvelle vulnérabilité CVE.</p>
	<p>Cette vulnérabilité est activement exploitée et toute personne utilisant Log4J doit effectuer la mise à jour vers la version 2.16.0 dès que possible, même si une mise à jour vers la version 2.15.0 a précédemment été effectuée. La nouvelle version est dès maintenant disponible sur la <a href="https://logging.apache.org/log4j/2.x/download.html">page de téléchargement de Log4j</a>.</p>
	<p>Les clients utilisant le pare-feu WAF de Cloudflare disposent de trois règles pour contribuer à l’atténuation d’éventuelles tentatives d’exploitation de la vulnérabilité :</p><!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th style="text-align:center">ID de règle</th>
				<th style="text-align:center">Description</th>
				<th style="text-align:center">Action par défaut</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:center"><code>100514</code> (ancien pare-feu WAF)<br><code>6b1cc72dff9746469d4695a474430f12</code> (nouveau pare-feu WAF)</td>
				<td style="text-align:center">En-têtes Log4j</td>
				<td style="text-align:center"><code>BLOCK</code></td>
			</tr>
			<tr>
				<td style="text-align:center"><code>100515</code> (ancien pare-feu WAF)<br><code>0c054d4e4dd5455c9ff8f01efe5abb10</code> (nouveau pare-feu WAF)</td>
				<td style="text-align:center">Corps de texte Log4j</td>
				<td style="text-align:center"><code>BLOCK</code></td>
			</tr>
			<tr>
				<td style="text-align:center"><code>100516</code> (ancien pare-feu WAF)<br><code>5f6744fa026a4638bda5b3d7d5e015dd</code> (nouveau pare-feu WAF)</td>
				<td style="text-align:center">URL Log4j</td>
				<td style="text-align:center"><code>BLOCK</code></td>
			</tr>
			<tr>
				<td style="text-align:center"></td>
				<td style="text-align:center"></td>
				<td style="text-align:center"></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>Les mesures d’atténuation ont été réparties dans trois règles permettant d’inspecter les en-têtes HTTP, le corps de texte et l’URL, respectivement.</p>
	<p>En plus des règles ci-dessus, nous avons également publié une quatrième règle offrant une protection contre un nombre considérablement supérieur d’attaques, au prix d’un taux de faux positifs plus élevé. Pour cette raison, nous l’avons mise à disposition, mais ne l’avons pas définie sur <code>BLOCK</code> par défaut :</p><!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th style="text-align:center">ID de règle</th>
				<th style="text-align:center">Description</th>
				<th style="text-align:center">Action par défaut</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="text-align:center"><code>100517</code> (ancien pare-feu WAF)<br><code>2c5413e155db4365befe0df160ba67d7</code> (nouveau pare-feu WAF)</td>
				<td style="text-align:center">Log4J Advanced URI, Headers</td>
				<td style="text-align:center"><code>DISABLED</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="qui-est-concern-">Qui est concerné ?</h3>
	<p>Log4J est une puissante bibliothèque de journalisation Java, gérée par Apache Software Foundation.</p>
	<p>Dans toutes les versions &gt;= 2.0-beta9 et &lt;= 2.14.1 de Log4J, les fonctionnalités JNDI utilisées dans la configuration, les messages de fichier journal et les paramètres peuvent être exploitées par un acteur malveillant pour lancer une exécution de code à distance. Plus précisément, un acteur malveillant pouvant contrôler les messages de fichier journal ou les paramètres des messages de fichier journal peut exécuter du code arbitraire chargé depuis des serveurs LDAP lorsque la substitution de recherche de messages est activée.</p>
	<p>Par ailleurs, les atténuations précédentes pour CVE-2021-22448, telle qu’elle a été observée dans la version 2.15.0, n’étaient pas adéquates pour offrir une protection contre CVE-2021-45046.</p>
</div>