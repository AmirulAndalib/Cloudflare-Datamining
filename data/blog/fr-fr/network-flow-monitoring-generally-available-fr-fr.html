<div class="mb2 gray5">9 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/image4-4.png" class="kg-image" alt="Network flow monitoring is GA, providing end-to-end traffic visibility" loading="lazy" width="1999" height="1125"></figure>
	<p>Les ingénieurs réseau constatent souvent qu'ils ont besoin d'une meilleure visibilité du trafic et des opérations de leur réseau lors de l'analyse d'attaques DDoS ou de la résolution d'autres incidents liés au trafic. Ces ingénieurs disposent généralement d'un certain nombre d'indicateurs de haut niveau concernant le trafic sur leur réseau ; cependant, ils parviennent difficilement à collecter des informations essentielles, permettant de clarifier l'incident, sur les flux de trafic spécifiques. Pour résoudre ce problème, Cloudflare a piloté un produit de surveillance des flux réseau cloud appelé <a href="https://www.cloudflare.com/network-services/products/magic-network-monitoring" target="_blank">Magic Network Monitoring</a>, qui offre aux clients une visibilité exhaustive de l'ensemble du trafic de leur réseau.</p>
	<p>Aujourd'hui, Cloudflare est heureuse d'annoncer que le service Magic Network Monitoring (précédemment appelé <a href="https://blog.cloudflare.com/flow-based-monitoring-for-magic-transit">Flow Based Monitoring</a>) est désormais disponible pour tous les clients Enterprise. Au cours de l'année passée, l'équipe d'ingénieurs de Cloudflare a apporté un nombre considérable d'améliorations à Magic Network Monitoring, et nous sommes aujourd'hui heureux de proposer un produit de services réseau qui aidera nos clients à identifier plus rapidement les menaces, à réduire les vulnérabilités et à rendre leur réseau plus sûr.<br><br>Magic Network Monitoring est activé automatiquement pour tous les clients Enterprise utilisant Magic Transit et Magic WAN. Le produit est accessible au niveau du compte depuis le tableau de bord de Cloudflare, et peut être démarré en sélectionnant Analytics &amp; Logs (Analyses de données et journaux), puis Magic Monitoring. Le processus d'intégration de Magic Network Monitoring se déroule en libre-service, et tous les clients Enterprise disposant d'un accès à celui-ci peuvent commencer à configurer le produit dès aujourd'hui.</p>
	<p>Les clients Enterprise qui n'ont pas accès à Magic Transit ou Magic WAN et souhaitent tester Magic Network Monitoring peuvent obtenir un accès à la version gratuite (qui comporte des <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">limitations</a> sur le volume de trafic) en transmettant une demande à l'équipe de Cloudflare chargée de leur compte ou en renseignant ce formulaire pour <a href="http://network-services/products/magic-network-monitoring" target="_blank">parler avec un expert</a>.</p>
	<h3 id="quest-ce-que-magic-network-monitoring">Qu'est-ce que Magic Network Monitoring ?</h3>
	<p>Magic Network Monitoring est un service de surveillance des flux réseau cloud. Le terme « <a href="https://en.wikipedia.org/wiki/Traffic_flow_(computer_networking)" target="_blank">flux de trafic réseau</a> » désigne tout flux de paquets circulant entre une source et une destination avec le même protocole Internet et le même ensemble de ports. Les clients peuvent transmettre des rapports concernant les flux réseau acheminés depuis leurs routeurs (ou tout autre appareil générant des flux réseau) vers un point de terminaison accessible au public sur le <a href="https://www.cloudflare.com/learning/cdn/glossary/anycast-network" target="_blank">réseau anycast de Cloudflare</a>, même si le trafic n'a pas initialement transité sur le réseau de Cloudflare. Cloudflare analyse les données des flux réseau, puis fournit aux clients une visibilité des indicateurs essentiels du trafic du réseau par le biais d'un tableau de bord d'analyse de données. Ces mesures incluent notamment le volume de trafic (en bits ou en paquets) au fil du temps, les adresses IP source, les adresses IP de destination, les ports, les protocoles de trafic et les adresses IP des routeurs. Les clients peuvent également configurer des alertes afin d'identifier les <a href="https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack" target="_blank">attaques DDoS</a> et toute autre activité entraînant des volumes de trafic anormaux.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/1-1.png" class="kg-image" alt="" loading="lazy" width="1435" height="802">
		<figcaption>Transmettez les données des flux de votre réseau à Cloudflare à des fins d'analyse.</figcaption>
	</figure>
	<h3 id="d%C3%A9tection-des-types-dattaques-ddos-de-loffre-enterprise">Détection des types d'attaques DDoS de l'offre Enterprise</h3>
	<p>Les clients utilisateurs de <a href="https://developers.cloudflare.com/magic-transit/on-demand" target="_blank">Magic Transit On Demand</a> (MTOD) constateront des avantages considérables, en termes de visibilité du trafic, lors de l'utilisation de Magic Network Monitoring. <a href="https://www.cloudflare.com/network-services/products/magic-transit" target="_blank">Magic Transit</a> est une solution de sécurité réseau qui offre une protection contre les attaques DDoS et une accélération du trafic depuis chaque datacenter Cloudflare pour les réseaux sur site, hébergés dans le cloud et hybrides. Les clients de Magic Transit On Demand peuvent activer Magic Transit pour se protéger en cas de détection d'une attaque DDoS.</p>
	<p>En règle générale, nous avons constaté que certains clients utilisateurs de MTOD ne disposaient pas des outils de visibilité du réseau indispensables pour identifier rapidement les attaques DDoS et prendre les mesures d'atténuation appropriées. Désormais, les clients utilisateurs de MTOD peuvent utiliser Magic Network Monitoring pour analyser les données de leur réseau et recevoir une alerte en cas de détection d'une attaque DDoS.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/2-1.png" class="kg-image" alt="" loading="lazy" width="1436" height="761">
		<figcaption>Cloudflare détecte une attaque DDoS en analysant les données des flux réseau du client.</figcaption>
	</figure>
	<p>Lorsqu'une attaque DDoS est détectée, les clients utilisant Magic Network Monitoring peuvent choisir d'activer Magic Transit manuellement ou automatiquement, afin d'atténuer l'attaque DDoS.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/10/3-1.png" class="kg-image" alt="" loading="lazy" width="1436" height="761">
		<figcaption>Activez Magic Transit pour vous protéger contre les attaques DDoS.</figcaption>
	</figure>
	<h3 id="surveillance-des-r%C3%A9seaux-dentreprise">Surveillance des réseaux d'entreprise</h3>
	<p>Les clients utilisateurs des solutions Magic WAN et Cloudflare One de Cloudflare peuvent également bénéficier de Magic Network Monitoring. Ces clients disposent aujourd'hui d'une excellente visibilité du trafic qu'ils transmettent sur le réseau de Cloudflare, mais ils manquent parfois de visibilité sur le trafic qui n'est pas acheminé sur le réseau de Cloudflare. Il peut s'agir du trafic transitant exclusivement sur un réseau local ou du trafic réseau acheminé entre des environnements cloud. Les clients utilisant Magic WAN et Cloudflare One peuvent ajouter Magic Network Monitoring à leur portefeuille de solutions afin de bénéficier d'une visibilité exhaustive de l'ensemble du trafic de leur réseau.</p>
	<h3 id="un-examen-approfondi-de-l%C3%A9chantillonnage-des-flux-et-du-trafic-sur-le-r%C3%A9seau">Un examen approfondi de l'échantillonnage des flux et du trafic sur le réseau</h3>
	<p>Magic Network Monitoring fournit aux clients une meilleure visibilité sur leur trafic réseau en ingérant et en analysant les données du flux réseau.</p>
	<p>Le processus démarre lorsqu'un routeur (ou un autre appareil générant des flux réseau) collecte des <a href="https://en.wikipedia.org/wiki/Sampling_(statistics)" target="_blank">échantillons statistiques</a> de données de paquets entrants et/ou sortants. Ces échantillons sont collectés en examinant 1 paquet sur X, où X est le taux d'échantillonnage configuré sur le routeur. Les taux d'échantillonnage sont habituellement compris entre 1 pour 1 000 et 1 pour 4 000 paquets. Le taux d'échantillonnage idéal dépend du volume et de la diversité du trafic, ainsi que de la puissance de calcul et de la mémoire du matériel du routeur. Pour plus d'informations sur le <a href="https://developers.cloudflare.com/magic-network-monitoring/routers/recommended-sampling-rate" target="_blank">taux d'échantillonnage recommandé des flux réseau</a>, veuillez consulter la documentation pour développeurs MNM de Cloudflare.</p>
	<p>Les données échantillonnées sont présentées dans l'un des deux formats standard de l'industrie pour les données de flux réseau, à savoir NetFlow ou sFlow. Au format NetFlow, les données des paquets échantillonnés sont regroupées en fonction de différentes caractéristiques des paquets, telles que l'adresse IP source/de destination, le port et le protocole. Chaque groupe de données de paquets échantillonnés inclut également une estimation du volume de trafic. Au format sFlow, l'intégralité de l'en-tête du paquet est sélectionnée en tant qu'échantillon représentatif, et aucune compression des données n'est effectuée. Par conséquent, sFlow est un format de données plus riche, qui propose des informations plus détaillées sur le trafic réseau que les données NetFlow. Une fois collectés, les échantillons de données NetFlow ou sFlow collectés sont transmis à Magic Network Monitoring aux fins de l'analyse et de la gestion des alertes.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/4-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="400"></figure>
	<h3 id="pourquoi-l%C3%A9chantillonnage-al%C3%A9atoire-simple-n%C3%A9tait-pas-viable-pour-magic-network-monitoring">Pourquoi l'échantillonnage aléatoire simple n'était pas viable pour Magic Network Monitoring</h3>
	<p>Magic Network Monitoring a parcouru un long chemin depuis son lancement en accès anticipé, il y a un an de cela. L'équipe d'ingénieurs de Cloudflare a, en particulier, consacré beaucoup d'efforts à l'amélioration de la précision des estimations du volume de trafic dans MNM. Dans la version de Magic Network Monitoring proposée en accès anticipé, les clients signalaient, de manière inattendue, que les estimations de leurs volumes de trafic réseau étaient trop élevées et ne correspondaient pas aux valeurs attendues.<br><br>Magic Network Monitoring effectue son propre échantillonnage des données NetFlow ou sFlow reçues par le service, lui permettant d'étendre et de gérer efficacement les données ingérées sur l'ensemble du réseau mondial de Cloudflare. Il a été plus difficile que prévu d'améliorer la précision des estimations du volume de trafic, car les données NetFlow ou sFlow analysées par MNM reposent déjà sur des données de paquets échantillonnées. Cela introduit plusieurs couches distinctes d'échantillonnage de données dans les analyses de données du produit.</p>
	<p>La première version de Magic Network Monitoring utilisait un <a href="https://en.wikipedia.org/wiki/Simple_random_sample" target="_blank">échantillonnage aléatoire</a>, dans lequel un sous-ensemble aléatoire de données de flux réseau avec les mêmes informations d'horodatage était sélectionné pour représenter le volume de trafic à un instant précis. Une caractéristique des données de flux réseau est que certains échantillons sont plus significatifs que d'autres et représentent un volume de trafic réseau plus important. Afin de tenir compte de cette importance, nous pouvons associer une <a href="https://en.wikipedia.org/wiki/Weighting" target="_blank">pondération</a> à chaque échantillon, en fonction du volume de trafic qu'il représente. Les pondérations des données de flux réseau sont toujours des nombres positifs, et suivent le modèle d'une <a href="https://en.wikipedia.org/wiki/Long_tail" target="_blank">distribution à longue traîne</a>. En raison de ces caractéristiques des données, l'échantillonnage aléatoire de MNM évaluait incorrectement le volume de trafic du réseau des clients. Par conséquent, les clients observaient de faux pics dans leurs analyses de données du volume de trafic lorsqu'un échantillon de données aberrant issu de la longue traîne était aléatoirement sélectionné pour être représentatif de l'ensemble du trafic à cet instant.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/5-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="400"></figure>
	<h3 id="am%C3%A9liorer-la-pr%C3%A9cision-avec-l%C3%A9chantillonnage-par-r%C3%A9servoir-varopt">Améliorer la précision avec l'échantillonnage par réservoir VarOpt</h3>
	<p>Pour résoudre ce problème, l'équipe de développement de Cloudflare a eu recours à une technique alternative d'<a href="https://en.wikipedia.org/wiki/Reservoir_sampling" target="_blank">échantillonnage par réservoir</a>, appelée <a href="https://arxiv.org/pdf/0803.0473.pdf" target="_blank">VarOpt</a>. VarOpt est conçue pour collecter des échantillons à partir d'un flux de données dont la longueur est inconnue (une application parfaite pour l'analyse des données de flux réseau entrants). Dans l'implémentation MNM de VarOpt, nous commençons avec un réservoir vide, de taille fixe, rempli d'échantillons de données de flux réseau. Lorsque le réservoir est plein et que de nouvelles données de flux de réseau continuent d'être reçues, un ancien échantillon est supprimé aléatoirement du réservoir, puis remplacé par un nouvel échantillon. </p>
	<p>Après avoir observé un certain nombre d'échantillons, nous calculons le volume de trafic pour l'ensemble des échantillons pondérés du réservoir ; la valeur obtenue correspond au volume de trafic estimé du flux de réseau d'un client à cet instant. Enfin, le réservoir est vidé et la boucle VarOpt redémarre, le réservoir étant rempli avec la prochaine série d'échantillons de flux de réseau les plus récents.</p>
	<p>La nouvelle méthode d'échantillonnage VarOpt a considérablement amélioré la précision des estimations du volume de trafic dans Magic Network Monitoring et a permis de résoudre les problèmes de nos clients. Ces améliorations de l'échantillonnage ont ouvert la voie à la disponibilité générale du service, et nous sommes ravis de mettre à la disposition de tous des analyses de données précises des flux réseau.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/10/6-1.png" class="kg-image" alt="" loading="lazy" width="1600" height="320"></figure>
	<h3 id="documentation-pour-d%C3%A9veloppeurs-et-communaut%C3%A9-discord">Documentation pour développeurs et communauté Discord</h3>
	<p>Il existe des <a href="https://developers.cloudflare.com/magic-network-monitoring" target="_blank">documentations pour développeurs détaillées consacrées à Magic Network Monitoring</a>, qui expliquent les fonctionnalités du produit et proposent un guide de configuration étape par étape destiné aux nouveaux clients. Pendant que vous consultez la documentation de Magic Network Monitoring, n'hésitez pas à nous faire part de vos commentaires en cliquant sur le bouton « Give Feedback » (Envoyer un commentaire) dans le coin supérieur droit de la documentation pour développeurs.</p>
	<p>Nous avons également créé, dans la communauté Discord de Cloudflare, un canal consacré au débogage des problèmes de configuration, aux tests de nouvelles fonctionnalités et à la publication de commentaires sur les produits. Vous pouvez suivre ce lien pour rejoindre le <a href="https://discord.gg/cloudflaredev" target="_blank">serveur Discord de Cloudflare</a>.</p>
	<h3 id="version-gratuite">Version gratuite</h3>
	<p>Une <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">version gratuite de Magic Network Monitoring</a> est disponible pour tous les clients Enterprise sur simple demande auprès de l'équipe Cloudflare chargée de leur compte. La version gratuite est conçue pour permettre aux clients Enterprise de tester et d'évaluer rapidement Magic Network Monitoring avant d'acheter Magic Transit, Magic WAN ou Cloudflare One. Les clients Enterprise peuvent configurer entièrement Magic Network Monitoring eux-mêmes en suivant le <a href="https://developers.cloudflare.com/magic-network-monitoring/get-started" target="_blank">guide d'intégration étape par étape</a> inclus dans la documentation du produit. La version gratuite comporte certaines <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">limitations</a> concernant la quantité de trafic pouvant être traitée ; ces limitations sont décrites plus en détail dans la documentation du produit.</p>
	<p>La version gratuite de Magic Network Monitoring est également disponible pour tous les clients de Cloudflare souscripteurs d'une offre gratuite, Pro et Business, par l'intermédiaire d'une version beta fermée. Tous les utilisateurs peuvent demander à accéder à la version gratuite ; pour cela, <a href="https://developers.cloudflare.com/magic-network-monitoring/magic-network-monitoring-free" target="_blank">consultez la documentation de la version gratuite</a>, puis <a href="https://forms.gle/z93ghpydpKdAFZ7P9" target="_blank">renseignez ce formulaire</a>. Un accès prioritaire est accordé à tout utilisateur rejoignant le <a href="https://discord.com/invite/cloudflaredev" target="_blank">serveur Discord de Cloudflare</a> et publiant un message sur le canal Discord de Magic Network Monitoring.</p>
	<h3 id="les-prochaines-%C3%A9tapes-que-vous-pouvez-effectuer-aujourdhui">Les prochaines étapes que vous pouvez effectuer aujourd'hui</h3>
	<p>Magic Network Monitoring est proposé en disponibilité générale, et tous les clients utilisateurs de Magic Transit et Magic WAN ont dès aujourd'hui automatiquement reçu un accès au produit. Pour trouver le produit, accédez à votre compte depuis le tableau de bord de Cloudflare, puis sélectionnez Analytics &amp; Logs (Analyses de données et journaux) &gt; Magic Monitoring.</p>
	<p>Si vous êtes client Enterprise, mais n'êtes pas utilisateur de Magic Transit ou Magic WAN, et vous souhaitez utiliser Magic Network Monitoring pour améliorer votre visibilité de votre trafic, vous pouvez <a href="http://network-services/products/magic-network-monitoring" target="_blank">échanger dès aujourd'hui avec un expert de MNM</a>.<br><br>Si vous souhaitez utiliser Magic Transit et Magic Network Monitoring pour vous protéger contre les attaques DDoS, vous pouvez <a href="https://www.cloudflare.com/network-services/products/magic-transit" target="_blank">demander une démo de Magic Transit</a>. Si vous souhaitez utiliser Magic WAN et Magic Network Monitoring ensemble pour bénéficier d'une visibilité exhaustive du trafic réseau, vous pouvez <a href="https://www.cloudflare.com/network-services/products/magic-wan" target="_blank">parler avec un expert de Magic WAN</a>.</p>
</div>