<div class="mb2 gray5 ">11 min. de lecture</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/03/image5-4.png" class="kg-image" alt="Announcing the Cloudflare API Gateway" loading="lazy"></figure>
	<p>Au cours de la dernière décennie, l'Internet a connu un changement tectonique. Il était auparavant constitué de sites web statiques comprenant du texte, des images et, parfois, un film intégré. Mais l'Internet s'est énormément développé. Nous comptons désormais sur des applications basées sur des API pour nous aider dans pratiquement tous les aspects de la vie. Au lieu de simplement télécharger des fichiers, nous sommes capables d'<em>interagir</em> avec des applications en échangeant des données riches. Nous suivons nos séances d'entraînement et nous envoyons les résultats dans le Cloud. Nous utilisons des serrures intelligentes et toutes sortes d'appareils IdO, et nous interagissons avec nos amis en ligne.</p>
	<p>Tout cela est fantastique, mais implique une explosion de la complexité au niveau du back-end. Pourquoi ? Les développeurs doivent gérer des API pour prendre ces fonctionnalités en charge. Ils doivent surveiller et authentifier chaque requête. Et parce que ces tâches sont si complexes, elles sont généralement externalisées pour être traitées par un fournisseur de passerelle pour API.</p>
	<p>Malheureusement, les passerelles actuelles laissent beaucoup à désirer. D'abord, elles ne sont pas bon marché. Ensuite, elles ont un impact sur les performances et enfin, elles comportent un risque pour les données et la confidentialité, puisque <a href="https://blog.cloudflare.com/landscape-of-api-traffic">plus de 50 % du trafic</a> est transmis aux API (et est vraisemblablement transmis par une passerelle tierce). Quelle pagaille !</p>
	<p>Aujourd'hui, nous annonçons la passerelle Cloudflare API Gateway. <strong>Nous allons remplacer entièrement votre passerelle existante pour un coût bien moindre.</strong> Et notre solution utilise la technologie sur laquelle reposent <a href="https://workers.cloudflare.com">Workers</a>, <a href="https://www.cloudflare.com/products/bot-management">Bot Management</a>, <a href="https://www.cloudflare.com/products/zero-trust/access">Access</a> et les <a href="https://developers.cloudflare.com/rules/transform">Règles de transformation</a> pour offrir la suite d'outils pour API la plus évoluée du marché.</p>
	<p>Qu'est-ce que la passerelle pour API ?</p>
	<p>En résumé, il s'agit d'un ensemble de fonctionnalités qui feront tout pour vos API. Nous la divisons en trois catégories :<br></p>
	<p><strong>Sécurité</strong><br></p>
	<p>Il s'agit des produits que nous avons déjà présentés dans nos articles de blog : des outils tels que <a href="https://developers.cloudflare.com/api-shield/products/api-discovery">Découverte</a>, <a href="https://developers.cloudflare.com/api-shield/products/schema-validation">Validation de schéma</a>, <a href="https://developers.cloudflare.com/api-shield/products/volumetric-abuse-detection">Protection contre l'utilisation abusive</a> et d'autres. Nous avons passé beaucoup de temps à appliquer notre expertise en matière de sécurité au monde des API.<br></p>
	<p><strong>Gestion et surveillance</strong><br></p>
	<p>Il s'agit des outils fondamentaux qui assurent le bon fonctionnement de vos API. Quelques exemples : l'analyse des données, le routage et l'authentification. Nous sommes déjà en mesure d'accomplir ces tâches avec des produits existants comme <a href="https://www.cloudflare.com/products/zero-trust/access">Cloudflare Access</a>, et d'autres fonctionnalités sont en cours de développement.<br></p>
	<p><strong>Tout le reste</strong><br></p>
	<p>Ce sont ces petits éléments cruciaux qui permettent à l'ensemble de fonctionner. Cloudflare propose déjà des services de terminaison SSL/TLS, d'équilibrage de charge et de proxy qui peuvent être exécutés par défaut.<br></p>
	<p>L'article de blog d'aujourd'hui décrit chaque fonctionnalité dans le détail. Nous sommes ravis d'annoncer que <em>toutes</em> les fonctionnalités de sécurité sont désormais généralement disponibles, alors commençons par parler de celles-ci.</p>
	<p>Découverte</p>
	<p>Nos clients sont désireux de protéger leurs API. Malheureusement, ils n'ont pas toujours documenté ces points de terminaison – ou pire, ils <em>pensent</em> que tout est documenté, mais certains points de terminaison ont été perdus ou modifiés à leur insu. Ces points de terminaison cachés sont parfois appelés « <a href="https://www.bearer.com/resources/shadow-apis-detect-business-risk">API fantômes</a> ». Nous devons commencer notre voyage par une représentation exhaustive (et précise) de la surface des API.<br></p>
	<p>C'est ici que la Découverte entre en jeu. Rendez-vous sur le tableau de bord de Cloudflare, sélectionnez l'onglet <strong>Sécurité</strong>, puis choisissez « API Shield ». Activez la fonctionnalité et indiquez-nous comment vous souhaitez identifier votre trafic d'API. La plupart des utilisateurs fournissent un en-tête (disponible aujourd'hui), mais nous pouvons également utiliser le corps de la requête ou le cookie (disponible prochainement).<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh5.googleusercontent.com/SJ5ACkYBQm84bc9oLXLZnkw0zeyQSXL4gQVZPrYOEAOfGJPfo39j49dW0N9kmggx0SUwXQ0AdS_gozXWXX-do4G5e1YLdEgpi8er5TCNd5SAzEqhkX-9XCcXuj5LaQpVxSsKU2ykq0DbxhlADw" class="kg-image" alt="" loading="lazy"></figure>
	<p>[alt text: L'onglet Cloudflare API Shield, qui présente les différents points de terminaison qui ont été découverts, ainsi qu'un ensemble de seuils recommandés de limitation du taux.]<br></p>
	<p>Nous fournissons une liste exhaustive de vos points de terminaison d'API. Cloudflare répertorie chaque méthode et chemin et fournit des métadonnées supplémentaires pour vous aider à comprendre votre surface. Nous <em>réduisons</em> même les points de terminaison qui incluent des variables (par exemple, <em>/account/<strong>217</strong></em>) afin qu'ils deviennent généralement applicables (par exemple, <em>/account/<strong>{var1}</strong></em>).<br></p>
	<p>Découverte est une puissante contre-mesure à l'entropie. Nos clients s'attendent souvent à trouver 30 points de terminaison, mais sont surpris de découvrir qu'ils ont plus de <em>100</em> points de terminaison actifs.</p>
	<p>Validation de schéma</p>
	<p>Peut-être avez-vous déjà un schéma pour vos points de terminaison d'API. Un schéma s'apparente à un modèle : il fournit les chemins, les méthodes et les données supplémentaires que vous vous attendez à trouver dans les requêtes d'API. De nombreux développeurs se conforment à la <a href="https://swagger.io/specification">norme OpenAPI</a> pour générer (et maintenir) un schéma.<br></p>
	<p>Pour renforcer votre sécurité, nous pouvons <em>valider</em> le trafic entrant par rapport à ce schéma. Il s'agit d'un excellent moyen d'arrêter les attaques simples. Cloudflare refusera les requêtes non conformes et écartera le trafic incohérent qui ignore le code vestimentaire. Il suffit de télécharger votre schéma sur le tableau de bord, de sélectionner les actions que vous voulez entreprendre, puis de déployer :<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh5.googleusercontent.com/gxuZNJZtzbUfun29E87cocfI6H0NvIIowhMt9BmKH1YxjWxmzdrh0uEUOpac1Jnxwh5oL2y9FuPP-m6LEUVr5-MKX4nD0Qt2Dr4_uOrUEZ31hYP8MeleQGcQWCa0lXY9-P5ywSSXdYyRxwtyjw" class="kg-image" alt="" loading="lazy"></figure>
	<p>[alt text: Une étape du processus de téléchargement du schéma, après qu'un schéma ait déjà été fourni. Cloudflare répertorie chaque point de terminaison avec le chemin, la requête, l'en-tête, les cookies et le corps fournis sous forme de métadonnées.]<br></p>
	<p>La Validation de schéma a déjà contrôlé le trafic de certains des plus grands sites de cryptomonnaies, services de livraison et plateformes de paiement du monde. Elle est disponible dès maintenant, et nous ajouterons prochainement la validation du corps.</p>
	<p>Protection contre l'utilisation abusive</p>
	<p>Une approche performante de la sécurité utilisera conjointement la Validation de schéma <em>et</em> la Découverte afin d'assurer que le trafic correspond au format attendu. Mais qu'en est-il du trafic abusif qui passe à travers les mailles du filet ?<br></p>
	<p>À mesure que Cloudflare découvre de nouveaux points de terminaison d'API, <em>nous suggérons des limites de taux</em> pour chacun d'eux. C'est le rôle de la Protection contre l'utilisation abusive, et elle ouvre la porte à un type de sécurité plus sophistiqué.<br></p>
	<p>Prenons l'exemple d'un point de terminaison API qui renvoie des informations météorologiques. Plus précisément, le point de terminaison renvoie « oui » s'il est probable qu'il neige dans l'heure qui suit, et « non » sinon. Notre algorithme pourrait détecter que l'utilisateur moyen demande ces données une fois toutes les 10 minutes. En revanche, un petit groupe de bots d'extraction de données transmet 37 requêtes toutes les 10 minutes. Cloudflare préconise automatiquement un seuil intermédiaire, pondéré de manière à laisser un peu de répit aux utilisateurs normaux. Ce seuil empêchera les services d'extraction de données abusifs de récupérer trop fréquemment les données météorologiques.<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh3.googleusercontent.com/Oappj32CWXxkP4jc8k1pTzSlEUmvRMWN07Ds2wT2PvEfvhWn9x2KRJq21gLxw0JU7-D6UGBdRN-_f8CBPGb3pTuKRIDW2KWmjWc7x6UQhhxmDTTSyH_pPBJiBE7INIcfErWhz4hQOhebqH_G4A" class="kg-image" alt="" loading="lazy"></figure>
	<p><br></p>
	<p>Nous offrons la possibilité de créer une règle avec notre nouveau moteur <a href="https://blog.cloudflare.com/advanced-rate-limiting">Advanced Rate Limiting</a>. Vous pouvez utiliser des cookies, des en-têtes, etc. pour définir précisément les seuils. Nous utilisons la protection contre l'utilisation abusive pour protéger <a href="https://api.cloudflare.com">api.cloudflare.com</a> depuis des mois, maintenant.<br></p>
	<p>Notre aspect préféré de cette fonctionnalité : elle s'appuie sur l'approche de l'apprentissage automatique que nous utilisons pour <a href="https://www.cloudflare.com/products/bot-management">Bot Management</a>. Une autre façon pour nos produits de s'enrichir mutuellement et progresser.<br></p>
	<p>La Protection contre l'utilisation abusive est disponible dès maintenant. Si vous êtes intéressé par la protection séquentielle<a href="https://blog.cloudflare.com/api-abuse-detection"> contre l'utilisation abusive, que nous utilisons pour signaler les flux de requêtes anormaux, consultez notre </a>précédent article de blog. La composante séquentielle est disponible en accès anticipé et nous continuons à l'améliorer avant un lancement officiel.</p>
	<p>mTLS</p>
	<p>Le protocole TLS à authentification réciproque élève la sécurité au niveau supérieur. Vous pouvez utiliser des certificats pour valider le trafic entrant à mesure qu'il atteint vos API – ce qui est particulièrement utile pour les appareils mobiles et IdO. Il s'agit en outre d'un excellent modèle de sécurité positive qui peut (et devrait) être adopté pour la plupart des écosystèmes d'appareils.<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/LLo_6edMQpwG-_bCdQXwcBrkMQefN5ufiAsoXkUpG-uwCCNAMmiu38NQZmIjG9wfr9HeVUu1mQzxJWE18MNH0NN8cjWArIxEi6yy_YwW1ILfktltCOzjm0TFcEJXijdeg89_w5m2t_ni7ow0FQ" class="kg-image" alt="" loading="lazy"></figure>
	<p><br></p>
	<p>À titre d'exemple, revenons à notre API météorologique. Ce service comprend peut-être un deuxième point de terminaison, qui <em>reçoit</em> la température actuelle d'un thermomètre. Il y a un problème, toutefois : n'importe qui peut transmettre de fausses requêtes en fournissant des relevés inexacts au point de terminaison. Pour éviter cela, utilisez mTLS pour installer un certificat client sur le <em>véritable</em> thermomètre, puis permettez à Cloudflare de valider ce certificat. Toute autre requête sera rejetée. Problème résolu !<br></p>
	<p>Nous offrons déjà un ensemble de certificats gratuits à chaque client de Cloudflare. Cela va continuer. À partir d'aujourd'hui, toutefois, les clients utilisateurs de la passerelle pour API reçoivent par défaut un nombre <em>illimité</em> de certificats.</p>
	<p>Authentification</p>
	<p>De nombreuses API modernes nécessitent une authentification. En réalité, l'authentification permet d'accéder à toutes sortes de capacités : elle permet l'ouverture de sessions (avec connexion) et l'échange de données personnelles et améliore l'efficacité de l'infrastructure. Et, bien entendu, Cloudflare protège le trafic authentifié pendant qu'il transite sur notre réseau.<br></p>
	<p>Avec la passerelle pour API, toutefois, Cloudflare joue un rôle plus actif dans l'authentification du trafic, en facilitant l'<strong>émission</strong> et la <strong>validation</strong> des éléments suivants :<br></p>
	<ul>
		<li>Clés d'API</li>
		<li>Jetons JSON Web Token (JWT)</li>
		<li>Jetons OAuth 2.0<br></li>
	</ul>
	<p>Nous utilisons les listes de contrôle d'accès pour vous aider à gérer différents groupes d'utilisateurs avec des autorisations variables. Et c'est important, car votre fournisseur actuel introduit une latence élevée et de nombreux échanges de données inutiles. Si une requête doit transiter <em>vers l'extérieur</em> de l'écosystème Cloudflare, elle voyage plus loin qu'elle ne le devrait :<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/GVFeY3bCc3IJBjCs-lF8qrwraSfrCP7FZqTkMH-xj4PBUjWzCk3FAz5ZBz1Us4iPZ9ebbA8jNB3yFrQZuI_G9GETkyEAqeYJkTqneEp_H5KJ7l4d5R_2FmJF5NCwhHhaZFsMzeecAkCwlfvmIA" class="kg-image" alt="" loading="lazy"></figure>
	<p>[description de l'image : Latence supplémentaire due à l'envoi de requêtes hors du réseau Cloudflare aux fins de l'authentification.]<br></p>
	<p>Cloudflare peut s'authentifier sur notre réseau mondial et traiter beaucoup plus rapidement les requêtes. Ce type de technologie est difficile à mettre en œuvre, mais nous avons estimé qu'elle était trop importante pour être ignorée. Comment l'avons-nous construite si rapidement ? <a href="https://www.cloudflare.com/products/zero-trust/access">Cloudflare Access</a>. Nous avons puisé dans notre expérience de la collaboration avec les fournisseurs d'identité et, une fois encore, nous l'avons transposée dans le monde des API. Notre passerelle inclut une authentification illimitée et l'échange de jetons. Ces fonctionnalités seront disponibles prochainement.</p>
	<p>Routage et gestion</p>
	<p>Parlons brièvement des <a href="https://www.cloudflare.com/learning/serverless/glossary/serverless-microservice">microservices</a>. Les applications modernes sont des mastodontes, c'est pourquoi les développeurs les scindent en fragments appelés « microservices ».<br></p>
	<p>Prenons l'exemple d'une application qui vous permet de réserver une chambre d'hôtel. Elle peut utiliser un microservice pour récupérer les disponibilités, un autre pour récupérer les tarifs et un autre encore pour récupérer les types de chambres. Une équipe différente peut gérer chaque microservice, mais ils doivent tous être disponibles à partir d'un point d'entrée public unique :<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/xT85EK4BDkClMgna04IYeG4gF8NQtYMtMW8df9CpXp_GcmVd6aLj33YMdhsJ805HmCculgY7eIMYIlYb6jNdQKjGSKZTVT8YCCSLqwQtt4zyZ28AvOgvPKAlcN-xlry9rvPQMZDPa3wAU7uJsQ" class="kg-image" alt="" loading="lazy"></figure>
	<p>[description de l'image : Les différentes étapes d'une architecture reposant sur des microservices. Un visiteur transmet une requête à l'API d'un hôtel, qui est ensuite acheminée vers les dates, les tarifs ou les types de chambres disponibles.]<br></p>
	<p>Ce point d'entrée unique, traditionnellement géré par une passerelle pour API, gère le <em>routage</em> de chaque requête vers le microservice correspondant. Un grand nombre de nos clients paient, depuis des années, des services autonomes pour remplir ce rôle. Ce n'est plus nécessaire. Nous avons étendu les <a href="https://blog.cloudflare.com/introducing-transform-rules-with-url-rewriting-at-the-edge">Règles de transformation</a> de Cloudflare pour réécrire et réacheminer dynamiquement à la périphérie. Le produit est facile à configurer, rapide à déployer et nativement intégré dans la passerelle pour API. Cloudflare peut désormais être le point d'entrée unique de votre API.<br></p>
	<p>Ce n'est que la partie émergée de l'iceberg. La passerelle pour API peut en réalité <em>remplacer</em> vos microservices via l'intégration avec notre produit <a href="https://workers.cloudflare.com">Workers</a>. Comment ? Prenons l'exemple de l'écriture d'une instance Workers qui exécute une action donnée – peut-être la récupération de prix d'hôtels, stockés avec <a href="https://blog.cloudflare.com/durable-objects-ga">Durable Objects</a> sur notre réseau. Avec la passerelle pour API, les requêtes arrivent sur notre réseau, sont acheminées vers le microservice correspondant avec les Règles de transformation, puis sont entièrement servies par Workers (toujours sur notre réseau !). Ces instances Workers peuvent contacter votre serveur origine pour obtenir des informations supplémentaires, si nécessaire.<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/q6D_jnYpZh6FU-3Fd1ZdHFQxhPuuUhV975mKf-C2-_-6CHH93JoiPRdMfpQf-_fiLj71HMCF5XNeTLHRhnRNIIEX2_506X4UMei3XTE_7eBzB87vNmAk34t3Cww7m5GME2zeK5D7u3ahtL0uzg" class="kg-image" alt="" loading="lazy"></figure>
	<p>[Description de l'image : L'architecture d'API simplifiée de Cloudflare. L'authentification, le routage, la gestion et le stockage étant gérés à la périphérie, plusieurs sauts sont éliminés].<br></p>
	<p>Les instances Workers sont plus rapides, moins coûteuses et plus simples que les autres microservices. Cette intégration sera disponible prochainement.</p>
	<p>API Analytics</p>
	<p>Nos clients nous disent qu'il est parfois plus important de <em>voir</em> le trafic des API que de le traiter. En réalité, cette tendance n'est pas spécifique aux API. Nous avons publié aujourd'hui <a href="https://blog.cloudflare.com/envoy-media-machine-learning-bot-management">un autre article de blog</a>, dans lequel nous expliquons comment un client utilise l'intelligence de nos bots pour enregistrer passivement des informations sur les menaces.<br></p>
	<figure class="kg-card kg-image-card"><img src="https://lh6.googleusercontent.com/5QCeYCBcgs-Wq53oy39l66rSkcf4kMcQAM187tq8HHFYkbFwggKlKCq4IjWODr_A85CmcMKZIvMHdXlZ_T-yskjBLqSx3gpVoi3nUUsLtYv_NSoT_3y_MKms5_P7mgoCUKh1MpfN8GFQYsbGJg" class="kg-image" alt="" loading="lazy"></figure>
	<p><br></p>
	<p>Avec API Analytics, nous avons puisé dans nos autres produits pour afficher des données utiles en temps réel. Vous pouvez afficher les points de terminaison populaires, filtrer en fonction des connaissances fournies par l'apprentissage automatique, afficher les histogrammes des seuils d'utilisation abusive et capturer les tendances.<br></p>
	<p>API Analytics sera disponible prochainement. Quand ce sera le cas, vous pourrez également exporter des rapports personnalisés et partager des informations au sein de votre organisation.</p>
	<p>Journalisation, gestion des quotas et bien davantage</p>
	<p><em>Toutes</em> nos fonctionnalités établies, telles que la mise en cache, l'équilibrage de charge et les intégrations de journaux collaborent nativement avec la passerelle pour API. Ces fonctions ne doivent pas être considérées comme des fonctions primitives de la passerelle ; elles sont essentielles. Et puisque Cloudflare exécute toutes ces fonctions au même endroit, vous bénéficiez des avantages en termes de latence sans devoir faire quoi que ce soit.<br></p>
	<p>Nous étendons également la fonctionnalité Journaux d'entreprise, afin d'assurer la journalisation en temps réel. Si vous choisissez de vous authentifier sur le réseau de Cloudflare, vous pouvez consulter les journaux détaillés de chaque utilisateur ayant accédé à une API. De même, nous suivons la durée de vie de chaque requête au fur et à mesure de sa réception, sa validation, son acheminement et de la réponse donnée à celle-ci. Tout est journalisé.<br></p>
	<p>Enfin, nous développons actuellement Quota Management, une fonctionnalité qui compte les requêtes d'API sur une période plus longue (un mois, par exemple) et vous permet de gérer les seuils pour vos utilisateurs. Nous avons également lancé <a href="https://blog.cloudflare.com/advanced-rate-limiting">Advanced Rate Limiting</a> pour vous aider à gérer les scénarios plus sophistiqués (notamment l'inspection du corps pour GraphQL).</p>
	<p>Conclusion</p>
	<p>Toutes nos fonctionnalités de sécurité (Découverte, Validation des schémas, Protection contre l'utilisation abusive et mTLS) sont disponibles dès maintenant &nbsp;! Nous appelons ces fonctions <a href="https://developers.cloudflare.com/api-shield">API Shield</a>, car elles forment le bouclier qui protège les autres fonctions de la passerelle. Les clients entreprises peuvent dès aujourd'hui demander l'accès à leurs équipes de gestion des comptes.<br></p>
	<p>Plusieurs autres parties de la passerelle pour API sont maintenant disponibles en accès anticipé. Selon Gartner®, « d'ici 2025, moins de 50 % des API pour entreprises seront gérées, car la croissance explosive des API dépasse les capacités des outils de gestion des API. » Notre objectif est de proposer une passerelle abordable, qui permettra de lutter contre cette tendance. Si vous souhaitez tester une fonctionnalité spécifique, informez-en votre équipe de gestion de compte, afin que nous puissions vous intégrer dans les meilleurs délais.</p>
</div>