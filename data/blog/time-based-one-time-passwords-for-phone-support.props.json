{
	"post": {
		"id": "5e98c1c65915ff01ba5d1b36",
		"uuid": "40a099d2-e631-434b-9439-bb80944f1ce6",
		"title": "Time-Based One-Time Passwords for Phone Support",
		"slug": "time-based-one-time-passwords-for-phone-support",
		"html": "<figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2020/04/temporary-password-@2x.png\" class=\"kg-image\" alt loading=\"lazy\"></figure><p>As part of Cloudflare’s support offering, we provide phone support to Enterprise customers who are experiencing critical business issues.</p><p>For account security, specific account settings and sensitive details are not discussed via phone. From today, we are providing Enterprise customers with the ability to configure phone authentication to allow for greater support to be offered over the phone without need to perform validation through support tickets.</p><p>After providing your email address to a Cloudflare Support representative, you can now provide a token generated from the Cloudflare dashboard or via a 2FA app like Google Authenticator. So, a customer is able to prove over the phone that they are who they say they are.</p><h3 id=\"configuring-phone-authentication\">Configuring Phone Authentication</h3><p>If you are an existing Enterprise customer interested in phone support, please contact your Customer Success Manager for eligibility information and set-up. If you are interested in our Enterprise offering, please get in contact via our <a href=\"https://www.cloudflare.com/enterprise/\">Enterprise plan</a> page.</p><p>If you already have phone support eligibility, you can generate single-use tokens from the Cloudflare dashboard or configure an authenticator app to do the same remotely.</p><p>On the support page, you will see a card called “Emergency Phone Support Hotline – Authentication”. From here you can generate a Single-Use Token for authenticating a single call or configure an Authenticator App to generate tokens from a 2FA app.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2020/04/1.png\" class=\"kg-image\" alt loading=\"lazy\"></figure><p>For more detailed instructions, please see the “Emergency Phone” section of the <a href=\"https://support.cloudflare.com/hc/en-us/articles/200172476-Contacting-Cloudflare-Support\">Contacting Cloudflare Support</a> article on the Cloudflare Knowledge Base.</p><h3 id=\"how-it-works\">How it Works</h3><p>A standardised approach for generating TOTPs (Time-Based One-Time Passwords) is described in <a href=\"https://tools.ietf.org/html/rfc6238\">RFC 6238</a> – this is the approach that is often used for setting up Two Factor Authentication on websites.</p><p>When configuring a TOTP authenticator app, you are usually asked to scan a QR code or input a long alphanumeric string. This is a randomly generated secret that is shared between your local authenticator app and the web service where you are configuring TOTP. After TOTP is configured, this is stored between both the web server and your local device.</p><p>TOTP password generation relies on two key inputs; the shared secret and the number of seconds since the Unix epoch (<a href=\"https://en.wikipedia.org/wiki/Unix_time\">Unix time</a>). The timestamp is integer divided by a validity period (often 30 seconds) and this value is put into a cryptographic hash function alongside the secret to generate an output. The hexadecimal output is then truncated to provide the decimal digits which are shown to the user. The <a href=\"https://en.wikipedia.org/wiki/Avalanche_effect\">Avalanche Effect</a> means that whenever the inputs that go into the hash function change slightly (e.g. the timestamp increments), a completely different hash output is generated.</p><p>This approach is fairly widely used and is available in a number of libraries depending on your preferred programming language. However, as our phone validation functionality offers both authenticator app support and generation of a single-use token from the dashboard (where no shared secret exists) - some deviation was required.</p><p>We generate a single use token by creating a hash of an internal user ID combined with a Cloudflare-internal secret, which in turn is used to generate <a href=\"https://tools.ietf.org/html/rfc6238\">RFC 6238</a> compliant time-based one-time passwords. Similarly, this service can generate random passwords for any user without needing to store additional secrets. This is then surfaced to the user every 30 seconds via a JavaScript request without exposing the secret used to generate the token.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2020/04/2.png\" class=\"kg-image\" alt loading=\"lazy\"></figure><p>One question you may be asking yourself after all of this is why don’t we simply use the 2FA mechanism which users use to login for phone validation too? Firstly, we don’t want to accustom users to providing their 2FA tokens to anyone else (they should purely be used for logging in). Secondly, as you may have noticed - we recently began <a href=\"http://blog.cloudflare.com/cloudflare-now-supports-security-keys-with-web-authentication-webauthn/\">supporting WebAuthn</a> keys for logging in, as these are physical tokens used for website authentication they aren’t suited to usage on a mobile device.</p><p>To improve user experience during a phone call, we also validate tokens in the previous time step in the event it has expired by the time the user has read it out (indeed, RFC 6238 provides that “at most one time step is allowed as the network delay”). This means a token can be valid for up to one minute.</p><p>The APIs powering this service are then wrapped with API gateways that offer audit logging both for customer actions and actions completed by staff members. This provides a clear audit trail for customer authentication.</p><h3 id=\"future-work\">Future Work</h3><p>Authentication is a critical component to securing customer support interactions. Authentication tooling must develop alongside support contact channels; from web forms behind logins to using <a href=\"https://support.zendesk.com/hc/en-us/articles/360022185314-Enabling-authenticated-visitors-in-the-Chat-widget\">JWT tokens</a> for validating live chat sessions and now TOTP phone authentication. This is complimented by technical support engineers who will manage risk by routing certain issues into traditional support tickets and being able to refer some cases to named customer success managers for approval.</p><p>We are constantly advancing our support experience; for example, we plan to further improve our Enterprise Phone Support by giving users the ability to request a callback from a support agent within our dashboard. As always, right here on our blog we’ll keep you up-to-date with improvements in our service.</p>",
		"comment_id": "5e98c1c65915ff01ba5d1b36",
		"feature_image": "http://blog.cloudflare.com/content/images/2020/04/temporary-password-@2x-1.png",
		"featured": false,
		"visibility": "public",
		"created_at": "2020-04-16T21:36:22.000+01:00",
		"updated_at": "2020-04-17T13:00:00.000+01:00",
		"published_at": "2020-04-17T13:00:00.000+01:00",
		"custom_excerpt": "Cloudflare Enterprise customers can now authenticate themselves for phone support using TOTP tokens, either by using an authenticator app or generating single-use tokens from the Cloudflare Dashboard.",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "5d1644b141acde0011a94f6e",
				"name": "Junade Ali",
				"slug": "junade-ali",
				"profile_image": "http://blog.cloudflare.com/content/images/2017/03/G1VwuaxB.jpg",
				"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-8.png",
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": "@IcyApril",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/junade-ali/"
			},
			{
				"id": "5e874c95c3ae9c01bc571344",
				"name": "Andronicus Riyono",
				"slug": "andronicus",
				"profile_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2020/04/andronicus-1.jpg",
				"cover_image": null,
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": "@riyono",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/andronicus/"
			}
		],
		"tags": [
			{
				"id": "5d16450341acde0011a95265",
				"name": "Security",
				"slug": "security",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Security.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Security",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Security'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/security/"
			},
			{
				"id": "5d16450341acde0011a95199",
				"name": "Support",
				"slug": "support",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/support/"
			},
			{
				"id": "5d16450341acde0011a9522e",
				"name": "Authentication",
				"slug": "authentication",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/authentication/"
			}
		],
		"primary_author": {
			"id": "5d1644b141acde0011a94f6e",
			"name": "Junade Ali",
			"slug": "junade-ali",
			"profile_image": "http://blog.cloudflare.com/content/images/2017/03/G1VwuaxB.jpg",
			"cover_image": "http://blog.cloudflare.com/content/images/2018/08/general@2x-8.png",
			"bio": null,
			"website": null,
			"location": null,
			"facebook": null,
			"twitter": "@IcyApril",
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/junade-ali/"
		},
		"primary_tag": {
			"id": "5d16450341acde0011a95265",
			"name": "Security",
			"slug": "security",
			"description": null,
			"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Security.png",
			"visibility": "public",
			"meta_title": "Cloudflare Blog: Security",
			"meta_description": "Collection of Cloudflare blog posts tagged 'Security'.",
			"og_image": null,
			"og_title": null,
			"og_description": null,
			"twitter_image": null,
			"twitter_title": null,
			"twitter_description": null,
			"codeinjection_head": null,
			"codeinjection_foot": null,
			"canonical_url": null,
			"accent_color": null,
			"url": "http://blog.cloudflare.com/tag/security/"
		},
		"url": "http://blog.cloudflare.com/time-based-one-time-passwords-for-phone-support/",
		"excerpt": "Cloudflare Enterprise customers can now authenticate themselves for phone support using TOTP tokens, either by using an authenticator app or generating single-use tokens from the Cloudflare Dashboard.",
		"reading_time": 4,
		"access": true,
		"comments": false,
		"og_image": null,
		"og_title": null,
		"og_description": null,
		"twitter_image": null,
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": null,
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	},
	"locale": "en-us"
}