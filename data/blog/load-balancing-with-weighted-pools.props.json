{
	"initialReadingTime": "4",
	"locale": "en-us",
	"localesAvailable": [
		"zh-cn",
		"zh-tw"
	],
	"post": {
		"authors": [
			{
				"name": "Brian Batraski",
				"slug": "brian",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/73UTTrB82BqzOm0zV18vPn/6250ac54d0a3992b0440e064f59ecd30/brian.jpg",
				"location": null,
				"website": null,
				"twitter": null,
				"facebook": null
			},
			{
				"name": "Ben Ritter",
				"slug": "ben-ritter",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/6fRJj6xAtHZ7nKOHyo4FYY/61150ca79ae3c9f4c64f0054d541247c/ben-ritter.jpeg",
				"location": null,
				"website": null,
				"twitter": "@bennetworks",
				"facebook": null
			}
		],
		"excerpt": "Today, we’re excited to announce a frequently requested feature for our Load Balancer – Weighted Pools",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/1Pw1Rhpjs31SoNDAe7PKKR/460f21bc44a4b0f4fb5d179a7d431a17/load-balancing-with-weighted-pools.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7EvHaiULKKXcU67DpkY3eZ/9ae1636544b5f14cb5dfbdb6d9095136/image1-1.png\" alt=\"Load Balancing with Weighted Pools\" class=\"kg-image\" width=\"1801\" height=\"1014\" loading=\"lazy\"/>\n            \n            </figure><p>Anyone can take advantage of Cloudflare’s far-reaching network to protect and accelerate their online presence. Our vast <a href=\"https://www.cloudflare.com/network/\">number of data centers</a>, and their proximity to Internet users around the world, enables us to secure and accelerate our customers’ Internet applications, APIs and websites. Even a simple service with a <a href=\"https://www.cloudflare.com/learning/cdn/glossary/origin-server/\">single origin server</a> can leverage the massive scale of the Cloudflare network in 270+ cities. Using the Cloudflare cache, you can support more requests and users without purchasing new servers.</p><p>Whether it is to guarantee high availability through redundancy, or to support more dynamic content, an increasing number of services require multiple origin servers. The Cloudflare Load Balancer keeps our customer’s services highly available and makes it simple to spread out requests across multiple origin servers. Today, we’re excited to announce a frequently requested feature for our Load Balancer – Weighted Pools!</p><h2>What’s a Weighted Pool?</h2><p>Before we can answer that, let’s take a quick look at how our load balancer works and define a few terms:</p><p><b>Origin Servers</b> - Servers which sit behind Cloudflare and are often located in a customer-owned datacenter or at a public cloud provider.</p><p><b>Origin Pool</b> - A logical collection of origin servers. Most pools are named to represent data centers, or cloud providers like “us-east,” “las-vegas-bldg1,” or “phoenix-bldg2”. It is recommended to use pools to represent a collection of servers in the same physical location.</p><p><b>Traffic Steering Policy</b> - A policy specifies how a load balancer should steer requests across origin pools. Depending on the steering policy, requests may be sent to the nearest pool as defined by latitude and longitude, the origin pool with the lowest latency, or based upon the location of the Cloudflare data center.</p><p><b>Pool Weight</b> - A numerical value to describe what percentage of requests should be sent to a pool, relative to other pools.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6rTxNJcZUpuAep6AGouFyW/a34b7d09040c193d78796ab6e5bb2aa2/image6.png\" alt=\"Diagram showing a request arriving at Cloudflare and two load balancer origin pools with equal weights\" class=\"kg-image\" width=\"1386\" height=\"837\" loading=\"lazy\"/>\n            \n            </figure><p>When a request from a visitor arrives at the Cloudflare network for a hostname with a load balancer attached to it, the load balancer must decide where the request should be forwarded. Customers can configure this behavior with traffic steering policies.</p><p>The Cloudflare Load Balancer already supports <a href=\"https://developers.cloudflare.com/load-balancing/understand-basics/traffic-steering/steering-policies/\">Standard Steering, Geo Steering, Dynamic Steering, and Proximity Steering</a>. Each of these respective traffic steering policies control how requests are distributed across origin pools. Weighted Pools are an extension of our standard, random steering policy which allows the specification of what relative percentage of requests should be sent to each respective pool.</p><p>In the example above, our load balancer has two origin pools, “las-vegas-bldg1” (which is a customer operated data center), and “us-east-cloud” (which is a public cloud provider with multiple virtual servers). Each pool has a weight of 0.5, so 50% of requests should be sent to each respective pool.</p><h2>Why would someone assign weights to origin pools?</h2><p>Before we built this, Weighted Pools was a frequently requested feature from our customers. Part of the reason we’re so excited about this feature is that it can be used to solve many types of problems.</p><h3>Unequally Sized Origin Pools</h3><p>In the example below, the amount of dynamic and uncacheable traffic has significantly increased due to a large sales promotion. Administrators notice that the load on their Las Vegas data center is too high, so they elect to dynamically increase the number of origins within their public cloud provider. Our two pools, “las-vegas-bldg1” and “us-east-cloud” are no longer equally sized. Our pool representing the public cloud provider is now much larger, so administrators change the pool weights so that the cloud pool receives 0.8 (80%) of the traffic, relative to the 0.2 (20%) of the traffic which the Las Vegas pool receives. The administrators were able to use pool weights to very quickly fine-tune the distribution of requests across unequally sized pools.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/5V6rFceRK8So5AK0S7FzV9/aea396b6ea171ddca51e39b6777a6c33/image3.png\" alt=\"Diagram showing a request arriving at Cloudflare, and two load balancer origin pools. One pool is larger and has a weight of 80 percent.\" class=\"kg-image\" width=\"1501\" height=\"848\" loading=\"lazy\"/>\n            \n            </figure><h3>Data center kill switch</h3><p>In addition to balancing out unequal sized pools, Weighted Pools may also be used to completely take a data center (an origin pool) out of rotation by setting the pool’s weight to 0. This feature can be particularly useful if a data center needs to be quickly eliminated during troubleshooting or a proactive maintenance where power may be unavailable. Even if a pool is disabled with a weight of 0, Cloudflare will still monitor the pool for health so that the administrators can assess when it is safe to return traffic.</p><h3>Network A/B testing</h3><p>One final use case we’re excited about is the ability to use weights to attract a very small amount of requests to pool. Did the team just stand up a brand-new data center, or perhaps upgrade all the servers to a new software version? Using weighted pools, the administrators can use a load balancer to effectively A/B test their network. Only send 0.05 (5%) of requests to a new pool to verify the origins are functioning properly before gradually increasing the load.</p><h2>How do I get started?</h2><p>When setting up a load balancer, you need to configure one or more origin pools, and then place origins into your respective pools. Once you have more than one pool, the relative weights of the respective pools will be used to distribute requests.</p><p>To set up a weighted pool using the Dashboard, create a load balancer in the <b>Traffic &gt; Load Balancing</b> area.</p><p>Once you have set up the load balancer, you’re navigated to the <b>Origin Pools</b> setup page. Under the Traffic Steering Policy, select <b>Random</b>, and then assign relative weights to every pool.</p><p>If your weights do not add up to 1.00 (100%), that’s fine! We will do the math behind the scenes to ensure how much traffic the pool should receive relative to other pools.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/1tgWXK6Slx7C3KZdZd5SrO/6b420ff63cac046ed5a6e9d12a40466e/image4.png\" alt=\"\" class=\"kg-image\" width=\"1562\" height=\"967\" loading=\"lazy\"/>\n            \n            </figure>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/7MoDiAL340j2GfFJ3KihWr/557c987cc64bbc2d5272eab0502434df/image2.png\" alt=\"\" class=\"kg-image\" width=\"1562\" height=\"1083\" loading=\"lazy\"/>\n            \n            </figure>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4FjRnImOHxs5NHVZqRVG7w/6f028362f29261e6610a9dbc87860ac6/image5-1.png\" alt=\"\" class=\"kg-image\" width=\"1118\" height=\"771\" loading=\"lazy\"/>\n            \n            </figure><p>Weighted Pools may also be configured via the API. We’ve edited an example illustrating the relevant parts of the REST API.</p><ul><li><p>The load balancer should employ a “steering_policy” of random.</p></li><li><p>Each pool has a UUID, which can then be assigned a “pool_weight.”</p></li></ul>\n            <pre class=\"language-bash\"><code class=\"language-bash\"> {\n    &quot;description&quot;: &quot;Load Balancer for www.example.com&quot;,\n    &quot;name&quot;: &quot;www.example.com&quot;,\n    &quot;enabled&quot;: true,\n    &quot;proxied&quot;: true,\n    &quot;fallback_pool&quot;: &quot;9290f38c5d07c2e2f4df57b1f61d4196&quot;,\n    &quot;default_pools&quot;: [\n        &quot;9290f38c5d07c2e2f4df57b1f61d4196&quot;,\n        &quot;17b5962d775c646f3f9725cbc7a53df4&quot;\n    ],\n    &quot;steering_policy&quot;: &quot;random&quot;,\n    &quot;random_steering&quot;: {\n        &quot;pool_weights&quot;: {\n            &quot;9290f38c5d07c2e2f4df57b1f61d4196&quot;: 0.8\n        },\n        &quot;default_weight&quot;: 0.2\n    }\n}</pre></code>\n            <p>We’re excited to launch this simple, yet powerful and capable feature. Weighted pools may be utilized in tons of creative new ways to solve load balancing challenges. It’s available for all customers with load balancers today!</p><p>Developer Docs:<a href=\"https://developers.cloudflare.com/load-balancing/how-to/create-load-balancer/#create-a-load-balancer\">https://developers.cloudflare.com/load-balancing/how-to/create-load-balancer/#create-a-load-balancer</a></p><p>API Docs:<a href=\"https://api.cloudflare.com/#load-balancers-create-load-balancer\">https://api.cloudflare.com/#load-balancers-create-load-balancer</a></p>",
		"id": "12ylWmYVhyw4uFIG3NBqN2",
		"localeList": {
			"name": "Load Balancing with Weighted Pools Config",
			"enUS": "English for Locale",
			"zhCN": "Translated for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "Translated for Locale",
			"frFR": "No Page for Locale",
			"deDE": "No Page for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": "Today, we’re excited to announce a frequently requested feature for our Load Balancer – Weighted Pools!",
		"metadata": {
			"title": "Load Balancing with Weighted Pools",
			"description": "Today, we’re excited to announce a frequently requested feature for our Load Balancer – Weighted Pools!",
			"imgPreview": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4kEvy8a50GQrZBBqmAuA80/7a94d20b0a5eb5bda0b97785739d1dc0/load-balancing-with-weighted-pools-qOTTR1.png"
		},
		"primary_author": {},
		"published_at": "2022-08-02T14:00:00.000+01:00",
		"slug": "load-balancing-with-weighted-pools",
		"tags": [
			{
				"id": "z8ZZrDbXCT44IU6BaHLWl",
				"name": "Load Balancing",
				"slug": "loadbalancing"
			},
			{
				"id": "6QktrXeEFcl4e2dZUTZVGl",
				"name": "Product News",
				"slug": "product-news"
			},
			{
				"id": "48r7QV00gLMWOIcM1CSDRy",
				"name": "Speed & Reliability",
				"slug": "speed-and-reliability"
			},
			{
				"id": "2s3r2BdfPas9oiGbGRXdmQ",
				"name": "Network Services",
				"slug": "network-services"
			},
			{
				"id": "4gN0ARax0fHxjtZL07THOe",
				"name": "Performance",
				"slug": "performance"
			}
		],
		"title": "Load Balancing with Weighted Pools",
		"updated_at": "2024-08-27T01:55:41.480Z",
		"url": "https://blog.cloudflare.com/load-balancing-with-weighted-pools"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"search.clear": "Clear",
		"search.filter": "Filter",
		"search.source": "Source",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"search.filters": "Filters",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"search.language": "Language",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"search.result_stat": "Results <strong>{search_range}</strong> of <strong>{search_total}</strong> for <strong>{search_keyword}</strong>",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"search.source_location": "Source/Location",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}