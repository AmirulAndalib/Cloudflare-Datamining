{
	"locale": "en-us",
	"localesAvailable": [
		"fr-fr",
		"de-de"
	],
	"post": {
		"authors": [
			{
				"name": "Jon Levine",
				"slug": "jpl",
				"bio": null,
				"profile_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/2xdSqLo0jn89CExvkA5vvj/03599c6af64ea17f04105c94f6ecd37f/jpl.jpg",
				"location": "San Francisco, CA",
				"website": null,
				"twitter": "@jplevine",
				"facebook": null
			}
		],
		"excerpt": "At Cloudflare, we aim to make the Internet faster and safer for everyone. One way we do this is through caching: we keep a copy of our customer content in our 165 data centers around the world. This brings content  closer to users and reduces traffic back to origin servers.",
		"feature_image": "https://cf-assets.www.cloudflare.com/slt3lc6tev37/4t2M15nxNsDRDzoqDPRiJx/f73ce9d88b2e618e880781bd32484ce5/introducing-the-workers-cache-api-giving-you-control-over-how-your-content-is-cached.png",
		"featured": false,
		"html": "\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/6W1dWzwo1vg5QBBJ4zqr8s/85bfa6f09f0e7a0d577cfb910b083078/caching_3x-1.png\" alt=\"\" class=\"kg-image\" width=\"3449\" height=\"1562\" loading=\"lazy\"/>\n            \n            </figure><p>At Cloudflare, we aim to make the Internet faster and safer for everyone. One way we do this is through <i>caching:</i> we keep a copy of our customer content in our 165 data centers around the world. This brings content  closer to users and reduces traffic back to <a href=\"https://www.cloudflare.com/learning/cdn/glossary/origin-server/\">origin servers</a>.</p><p>Today, we’re excited to announce a huge change in our how cache works. <a href=\"https://www.cloudflare.com/products/cloudflare-workers/\">Cloudflare Workers</a> now integrates the <a href=\"https://developers.cloudflare.com/workers/reference/cache-api/\">Cache API</a>, giving you programmatic control over our caches around the world.</p><h3>Why the Cache API?</h3><p>Figuring out what to cache and how can get complicated. Consider an e-commerce site with a shopping cart, a Content Management System (CMS) with many templates and hundreds of articles, or a GraphQL API. Each contains a mix of elements that are dynamic for some users, but might stay unchanged for the vast majority of requests.</p><p>Over the last 8 years, we’ve added more features to give our customers flexibility and control over what goes in the cache. However, we’ve learned that we need to offer more than just adding settings in our dashboard. Our customers have told us clearly that they want to be able to express their ideas in <i>code</i>, to build things we could never have imagined.</p><h3>How the Cache API works</h3><p>Fetching content is one of the most common Worker tasks. <code>fetch()</code> has always leveraged powerful Cloudflare features like Argo and Load Balancing. It also runs through our cache: we check for content locally before connecting to the Internet. Without the Cache API, content requested with <code>fetch()</code> goes in the cache as-is.</p>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/4wLp8iD92YUPS5gbyUeCLo/01dbdb643e5fa98bbb673ff42ea6dbae/workers-cache-api-1_2x.png\" alt=\"\" class=\"kg-image\" width=\"1582\" height=\"392\" loading=\"lazy\"/>\n            \n            </figure><p>fetch() will always write back to cache after a miss.</p><p>The Cache API changes all of that. It’s based on the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Cache\">Service Workers Cache API</a>, and at its core <a href=\"https://developers.cloudflare.com/workers/reference/cache-api/\">it offers three methods</a>:</p><ul><li><p><b><b>put(</b></b><i>request, response</i><b><b>)</b></b> places a Response in the cache, keyed by a Request</p></li><li><p><b>match(</b><i>request</i><b>)</b> returns a given Response that was previously put()</p></li><li><p><b>delete(</b><i>request</i><b>)</b> deletes a Response that was previously put()</p></li></ul>\n            <figure class=\"kg-card kg-image-card \">\n            \n            <Image src=\"https://cf-assets.www.cloudflare.com/slt3lc6tev37/3rrey6Gut4tb3xJKiVfNfg/8121eb893f0ae9e61ece92f7dd7c7a79/workers-cache-api-2_2x.png\" alt=\"\" class=\"kg-image\" width=\"1294\" height=\"526\" loading=\"lazy\"/>\n            \n            </figure><p>The Cache API enables you to modify content before writing it to cache.</p><p>This API unleashes a huge amount of power. Because Workers give you the ability to <i>modify</i> Request and Response objects, you can control any caching behavior like TTL or cache tags. You can implement customer Vary logic or cache normally-uncacheable objects like POST requests.</p><p>The Cache API expects requests and responses, but they don&#39;t have to come from external servers. Your worker can generate arbitrary data that’s stored in our cache. That means you can use the Cache API as a general-purpose, ephemeral key-value store!</p><h3>Case study: Using the Cache API to cache POST requests</h3><p>Since we <a href=\"/cache-api-for-cloudflare-workers-is-now-in-beta/\">announced the beta</a> in September, usage of the Cache API has grown to serve thousands of requests per second. One common use-case is to cache <a href=\"https://en.wikipedia.org/wiki/POST_(HTTP)\">POST requests</a>.</p><p>Normally, Cloudflare does not consider POST requests to be cacheable because they are designed to be non-idempotent: that is, they change state on the server when a request is made. However, applications can also use POST requests to send large amounts of data to the server, or as a common HTTP method for API calls.</p><p>Here’s what one developer had to say about using the Cache API:</p><blockquote><p>We needed to migrate some complex server side code to the edge. We have an API endpoint that accepts POST requests with large bodies, but mostly returns the same data without changing anything on our origin server. With Workers and the Cache API, we were able to cache responses to POST requests that we knew were safe, and reduce significant load on our origin.</p></blockquote><p>— Aaron Dearinger, Edge Architect, Garmin International</p><p>Caching POST requests with the Cache API is simple. Here’s some example code from our <a href=\"https://developers.cloudflare.com/workers/reference/cache-api/\">documentation</a>:</p>\n            <pre class=\"language-javascript\"><code class=\"language-javascript\">async function handleRequest(event) {\n  let request = event.request\n  let response\n\n  if (request.method == 'POST') {\n    let body = await request.clone().text()\n    let hash = await sha256(body)\n\n    let url = new URL(request.url)\n    url.pathname = \"/posts\" + url.pathname + hash\n\n    // Convert to a GET to be able to cache\n    let cacheKey = new Request(url, {\n      headers: request.headers,\n      method: 'GET'\n    })\n\n    let cache = caches.default\n    // try to find the cache key in the cache\n    response = await cache.match(cacheKey)\n\n    // otherwise, fetch from origin\n    if (!response) {\n      // makes POST to the origin\n      response = await fetch(request.url, newRequest)\n      event.waitUntil(cache.put(cacheKey, response.clone()))\n    }\n  } else {\n    response = await fetch(request) \n  }\n  return response\n}\n\nasync function sha256(message) {\n  // encode as UTF-8\n  const msgBuffer = new TextEncoder().encode(message)\n\n  // hash the message\n  const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer)\n\n  // convert ArrayBuffer to Array\n  const hashArray = Array.from(new Uint8Array(hashBuffer))\n\n  // convert bytes to hex string\n  const hashHex =\n    hashArray.map(b => ('00' + b.toString(16)).slice(-2)).join('')\n  return hashHex\n}</pre></code>\n            <h3>Try it yourself</h3><p>Already in our beta, we’ve seen customers use the Cache API to dynamically cache parts of GraphQL queries and store customer data to improve performance. We’re excited to see what you build! Check out the <a href=\"https://developers.cloudflare.com/workers/\">Cloudflare Workers getting started guide</a> and the <a href=\"https://developers.cloudflare.com/workers/reference/cache-api/\">Cache API docs</a>, and let us know what you’ve built in the <a href=\"https://community.cloudflare.com/c/developers/workers\">Workers Community forum</a>.</p>",
		"id": "3Ix57SkWb8assTugAOjGzL",
		"localeList": {
			"name": "Introducing the Workers Cache API: Giving you control over how your content is cached Config",
			"enUS": "English for Locale",
			"zhCN": "No Page for Locale",
			"zhHansCN": "No Page for Locale",
			"zhTW": "No Page for Locale",
			"frFR": "Translated for Locale",
			"deDE": "Translated for Locale",
			"itIT": "No Page for Locale",
			"jaJP": "No Page for Locale",
			"koKR": "No Page for Locale",
			"ptBR": "No Page for Locale",
			"esLA": "No Page for Locale",
			"esES": "No Page for Locale",
			"enAU": "No Page for Locale",
			"enCA": "No Page for Locale",
			"enIN": "No Page for Locale",
			"enGB": "No Page for Locale",
			"idID": "No Page for Locale",
			"ruRU": "No Page for Locale",
			"svSE": "No Page for Locale",
			"viVN": "No Page for Locale",
			"plPL": "No Page for Locale",
			"arAR": "No Page for Locale",
			"nlNL": "No Page for Locale",
			"thTH": "No Page for Locale",
			"trTR": "No Page for Locale",
			"heIL": "No Page for Locale",
			"lvLV": "No Page for Locale",
			"etEE": "No Page for Locale",
			"ltLT": "No Page for Locale"
		},
		"meta_description": null,
		"metadata": {
			"imgPreview": ""
		},
		"primary_author": {},
		"published_at": "2019-01-25T15:33:41.000+00:00",
		"reading_time": 3,
		"slug": "introducing-the-workers-cache-api-giving-you-control-over-how-your-content-is-cached",
		"tags": [
			{
				"id": "6hbkItfupogJP3aRDAq6v8",
				"name": "Cloudflare Workers",
				"slug": "workers"
			},
			{
				"id": "5cye1Bh5KxFh3pKSnX8Dsy",
				"name": "Serverless",
				"slug": "serverless"
			},
			{
				"id": "5RrjSR5vIOJAfRdT8966hf",
				"name": "Cache",
				"slug": "cache"
			},
			{
				"id": "48r7QV00gLMWOIcM1CSDRy",
				"name": "Speed & Reliability",
				"slug": "speed-and-reliability"
			},
			{
				"id": "78aSAeMjGNmCuetQ7B4OgU",
				"name": "JavaScript",
				"slug": "javascript"
			},
			{
				"id": "4HIPcb68qM0e26fIxyfzwQ",
				"name": "Developers",
				"slug": "developers"
			},
			{
				"id": "3JAY3z7p7An94s6ScuSQPf",
				"name": "Developer Platform",
				"slug": "developer-platform"
			}
		],
		"title": "Introducing the Workers Cache API: Giving you control over how your content is cached",
		"updated_at": "2024-08-27T02:15:19.397Z",
		"url": "https://blog.cloudflare.com/introducing-the-workers-cache-api-giving-you-control-over-how-your-content-is-cached"
	},
	"translations": {
		"posts.by": "By",
		"footer.gdpr": "GDPR",
		"lang_blurb1": "This post is also available in {lang1}.",
		"lang_blurb2": "This post is also available in {lang1} and {lang2}.",
		"lang_blurb3": "This post is also available in {lang1}, {lang2} and {lang3}.",
		"footer.blurb": "Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href='http://www.cloudflare.com/careers' rel='noreferrer'>our open positions</a>.",
		"footer.press": "Press",
		"header.title": "The Cloudflare Blog",
		"footer.careers": "Careers",
		"footer.company": "Company",
		"footer.support": "Support",
		"footer.the_net": "theNet",
		"footer.our_team": "Our team",
		"footer.webinars": "Webinars",
		"page.more_posts": "More posts",
		"posts.time_read": "{time} min read",
		"footer.community": "Community",
		"footer.resources": "Resources",
		"footer.solutions": "Solutions",
		"footer.trademark": "Trademark",
		"header.subscribe": "Subscribe",
		"footer.compliance": "Compliance",
		"footer.free_plans": "Free plans",
		"footer.impact_ESG": "Impact/ESG",
		"posts.follow_on_X": "Follow on X",
		"footer.help_center": "Help center",
		"footer.network_map": "Network Map",
		"header.please_wait": "Please Wait",
		"page.related_posts": "Related posts",
		"footer.case_studies": "Case Studies",
		"footer.connect_2024": "Connect 2024",
		"footer.terms_of_use": "Terms of Use",
		"footer.white_papers": "White Papers",
		"footer.cloudflare_tv": "Cloudflare TV",
		"footer.community_hub": "Community Hub",
		"footer.compare_plans": "Compare plans",
		"footer.contact_sales": "Contact Sales",
		"header.contact_sales": "Contact Sales",
		"header.email_address": "Email Address",
		"page.error.not_found": "Page not found",
		"footer.developer_docs": "Developer docs",
		"footer.privacy_policy": "Privacy Policy",
		"footer.request_a_demo": "Request a demo",
		"page.continue_reading": "Continue reading",
		"footer.analysts_report": "Analyst reports",
		"footer.for_enterprises": "For enterprises",
		"footer.getting_started": "Getting Started",
		"footer.learning_center": "Learning Center",
		"footer.project_galileo": "Project Galileo",
		"pagination.newer_posts": "Newer Posts",
		"pagination.older_posts": "Older Posts",
		"posts.social_buttons.x": "Discuss on X",
		"footer.about_cloudflare": "About Cloudflare",
		"footer.athenian_project": "Athenian Project",
		"footer.become_a_partner": "Become a partner",
		"footer.cloudflare_radar": "Cloudflare Radar",
		"footer.network_services": "Network services",
		"footer.trust_and_safety": "Trust & Safety",
		"header.get_started_free": "Get Started Free",
		"page.search.placeholder": "Search Cloudflare",
		"footer.cloudflare_status": "Cloudflare Status",
		"footer.cookie_preference": "Cookie Preferences",
		"header.valid_email_error": "Must be valid email.",
		"footer.connectivity_cloud": "Connectivity cloud",
		"footer.developer_services": "Developer services",
		"footer.investor_relations": "Investor relations",
		"page.not_found.error_code": "Error Code: 404",
		"footer.logos_and_press_kit": "Logos & press kit",
		"footer.application_services": "Application services",
		"footer.get_a_recommendation": "Get a recommendation",
		"posts.social_buttons.reddit": "Discuss on Reddit",
		"footer.sse_and_sase_services": "SSE and SASE services",
		"page.not_found.outdated_link": "You may have used an outdated link, or you may have typed the address incorrectly.",
		"footer.report_security_issues": "Report Security Issues",
		"page.error.error_message_page": "Sorry, we can't find the page you are looking for.",
		"header.subscribe_notifications": "Subscribe to receive notifications of new posts:",
		"footer.cloudflare_for_campaigns": "Cloudflare for Campaigns",
		"header.subscription_confimation": "Subscription confirmed. Thank you for subscribing!",
		"posts.social_buttons.hackernews": "Discuss on Hacker News",
		"footer.diversity_equity_inclusion": "Diversity, equity & inclusion",
		"footer.critical_infrastructure_defense_project": "Critical Infrastructure Defense Project"
	}
}