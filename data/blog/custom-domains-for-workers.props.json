{
	"post": {
		"id": "627c1c0b5b2938000ab48d95",
		"uuid": "f67dd25d-aadf-442b-8476-b5c582c10ae4",
		"title": "Introducing Custom Domains for Workers",
		"slug": "custom-domains-for-workers",
		"html": "<figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2022/05/image2-24.png\" class=\"kg-image\" alt=\"Introducing Custom Domains for Workers\" loading=\"lazy\"></figure><p>Today, we’re happy to announce Custom Domains for Workers. Custom Domains allow you to hook up a domain to your Worker, without having to fuss about certificates, origin servers or <a href=\"https://www.cloudflare.com/learning/dns/what-is-dns/\">DNS</a> – it just works. Let’s take a look at how we built Custom Domains and how you can use them.</p><h3 id=\"the-magic-of-cloudflare-dns\">The magic of Cloudflare DNS</h3><p>Under the hood, we’re leveraging Cloudflare DNS to register your Worker as the origin for your domain. All you need to do is head to your Worker, go to the Triggers tab, and click Add Custom Domain. Cloudflare will handle creating the DNS record and issuing a certificate on your behalf. In seconds, your domain will point to your Worker, and all you need to worry about is writing your code. We’ll also help guide you through the process of creating these new records and replace any existing ones. We built this with a straightforward ethos in mind: we should be clear and transparent about actions we’re taking, and make it easy to understand.</p><p>We’ve made a few welcome changes when you’re using a Custom Domain on your Worker. First off, when you send a request to <em>any</em> path on that Custom Domain, your Worker will be triggered. No need to create a route with <code>/*</code> at the end.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2022/05/image3-19.png\" class=\"kg-image\" alt=\"Custom Domains use Cloudflare DNS under the hood, so any paths on that domain will invoke your Worker\" loading=\"lazy\"></figure><p>Second, your Custom Domain Worker is considered the ‘origin server’. That means, no need to `fetch(event.request)` once you’re in that Worker; instead, talk to any internal or external services you need to by creating request objects in your code, or talk to other Workers services using any of our available bindings. We’ve increased the limit of external requests you can make, when using our Unbound usage model, to 1,000. You can talk to any services you’d like to – things like payment, communication, analytics, or tracking services come to mind, not to mention your databases. If that’s not enough for your use case, feel free to reach out via Discord or support, and we’ll happily chat.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2022/05/image1-31.png\" class=\"kg-image\" alt=\"Custom Domains register your Worker as the origin server\" loading=\"lazy\"></figure><p>Finally, what if you need to talk to your Worker from another one? Since these Workers act as an origin server, you can just send a normal request to the associated endpoint, and we’ll invoke that Worker – even if it’s on the same Cloudflare zone.</p><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2022/05/image4-14.png\" class=\"kg-image\" alt=\"Workers with Custom Domains can talk to each other\" loading=\"lazy\"></figure><h3 id=\"let-s-build-an-example-application\">Let’s build an example application</h3><p>We’ll start by writing our application. I have an example that I’ve called <code>api-gateway</code> below. It checks the incoming request path, and delegates work to downstream Workers using <a href=\"http://blog.cloudflare.com/service-bindings-ga\">Service Bindings</a>. For any privileged endpoints, it performs an authorization check before executing that code:</p><!--kg-card-begin: markdown--><pre><code class=\"language-js\">export default {\n async fetch(request, environment) {\n   const url = new URL(request.url);\n   switch (url.pathname) {\n     case '/login':\n       return await environment.login.fetch(request);\n\n     case '/logout':\n       return await environment.logout.fetch(request);\n\n     case '/admin': {\n       // Check that the &quot;Authorization&quot; header is sent when authenticated.\n       const authCheck = await environment.auth.fetch(request.clone());\n       if (authCheck.status != 200) { return authCheck }\n       // If the auth check passes, send the request to the /admin endpoint\n       return await environment.admin.fetch(request);\n     }\n\n     case '/robots.txt':\n       return new Response(null, { status: 204 });\n   }\n   return new Response('Not Found.', { status: 404 });\n }\n}```</code></pre>\n<!--kg-card-end: markdown--><p>Now that I have a working application, I want to serve it on my Custom Domain. To hook this up, head over to <em><strong>Workers</strong></em>, <em><strong>Triggers</strong></em>, click ‘<em><strong>Add Custom Domain</strong></em>’, and type in your desired hostname. You’ll be guided through a simple workflow to generate your new Worker record, and your Worker will be the target.</p><!--kg-card-begin: html--><div style=\"position: relative; padding-top: 57.24137931034483%;\"><iframe src=\"https://iframe.videodelivery.net/6497e543b75364f667bf893935b82525?preload=true&poster=https%3A%2F%2Fvideodelivery.net%2F6497e543b75364f667bf893935b82525%2Fthumbnails%2Fthumbnail.jpg%3Ftime%3D14s%26height%3D600\" style=\"border: none; position: absolute; top: 0; left: 0; height: 100%; width: 100%;\" allow=\"accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;\" allowfullscreen=\"true\"></iframe></div>\n<p></p><!--kg-card-end: html--><p>Best of all, with Custom Domains you can reap the performance benefits of DNS-routable Workers; Cloudflare never has to look through a routing table to invoke your Worker. And, by leveraging Service Bindings, you can customize your routing to your heart’s content – using URL parameters, headers, request content, or query strings to appropriately invoke the right Worker at the right time.</p><p>We’re excited to see what you build with Custom Domains. Custom Domains are available in an Open Beta starting today. Support is built right into the Cloudflare Dashboard and API’s, and CLI support via Wrangler is coming soon.</p>",
		"comment_id": "627c1c0b5b2938000ab48d95",
		"feature_image": "http://blog.cloudflare.com/content/images/2022/05/image2-17.png",
		"featured": false,
		"visibility": "public",
		"created_at": "2022-05-11T21:26:51.000+01:00",
		"updated_at": "2024-02-15T22:57:58.000+00:00",
		"published_at": "2022-05-12T13:58:52.000+01:00",
		"custom_excerpt": "Custom Domains are now available for your Workers. Hook up a Worker to any domain you own, and Cloudflare will handle making DNS records and issuing certificates on your behalf",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "5eb1e71aad4c4401bca11c40",
				"name": "Kabir Sikand",
				"slug": "kabir",
				"profile_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2020/05/0.jpeg",
				"cover_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2020/05/general@2x-1.png",
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": "@kabirsikand",
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/kabir/"
			}
		],
		"tags": [
			{
				"id": "627c1c2c5b2938000ab48d99",
				"name": "#BLOG-1072",
				"slug": "hash-blog-1072",
				"description": null,
				"feature_image": null,
				"visibility": "internal",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/404/"
			},
			{
				"id": "6276b1455b2938000ab48480",
				"name": "Platform Week",
				"slug": "platform-week",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/platform-week/"
			},
			{
				"id": "5d16450341acde0011a95253",
				"name": "Cloudflare Workers",
				"slug": "workers",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/workers/"
			},
			{
				"id": "5d16450341acde0011a95204",
				"name": "Developers",
				"slug": "developers",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Developers-1.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Developers",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Developers'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/developers/"
			},
			{
				"id": "64a3e2b834124c000b00b717",
				"name": "Developer Platform",
				"slug": "developer-platform",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/developer-platform/"
			}
		],
		"primary_author": {
			"id": "5eb1e71aad4c4401bca11c40",
			"name": "Kabir Sikand",
			"slug": "kabir",
			"profile_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2020/05/0.jpeg",
			"cover_image": "https://blog-cloudflare-com-assets.storage.googleapis.com/2020/05/general@2x-1.png",
			"bio": null,
			"website": null,
			"location": null,
			"facebook": null,
			"twitter": "@kabirsikand",
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/kabir/"
		},
		"primary_tag": null,
		"url": "http://blog.cloudflare.com/custom-domains-for-workers/",
		"excerpt": "Custom Domains are now available for your Workers. Hook up a Worker to any domain you own, and Cloudflare will handle making DNS records and issuing certificates on your behalf",
		"reading_time": 3,
		"access": true,
		"comments": false,
		"og_image": "http://blog.cloudflare.com/content/images/2022/05/Introducing-Custom-Domains-for-Workers-OG-1.png",
		"og_title": null,
		"og_description": null,
		"twitter_image": "http://blog.cloudflare.com/content/images/2022/05/Introducing-Custom-Domains-for-Workers-OG.png",
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": "Custom Domains are now available for your Workers. Hook up a Worker to any domain you own, and Cloudflare will handle making DNS records and issuing certificates on your behalf.",
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	},
	"locale": "en-us"
}