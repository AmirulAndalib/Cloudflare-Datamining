<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/02/image6-5.png" class="kg-image" alt="Blogpost around what is a post-quantum signature scheme." loading="lazy"></figure>
	<p>To provide authentication is no more than to assert, to provide proof of, an identity. We can claim who we claim to be but if there is no proof of it (recognition of our face, voice or mannerisms) there is no assurance of that. In fact, we can claim to be someone we are not. We can even claim we are someone that does not exist, as clever Odysseus did once.</p>
	<p>The story goes that there was a man named <a href="https://en.wikipedia.org/wiki/Odysseus?ref=blog.cloudflare.com" target="_blank">Odysseus</a> who angered the gods and was punished with perpetual wandering. He traveled and traveled the seas meeting people and suffering calamities. On one of his trips, he came across the <a href="https://en.wikipedia.org/wiki/Polyphemus?ref=blog.cloudflare.com" target="_blank">Cyclops Polyphemus</a> who, in short, wanted to eat him. Clever Odysseus got away (as he usually did) by wounding the cyclops’ eye. As he was wounded, he asked for Odysseus name to which the latter replied:</p>
	<blockquote>“Cyclops, you asked for my glorious name, and I will tell it; but do give the stranger's gift, just as you promised. <em>Nobody </em>I am called. <em>Nobody </em>they called me: by mother, father, and by all my comrades” </blockquote>
	<p><em>(As seen in <a href="https://www.perseus.tufts.edu/hopper/text?doc=Perseus%3Atext%3A1999.01.0135%3Abook%3D9%3Acard%3D360&amp;ref=blog.cloudflare.com" target="_blank">The Odyssey, book 9</a>. Translation by the authors of the blogpost).</em></p>
	<p>The cyclops believed that was Odysseus' name (<a href="https://en.wikipedia.org/wiki/Outis?ref=blog.cloudflare.com" target="_blank">Nobody</a>) and proceeded to tell everyone, which resulted in no one believing him. “How can nobody have wounded you?” they questioned the cyclops. It was a trick, a play of words by Odysseus. Because to give an identity, to tell the world who you are (or who you are pretending to be) is easy. To provide proof of it is very difficult. The cyclops could have asked Odysseus to prove who he was, and the story would have been different. And Odysseus wouldn’t have left the cyclops laughing.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/02/image1-17.png" class="kg-image" alt="Odysseus and the cyclops." loading="lazy"></figure>
	<p>In the digital world, proving your identity is more complex. In face-to-face conversations, we can often attest to the identity of someone by knowing and verifying their face, their voice, or by someone else introducing them to us. From computer to computer, the scenario is a little different. But there are ways. When a user connects to their banking provider on the Internet, they need assurance not only that the information they send is secured; but that they are also sending it to their bank, and not a malicious website masquerading as their provider. The Transport Layer Security (TLS) protocol provides this through digitally signed statements of identity (certificates). Digital signature schemes also play a central role in DNSSEC as well, an extension to the <a href="https://en.wikipedia.org/wiki/Domain_Name_System?ref=blog.cloudflare.com" target="_blank">Domain Name System</a> (DNS) that protects applications from accepting forged or manipulated DNS data, which is what happens during <a href="https://en.wikipedia.org/wiki/DNS_spoofing?ref=blog.cloudflare.com" target="_blank">DNS cache poisoning</a>, for example.</p>
	<p>A digital signature is a demonstration of authorship of a document, conversation, or message sent using digital means. As with “regular” signatures, they can be publicly verified by anyone that knows that it is a signature made by someone.</p>
	<p>A digital signature scheme is a collection of three algorithms:</p>
	<ol>
		<li>A key generation algorithm, <em>Generate</em>, which generates a public verification key and a private signing key (a keypair).</li>
		<li>A signing algorithm, <em>Sign</em>, which takes the private signing key, a message, and outputs a signature of the message.</li>
		<li>A verification algorithm, <em>Verify</em>, which takes the public verification key, the signature and the message, and outputs a value stating whether the signature is valid or not.</li>
	</ol>
	<p>In the case of the Odysseus' story, what the cyclops could have done to verify his identity (to verify that he indeed was <em>Nobody</em>) was to ask for a proof of identity: for example, for other people to vouch that he is who he claims to be. Or he could have asked for a digital signature (attested by several people or registered as his own) attesting he was <em>Nobody.</em> Nothing like that happened, so the cyclops was fooled.</p>
	<p>In the Transport Layer Security protocol, TLS, authentication needs to be executed at the time a connection or conversation is established (as data sent after this point will be authenticated until that is explicitly disabled), rather than for the full lifetime of the data (as with confidentiality). Because of that, the need to transition to post-quantum signatures is not as urgent as it is for post-quantum key exchange schemes, and we do not believe there are sufficiently powerful quantum computers at the moment that can be used to listen in on connections and forge signatures. At some point, that will no longer be true, and the transition will have to be made.</p>
	<p>There are various candidates for authentication schemes (including digital signatures) that are quantum secure: some use cryptographic hash functions, some use problems over lattices, while others use techniques from the field of <a href="https://en.wikipedia.org/wiki/Secure_multi-party_computation?ref=blog.cloudflare.com" target="_blank">multi-party computation</a>. It is also possible to use Key Encapsulation Mechanisms (or KEMs) to achieve authentication in cryptographic protocols.</p>
	<p>In this post, much like in the one about <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">Key Encapsulation Mechanisms</a>, we will give a bird’s-eye view of the construction of one particular post-quantum signature algorithm. We will discuss <a href="https://pq-crystals.org/dilithium/data/dilithium-specification-round3.pdf?ref=blog.cloudflare.com" target="_blank">CRYSTALS-Dilithium</a>, as an example of how a signature scheme can be constructed. Dilithium is a finalist candidate in the <a href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions?ref=blog.cloudflare.com" target="_blank">NIST post-quantum cryptography standardization process</a> and provides an example of a standard technique used to construct digital signature schemes. We chose to explain Dilithium here as it is a finalist and its design is straightforward to explain.</p>
	<p>We will again build the algorithm up layer-by-layer. We will look at:</p>
	<ul>
		<li>Its mathematical underpinnings: as we see in <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">other blog posts</a>, a cryptographic algorithm can be built as a Matryoshka doll or a <a href="https://en.wikipedia.org/wiki/Chinese_boxes?ref=blog.cloudflare.com" target="_blank">Chinese box</a>. Let us use the Chinese box analogy here. The first box, in this case, is the mathematical base, whose hardness should be strong so that security is maintained. In the post-quantum world, this is usually the hardness of some lattice or isogeny problems.</li>
		<li>Its algorithmic construction: these are all the subsequent boxes that take the mathematical base and construct an algorithm out of it. In the case of a signature, first one constructs an identification scheme, which we will define in the next sections, and then transform it to a signature scheme using the <a href="https://www.iacr.org/archive/asiacrypt2009/59120596/59120596.pdf?ref=blog.cloudflare.com" target="_blank">Fiat-Shamir transformation</a>.</li>
	</ul>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/02/image5-6.png" class="kg-image" alt="The different boxes of a post-quantum algorithm" loading="lazy"></figure>
	<p>The mathematical core of <em>Dilithium</em> is, as with <a href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-3-submissions?ref=blog.cloudflare.com" target="_blank">FrodoKEM</a>, based on the hardness of a variant of the Learning with Errors (LWE) problem and the Short Integer Solution (SIS) problem. As we have already <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">talked about LWE</a>, let’s now briefly go over SIS.</p>
	<p><strong>Note to the reader</strong>: Some mathematics is coming in the next sections; but don’t worry, we will guide you through it.</p>
	<h3 id="the-short-integer-solution-problem">The Short Integer Solution Problem</h3>
	<p>In order to properly explain what the SIS problem is, we need to first start by understanding what a <em>lattice</em> is. A lattice is a regular repeated arrangement of objects or elements over a space. In geometry, these objects can be points; in physics, these objects can be atoms. For our purposes, we can think of a lattice as a set of points in <em>n</em>-dimensional space with a periodic (repeated) structure, as we see in the image. It is important to understand the meaning of <em>n</em>-dimensional space here: a two-dimensional space is, for example, the one that we often see represented on planes: a projection of the physical universe into a plane with two dimensions which are length and width. Historically, lattices have been investigated since the late 18th century for various reasons. For a more comprehensive introduction to lattices, you can read this <a href="https://cims.nyu.edu/~regev/papers/qcrypto.pdf?ref=blog.cloudflare.com" target="_blank">great paper</a>.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2022/02/image4-11.png" class="kg-image" alt="picture of a lattice." loading="lazy">
		<figcaption>Picture of a lattice. They are found in the wild in Portugal.</figcaption>
	</figure>
	<p>What does <a href="https://crypto.stanford.edu/cs355/18sp/lec9.pdf?ref=blog.cloudflare.com" target="_blank">SIS</a> pertain to? You are given a positive integer <em>q</em> and a <a href="https://en.wikipedia.org/wiki/Matrix_(mathematics)?ref=blog.cloudflare.com" target="_blank">matrix</a> (a rectangular array of numbers) <em>A</em> of dimensions <em>n x m</em> (the number of rows is <em>n </em>and the number of columns is <em>m</em>), whose elements are integers between 0 and a number <em>q</em>. You are then asked to find a <a href="https://en.wikipedia.org/wiki/Vector_(mathematics_and_physics)?ref=blog.cloudflare.com" target="_blank">vector</a> <em>r </em>(smaller than a certain amount, called the “norm bound”)<em> </em>such that <em>Ar = 0</em>. The conjecture is that, for a sufficiently large <em>n</em>, finding this solution is hard even for quantum computers. This problem is “dual” to the LWE problem that we explored in <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">another blog post</a>.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2022/02/image2-18.png" class="kg-image" alt="the SIS problem" loading="lazy"></figure>
	<p>We can define this same <a href="https://web.eecs.umich.edu/~cpeikert/pubs/slides-abit2.pdf?ref=blog.cloudflare.com" target="_blank">problem over a lattice</a>. Take a lattice <em>L(A)</em>, made up of <em>m</em> different <em>n</em>-dimensional vectors <em>y</em> (the repeated elements)<em>. </em>The goal is to find non-zero vectors in the lattice such that <em>Ay = 0 (mod q)</em> (for some <em>q</em>), whose size is less than a certain specified amount. This problem can be seen as trying to find the “short” solutions in the lattice, which makes the problem the <a href="https://en.wikipedia.org/wiki/Lattice_problem?ref=blog.cloudflare.com#Shortest_vector_problem_(SVP)" target="_blank">Short Vector Problem</a> (SVP) in the average case. Finding this solution is simple to do in two dimensions (as seen in the diagram), but finding the solution in more dimensions is hard.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2022/02/image3-20.png" class="kg-image" alt="The SIS problem as the SVP. The goal is to find the “short” vectors in the radius." loading="lazy">
		<figcaption>The SIS problem as the SVP. The goal is to find the “short” vectors in the radius.</figcaption>
	</figure>
	<p>The SIS problem is often used in cryptographic constructions such as one-way functions, collision resistant hash functions, digital signature schemes, and identification schemes.</p>
	<p>We have now built the first Chinese box: the mathematical base. Let’s take this base now and create schemes from it.</p>
	<h3 id="identification-schemes">Identification Schemes </h3>
	<p>From the mathematical base of our Chinese box, we build the first computational algorithm: an identification scheme. An identification scheme consists of a key generation algorithm, which outputs a public and private key, and an interactive protocol between a prover<em> P</em> and a verifier <em>V</em>. The prover has access to the public key and private key, and the verifier only has access to the public key. A series of messages are then exchanged such that the prover can demonstrate to the verifier that they know the private key, without leaking any other information about the private key.</p>
	<p>More specifically, a three-move (three rounds of interaction) identification scheme is a collection of algorithms. Let’s think about it in the terms of Odysseus trying to prove to the cyclops that he is <em>Nobody</em>:</p>
	<ul>
		<li>Odysseus (the prover) runs a key generation algorithm, <em>Generate</em>, that outputs a public and private keypair.</li>
		<li>Odysseus then runs a commitment algorithm, <em>Commit,</em> that uses the private key, and outputs a commitment <em>Y</em>. The commitment is nothing more than a statement that this specific private key is the one that will be used. He sends this to the cyclops.</li>
		<li>The cyclops (the verifier) takes the commitment and runs a challenge algorithm, <em>Challenge</em>, and outputs a challenge <em>c</em>. This challenge is a question that asks: are you really the owner of the private key?</li>
		<li>Odysseus receives the challenge and runs a response algorithm, <em>Response</em>. This outputs a response <em>z</em> to the challenge. He sends this value to the cyclops.</li>
		<li>The cyclops runs the verification algorithm, <em>Verify</em>, which outputs either accept (1) or reject (0) if the answer is correct.</li>
	</ul>
	<p>If Odysseus was really the owner of the private key for <em>Nobody</em>, he would have been able to answer the challenge in a positive manner (with a 1). But, as he is not, he runs away (and this is the last time we see him in this blogpost).</p>
	<h3 id="the-dilithium-identification-scheme">The Dilithium Identification Scheme</h3>
	<p>The basic building blocks of Dilithium are polynomials and rings. This is the second-last box of the Chinese box, and we will explore it now.</p>
	<p>A polynomial ring, <em>R</em>, is a <a href="https://en.wikipedia.org/wiki/Ring_(mathematics)?ref=blog.cloudflare.com" target="_blank">ring</a> of all polynomials. A ring is a set in which two operations can exist: addition and multiplication of integers; and a polynomial is an expression of variables and coefficients. The “size” of these polynomials, defined as the size of the largest coefficient, plays a crucial role for these kinds of algorithms.</p>
	<p>In the case of Dilithium, the <em>Generation </em>algorithm creates a <em>k x l</em> matrix <em>A</em>. Each entry of this matrix is a polynomial in the defined ring. The generation algorithm also creates random private vectors <em>s1 </em>and <em>s2</em>, whose components are elements of <em>R</em>, the ring<em>. </em>The public key is the matrix <em>A</em> and <em>t = As1 + s2</em>. It is infeasible for a quantum computer to know the secret values given just <em>t</em> and <em>A</em>. This problem is called Module-Learning With Errors (MLWE) problem, and it is a variant of LWE as seen <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">in this blog post</a>.</p>
	<p>Armed with the public and private keys, the Dilithium <em>identification scheme </em>proceeds as follows (some details are left out for simplicity, like the rejection sampling):</p><!--kg-card-begin: markdown-->
	<ol>
		<li>The prover wants to prove they know the private key. They generate a random secret nonce y whose coefficient is less than a security parameter. They then compute Ay and set a commitment w1 to be the “high-order”<sup>1</sup> bits of the coefficients in this vector.</li>
		<li>The verifier accepts the commitment and creates a challenge c.</li>
		<li>The prover creates the potential signature z = y + cs1 (notice the usage of the random secret nonce and of the private key) and performs checks on the sizes of several parameters which makes the signature secure. This is the answer to the challenge.</li>
		<li>The verifier receives the signature and computes w1 to be the “high-order” bits of Az−ct (notice the usage of the public key). They accept this answer if all the coefficients of z are less than the security parameter, and if w1 is equal to w0.</li>
	</ol>
	<!--kg-card-end: markdown-->
	<p>The identity scheme previously mentioned is an interactive protocol that requires participation from both parties. How do we turn this into a non-interactive signature scheme where one party issues signatures and other parties can verify them (the reason for this conversation is that anyone should be able to publicly verify)? Here, we place the last Chinese box.</p>
	<p>A three-move identification scheme can be turned into a signature scheme using the Fiat–Shamir transformation: instead of the verifier accepting the commitment and sending a challenge <em>c</em>, the prover computes the challenge as a hash <em>H(M || w1)</em> &nbsp;of the message <em>M</em> and of the value <em>w1</em> (computed in step 1 of the previous scheme). This is an approach in which the signer has created an instance of a lattice problem, which only the signer knows the solution to.</p>
	<p>This in turn means that if a message was signed with a key, it could have only been signed by the person with access to the private key, and it can be verified by anyone with access to the public key.</p>
	<p>How is this procedure related to the lattice’s problems we have seen? It is used to prove the security of the scheme: specifically the M-SIS (module SIS) problem and the LWE decisional problem.</p>
	<p>The Chinese box is now constructed, and we have a digital signature scheme that can be used safely in the face of quantum computers.</p>
	<h3 id="other-digital-signatures-beyond-dilithium">Other Digital Signatures beyond Dilithium</h3>
	<p>In Star Trek, <em><a href="https://en.wikipedia.org/wiki/Dilithium_(Star_Trek)?ref=blog.cloudflare.com" target="_blank">Dilithium</a></em> is a rare material that cannot be replicated. Similarly, signatures cannot be replicated or forged: each one is unique. But this does not mean that there are no other algorithms we can use to generate post-quantum signatures. Dilithium is currently designated as a finalist candidate for standardization as part of the post-quantum NIST process. But, there are others:</p>
	<ul>
		<li><a href="https://falcon-sign.info/?ref=blog.cloudflare.com" target="_blank">Falcon</a>, another lattice-based candidate, based on NTRU lattices.</li>
		<li><a href="https://www.pqcrainbow.org/?ref=blog.cloudflare.com" target="_blank">Rainbow</a>, a scheme based on multivariate polynomials.</li>
	</ul>
	<p>We have seen examples of KEMs in <a href="https://blog.cloudflare.com/post-quantum-key-encapsulation">other blog posts</a> and signatures that are resistant to attacks by quantum computers. Now is the time to step back and take a look at the bigger picture. We have the building blocks, but the problem of actually building post-quantum secure cryptographic protocols with them remains, as well as making existing protocols such as TLS post-quantum secure. This problem is not entirely straightforward, owing to the trade-offs that post-quantum algorithms present. As we have carefully stitched together mathematical problems and cryptographic tools to get algorithms with the properties we desire, so do we have to carefully compose these algorithms to get the secure protocols that we need.</p>
	<h3 id="references-">References:</h3>
	<ul>
		<li>“Fiat-Shamir With Aborts: Applications to Lattice and Factoring-Based Signatures” by Vadim Lyubashevsky: <a href="https://www.iacr.org/archive/asiacrypt2009/59120596/59120596.pdf?ref=blog.cloudflare.com" target="_blank">https://www.iacr.org/archive/asiacrypt2009/59120596/59120596.pdf</a></li>
		<li>“A Concrete Treatment of Fiat-Shamir Signatures in the Quantum Random-Oracle Model” by Eike Kiltz, Vadim Lyubashevsky and Christian Schaffner: <a href="https://eprint.iacr.org/2017/916.pdf?ref=blog.cloudflare.com" target="_blank">https://eprint.iacr.org/2017/916.pdf</a></li>
		<li>“On Lattices, Learning with Errors, Random Linear Codes, and Cryptography” by Oded Regev: <a href="https://cims.nyu.edu/~regev/papers/qcrypto.pdf?ref=blog.cloudflare.com" target="_blank">https://cims.nyu.edu/~regev/papers/qcrypto.pdf</a></li>
		<li>“CRYSTALS: (Cryptographic Suite for Algebraic Lattices) Dilithium” by Léo Ducas, Eike Kiltz, Tancrede Lepoint, Vadim Lyubashevsky, Peter Schwabe, Gregor Seiler and Damien Stehle: <a href="https://csrc.nist.gov/CSRC/media/Presentations/crystals-dilithium-round-2-update/images-media/crystals-dilithium-lyubashevsky.pdf?ref=blog.cloudflare.com" target="_blank">https://csrc.nist.gov/CSRC/media/Presentations/crystals-dilithium-round-2-update/images-media/crystals-dilithium-lyubashevsky.pdf</a></li>
		<li>“The Design and Cryptanalysis of Post-Quantum Digital Signature Algorithms” by Ward Beullens: <a href="https://www.esat.kuleuven.be/cosic/publications/thesis-417.pdf?ref=blog.cloudflare.com" target="_blank">https://www.esat.kuleuven.be/cosic/publications/thesis-417.pdf</a></li>
		<li>“How To Prove Yourself: Practical Solutions to Identification and Signature Problems” by Amos Fiat and Adi Shamir: <a href="https://link.springer.com/content/pdf/10.1007/3-540-47721-7_12.pdf?ref=blog.cloudflare.com" target="_blank">https://link.springer.com/content/pdf/10.1007/3-540-47721-7_12.pdf</a></li>
	</ul>
	<p>.....</p><!--kg-card-begin: markdown-->
	<p><small><sup>1</sup>This “high-order” and “low-order” procedure decomposes a vector, and there is a specific procedure for this for Dilithium. It aims to reduce the size of the public key.</small></p>
	<!--kg-card-end: markdown-->
</div>