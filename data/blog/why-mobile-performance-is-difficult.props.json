{
	"post": {
		"id": "5d16453b41acde0011a95404",
		"uuid": "588f60e3-5007-44d1-b381-b7ab0a5cbd25",
		"title": "Why mobile performance is difficult",
		"slug": "why-mobile-performance-is-difficult",
		"html": "<!--kg-card-begin: markdown--><p>Mobile web browsing is very different, at the network level, to browsing on a desktop machine connected to the Internet. Yet both use the very same protocols, and although TCP was designed to perform well on the fixed-line Internet, it doesn't perform as well on mobile networks. This post looks at why and how CloudFlare is helping.</p>\n<p>We start with a simple ping. Here's a ping from my laptop machine (which is connected via 802.11g WiFi to a 20Mbps broadband connection) to a machine at Google. Looks like I'm getting a roundtrip time of about 20ms.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/Screen_Shot_2012-06-27_at_4.22.50_PM.png.scaled500.png\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/Screen_Shot_2012-06-27_at_4.22.50_PM.png.scaled500.png\" title=\"Why mobile performance is difficult\"></noscript></p>\n<p>Here's the same ping done from my iPhone on the same WiFi network at the same location in the house. The ping time has gone up to about 60ms. So, in this instance, the round trip time had tripled just from going from laptop to phone.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3783.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3783.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"></noscript></p>\n<p>But to see the real cost of mobile it's necessary to switch off WiFi and onto 3G. Here's the ping time on 3G to the same machine. Here's it's both much higher (we're now into 1/10 to 1/5 of a second territory) but it's also variable:</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3777.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3777.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"></noscript></p>\n<p>And then I get up and move to the front of the house and try again. The ping time has changed completely (the number of bars didn't) and I'm seeing between 0.5s and 1s of round trip time. That will have a serious effect on web browsing.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3778.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3778.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"></noscript></p>\n<p>And for a final test I return to my original location and grip the iPhone firmly in my hand. The number of bars falls away and the round trip time becomes infinite! Pings simply aren't working any more.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3781.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/IMG_3781.PNG.scaled500.png\" title=\"Why mobile performance is difficult\"></noscript></p>\n<p>What this illustrates is something that any smartphone user knows instinctively: network performance on phone is very variable and susceptible to location and environment. TCP would actually work just fine on a phone except for one small detail: phones don't stay in one location. Because they move around (while using the Internet) the parameters of the network (such as the latency) between the phone and the web server are changing and TCP wasn't designed to detect the sort of change that's happening.</p>\n<p>In past posts I've looked at the effect of <a href=\"http://blog.cloudflare.com/the-bandwidth-of-a-boeing-747-and-its-impact\">high latency on web browsing</a> and <a href=\"http://blog.cloudflare.com/the-bandwidth-of-a-boeing-747-and-its-impact\">TCP's connection and slow start cost</a>. One of the fundamental parts of the TCP specification covers congestion avoidance: the <a href=\"http://en.wikipedia.org/wiki/Transmission_Control_Protocol#Congestion_control\">detection and avoidance of congestion</a> on the Internet. At the start of a connection TCP's slow start prevents it from blasting out packets until it's detected the maximum possible speed it can transmit at, and during a connection TCP actively watches for signs of congestion. The smooth running of the Internet as a whole relies on protocols like TCP being able to detect congestion and slow down. If not there'd likely be a <a href=\"http://en.wikipedia.org/wiki/Congestive_collapse#Congestive_collapse\">congestion collapse</a>.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/7454479488_9cf64433d6.jpeg.scaled500.jpg\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/7454479488_9cf64433d6.jpeg.scaled500.jpg\" title=\"Why mobile performance is difficult\"></noscript><br>\n<small>Image credit: <a href=\"http://www.parliamentlive.tv/Main/Player.aspx?meetingId=10948&amp;wfs=true\">joiseyshowaa</a></small></p>\n<p>TCP spots congestion by watching for lost packets. On the wired Internet lost packets are a sign of congestion: they're a sign that a buffer in a router or server somewhere along the route packets are taking is full and is simply dropping packets. When lost packets are detected by TCP it slows down.</p>\n<p>That all falls apart on mobile networks because packets get lost for other reasons: you move around your house while surfing a web page, or you're on the train, or you just block the signal some other way. When that happens it's not congestion, but TCP thinks it is, and reacts by slowing down the connection.</p>\n<p>It seems like it might be a simple matter to change the congestion avoidance algorithm in TCP to take into account the challenges of mobile networks, but it's actually an area of <a href=\"http://en.wikipedia.org/wiki/TCP_congestion_avoidance_algorithm\">active research</a> with many different possible replacements for the existing basic algorithm. It's hard because trying to balance maximizing throughput, preventing congestion on the Internet, dealing with actual congestion, and spotting phony congestion is complex.</p>\n<p><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/6031969871_19086b6f70.jpeg.scaled500.jpg\" title=\"Why mobile performance is difficult\"><noscript><img alt=\"Why mobile performance is difficult\" src=\"http://blog.cloudflare.com/content/images/6031969871_19086b6f70.jpeg.scaled500.jpg\" title=\"Why mobile performance is difficult\"></noscript><br>\n<small>Image credit: <a href=\"http://www.flickr.com/photos/mikecogh/\">mikecogh</a></small></p>\n<p>And if that weren't enough mobile networks also introduce another tricky problem: packet reordering. Although TCP is designed to cope with reordering of packets (because they might have followed different routes between source and destination) large reordering can occur in mobile networks when a mobile phone is handed off from one tower to the next.</p>\n<p>For example, a stream of packets being transmitted by a moving mobile user (perhaps sending a large email) might be split with some going down one route through one tower and the rest through a different tower and by a different route.</p>\n<p>This causes problems for some of the newer congestion avoidance algorithms (such as <a href=\"http://en.wikipedia.org/wiki/TCP_congestion_avoidance_algorithm#TCP_New_Reno\">TCP New Reno</a>) and can cause additional slow downs.</p>\n<p>CloudFlare helps solve these problems for our customers in two ways. Firstly, we customize the parameters inside the TCP stacks in our web servers to tune for the best possible performance and secondly we actively monitor and classify the connections from people surfing our customers' sites.</p>\n<p>By classifying connections we are able to dynamically determine the best way to behave on a connection. We know whether this is likely to be a high-latency mobile phone browsing session, or a high-bandwidth broadband connection in someone's home or office. Doing that allows us to give the best performance to end users, and ensure that customers' web sites are snappy wherever and however they are accessed.</p>\n<p>And we continually look at ways of improving network performance for our customers by tuning TCP, monitoring performance, opening new data centers and introducing features like <a href=\"http://blog.cloudflare.com/combining-javascript-css-a-better-way\">Rocket Loader</a>, <a href=\"http://blog.cloudflare.com/introducing-mirage-intelligent-image-loading\">Mirage</a>, <a href=\"http://blog.cloudflare.com/introducing-polish-automatic-image-optimizati\">Polish,</a> <a href=\"http://blog.cloudflare.com/what-makes-spdy-speedy\">SPDY</a>, and <a href=\"https://www.cloudflare.com/railgun\">Railgun</a>.</p>\n<!--kg-card-end: markdown-->",
		"comment_id": "4366",
		"feature_image": "http://blog.cloudflare.com/content/images/2018/02/7454479488_9cf64433d6.jpeg.scaled500.jpg",
		"featured": false,
		"visibility": "public",
		"created_at": "2014-08-20T11:03:46.000+01:00",
		"updated_at": "2018-02-20T20:49:49.000+00:00",
		"published_at": "2012-06-28T07:48:00.000+01:00",
		"custom_excerpt": "Mobile web browsing is very different, at the network level, to browsing on a desktop machine connected to the Internet. Yet both use the very same protocols, and although TCP was designed to perform well on the fixed-line Internet, it doesn't perform as well on mobile networks. ",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "5d1644b141acde0011a94f2c",
				"name": "John Graham-Cumming",
				"slug": "john-graham-cumming",
				"profile_image": "http://blog.cloudflare.com/content/images/2017/03/url-2.jpg",
				"cover_image": "http://blog.cloudflare.com/content/images/2023/05/Twitter-Header-@cloudflare-US.png",
				"bio": null,
				"website": null,
				"location": "Lisbon, Portugal",
				"facebook": null,
				"twitter": null,
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/john-graham-cumming/"
			}
		],
		"tags": [
			{
				"id": "5d16450341acde0011a9514a",
				"name": "Mobile",
				"slug": "mobile",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/mobile/"
			},
			{
				"id": "5d16450341acde0011a95163",
				"name": "TCP",
				"slug": "tcp",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/tcp/"
			},
			{
				"id": "5d16450341acde0011a95160",
				"name": "Speed & Reliability",
				"slug": "speed-and-reliability",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Speed---Reliability-1.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Speed & Reliability",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Speed & Reliability'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/speed-and-reliability/"
			},
			{
				"id": "5d16450341acde0011a95149",
				"name": "Mirage",
				"slug": "mirage",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/mirage/"
			},
			{
				"id": "5d16450341acde0011a95186",
				"name": "Cloudflare Polish",
				"slug": "cloudflare-polish",
				"description": "Polish image optimization tool",
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/cloudflare-polish/"
			},
			{
				"id": "5d16450341acde0011a9517c",
				"name": "spdy",
				"slug": "spdy",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/spdy/"
			},
			{
				"id": "5d16450341acde0011a95170",
				"name": "Rocket Loader",
				"slug": "rocketloader",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/rocketloader/"
			},
			{
				"id": "5d16450341acde0011a951ee",
				"name": "Product News",
				"slug": "product-news",
				"description": "Product News (EN)",
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Product-News-1.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Product News",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Product News'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/product-news/"
			}
		],
		"primary_author": {
			"id": "5d1644b141acde0011a94f2c",
			"name": "John Graham-Cumming",
			"slug": "john-graham-cumming",
			"profile_image": "http://blog.cloudflare.com/content/images/2017/03/url-2.jpg",
			"cover_image": "http://blog.cloudflare.com/content/images/2023/05/Twitter-Header-@cloudflare-US.png",
			"bio": null,
			"website": null,
			"location": "Lisbon, Portugal",
			"facebook": null,
			"twitter": null,
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/john-graham-cumming/"
		},
		"primary_tag": {
			"id": "5d16450341acde0011a9514a",
			"name": "Mobile",
			"slug": "mobile",
			"description": null,
			"feature_image": null,
			"visibility": "public",
			"meta_title": null,
			"meta_description": null,
			"og_image": null,
			"og_title": null,
			"og_description": null,
			"twitter_image": null,
			"twitter_title": null,
			"twitter_description": null,
			"codeinjection_head": null,
			"codeinjection_foot": null,
			"canonical_url": null,
			"accent_color": null,
			"url": "http://blog.cloudflare.com/tag/mobile/"
		},
		"url": "http://blog.cloudflare.com/why-mobile-performance-is-difficult/",
		"excerpt": "Mobile web browsing is very different, at the network level, to browsing on a desktop machine connected to the Internet. Yet both use the very same protocols, and although TCP was designed to perform well on the fixed-line Internet, it doesn't perform as well on mobile networks. ",
		"reading_time": 5,
		"access": true,
		"comments": false,
		"og_image": null,
		"og_title": null,
		"og_description": null,
		"twitter_image": null,
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": null,
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	},
	"locale": "en-us"
}