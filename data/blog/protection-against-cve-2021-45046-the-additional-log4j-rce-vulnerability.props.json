{
	"locale": "en-us",
	"post": {
		"id": "61b9f18409f69a0011086f2b",
		"uuid": "9862fe72-57b3-402c-a1e9-6ceb3861c5b5",
		"title": "Protection against CVE-2021-45046, the additional Log4j RCE vulnerability",
		"slug": "protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability",
		"html": "<!--kg-card-begin: markdown--><p><em><small>This post is also available in <a href=\"http://blog.cloudflare.com/zh-cn/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-zh-cn/\">简体中文</a>, <a href=\"http://blog.cloudflare.com/zh-tw/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-zh-tw/\">繁體中文</a>, <a href=\"http://blog.cloudflare.com/ja-jp/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-ja-jp/\">日本語</a>, <a href=\"http://blog.cloudflare.com/ko-kr/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-ko-kr/\">한국어</a>, <a href=\"http://blog.cloudflare.com/de-de/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-de-de/\">Deutsch</a>, <a href=\"http://blog.cloudflare.com/fr-fr/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability-fr-fr/\">Français</a>.</small></em></p>\n<!--kg-card-end: markdown--><figure class=\"kg-card kg-image-card\"><img src=\"http://blog.cloudflare.com/content/images/2021/12/image1-80.png\" class=\"kg-image\" alt=\"Protection against CVE-2021-45046, the additional Log4J RCE vulnerability\" loading=\"lazy\"></figure><p>Hot on the heels of CVE-2021-44228 a second Log4J CVE has been filed <a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-45046\">CVE-2021-45046</a>. The rules that we <a href=\"http://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation/\">previously released for CVE-2021-44228</a> give the same level of protection for this new CVE.</p><p>This vulnerability is actively being exploited and anyone using Log4J should update to version <strong>2.16.0</strong> as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the <a href=\"https://logging.apache.org/log4j/2.x/download.html\">Log4J download page</a>.</p><p>Customers using the Cloudflare WAF have three rules to help mitigate any exploit attempts:</p><!--kg-card-begin: markdown--><table>\n<thead>\n<tr>\n<th>Rule ID</th>\n<th>Description</th>\n<th>Default Action</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>100514</code> (legacy WAF)<br><code>6b1cc72dff9746469d4695a474430f12</code> (new WAF)</td>\n<td>Log4J Headers</td>\n<td><code>BLOCK</code></td>\n</tr>\n<tr>\n<td><code>100515</code> (legacy WAF)<br><code>0c054d4e4dd5455c9ff8f01efe5abb10</code> (new WAF)</td>\n<td>Log4J Body</td>\n<td><code>BLOCK</code></td>\n</tr>\n<tr>\n<td><code>100516</code> (legacy WAF)<br><code>5f6744fa026a4638bda5b3d7d5e015dd</code> (new WAF)</td>\n<td>Log4J URL</td>\n<td><code>BLOCK</code></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: markdown--><p>The mitigation has been split across three rules inspecting HTTP headers, body and URL respectively.</p><p>In addition to the above rules we have also released a fourth rule that will protect against a much wider range of attacks at the cost of a higher false positive rate. For that reason we have made it available but not set it to <code>BLOCK</code> by default:</p><!--kg-card-begin: markdown--><table>\n<thead>\n<tr>\n<th>Rule ID</th>\n<th>Description</th>\n<th>Default Action</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>100517</code> (legacy WAF)<br><code>2c5413e155db4365befe0df160ba67d7</code> (new WAF)</td>\n<td>Log4J Advanced URI, Headers</td>\n<td><code>DISABLED</code></td>\n</tr>\n</tbody>\n</table>\n<!--kg-card-end: markdown--><h3 id=\"who-is-affected\">Who is affected</h3><p>Log4J is a powerful Java-based logging library maintained by the Apache Software Foundation.</p><p>In all Log4J versions &gt;= 2.0-beta9 and &lt;= 2.14.1 JNDI features used in configuration, log messages, and parameters can be exploited by an attacker to perform <a href=\"https://www.cloudflare.com/learning/security/what-is-remote-code-execution/\">remote code execution</a>. Specifically, an attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.</p><p>In addition, the previous mitigations for CVE-2021-22448 as seen in version 2.15.0 were not adequate to protect against CVE-2021-45046.</p>",
		"comment_id": "61b9f18409f69a0011086f2b",
		"feature_image": "http://blog.cloudflare.com/content/images/2021/12/image1-81.png",
		"featured": false,
		"visibility": "public",
		"created_at": "2021-12-15T13:45:40.000+00:00",
		"updated_at": "2023-07-10T21:22:59.000+01:00",
		"published_at": "2021-12-15T13:56:13.000+00:00",
		"custom_excerpt": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the Log4J download page.",
		"codeinjection_head": null,
		"codeinjection_foot": null,
		"custom_template": null,
		"canonical_url": null,
		"authors": [
			{
				"id": "604420f7b6994503f310a51e",
				"name": "Gabriel Gabor",
				"slug": "gabriel",
				"profile_image": "http://blog.cloudflare.com/content/images/2021/03/unnamed.jpg",
				"cover_image": null,
				"bio": null,
				"website": null,
				"location": null,
				"facebook": null,
				"twitter": null,
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/gabriel/"
			},
			{
				"id": "602e47a4c2b5fa01bc99cb39",
				"name": "Andre Bluehs",
				"slug": "andre-bluehs",
				"profile_image": "http://blog.cloudflare.com/content/images/2021/02/headshot.jpg",
				"cover_image": null,
				"bio": "Engineering Manager for the Managed Rules (WAF) team.",
				"website": null,
				"location": "London, UK",
				"facebook": null,
				"twitter": null,
				"meta_title": null,
				"meta_description": null,
				"url": "http://blog.cloudflare.com/author/andre-bluehs/"
			}
		],
		"tags": [
			{
				"id": "61b9f1e209f69a0011086f34",
				"name": "#BLOG-909",
				"slug": "hash-blog-909",
				"description": null,
				"feature_image": null,
				"visibility": "internal",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/404/"
			},
			{
				"id": "61b8bab009f69a00110869fd",
				"name": "Log4J",
				"slug": "log4j",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2021/12/Log4J.png",
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/log4j/"
			},
			{
				"id": "61b8bab009f69a00110869fe",
				"name": "Log4Shell",
				"slug": "log4shell",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2021/12/Log4Shell-.png",
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/log4shell/"
			},
			{
				"id": "5d16450341acde0011a951a5",
				"name": "WAF Rules",
				"slug": "waf-rules",
				"description": null,
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": "WAF Rules (EN)",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/waf-rules/"
			},
			{
				"id": "5d16450341acde0011a95265",
				"name": "Security",
				"slug": "security",
				"description": null,
				"feature_image": "http://blog.cloudflare.com/content/images/2020/10/Security.png",
				"visibility": "public",
				"meta_title": "Cloudflare Blog: Security",
				"meta_description": "Collection of Cloudflare blog posts tagged 'Security'.",
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/security/"
			},
			{
				"id": "5d16450341acde0011a951aa",
				"name": "Vulnerabilities",
				"slug": "vulnerabilities",
				"description": "Vulnerabilities (EN)",
				"feature_image": null,
				"visibility": "public",
				"meta_title": null,
				"meta_description": null,
				"og_image": null,
				"og_title": null,
				"og_description": null,
				"twitter_image": null,
				"twitter_title": null,
				"twitter_description": null,
				"codeinjection_head": null,
				"codeinjection_foot": null,
				"canonical_url": null,
				"accent_color": null,
				"url": "http://blog.cloudflare.com/tag/vulnerabilities/"
			}
		],
		"primary_author": {
			"id": "604420f7b6994503f310a51e",
			"name": "Gabriel Gabor",
			"slug": "gabriel",
			"profile_image": "http://blog.cloudflare.com/content/images/2021/03/unnamed.jpg",
			"cover_image": null,
			"bio": null,
			"website": null,
			"location": null,
			"facebook": null,
			"twitter": null,
			"meta_title": null,
			"meta_description": null,
			"url": "http://blog.cloudflare.com/author/gabriel/"
		},
		"primary_tag": null,
		"url": "http://blog.cloudflare.com/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability/",
		"excerpt": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the Log4J download page.",
		"reading_time": 2,
		"access": true,
		"comments": false,
		"og_image": "http://blog.cloudflare.com/content/images/2021/12/Protection-against-CVE-2021-45046-OG-1.png",
		"og_title": null,
		"og_description": null,
		"twitter_image": "http://blog.cloudflare.com/content/images/2021/12/Protection-against-CVE-2021-45046-OG.png",
		"twitter_title": null,
		"twitter_description": null,
		"meta_title": null,
		"meta_description": "This vulnerability is actively being exploited and anyone using Log4J should update to version 2.16.0 as soon as possible, even if you have previously updated to 2.15.0. The latest version can be found on the Log4J download page.",
		"email_subject": null,
		"frontmatter": null,
		"feature_image_alt": null,
		"feature_image_caption": null
	}
}