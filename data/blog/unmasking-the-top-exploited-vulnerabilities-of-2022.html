<div class="mb2 gray5">7 min read</div>
<div class="post-content lh-copy gray1"><!--kg-card-begin: markdown-->
	<p><small>This post is also available in <a href="https://blog.cloudflare.com/zh-cn/unmasking-the-top-exploited-vulnerabilities-of-2022-zh-cn">简体中文</a>, <a href="https://blog.cloudflare.com/zh-tw/unmasking-the-top-exploited-vulnerabilities-of-2022-zh-tw">繁體中文</a>, <a href="https://blog.cloudflare.com/ja-jp/unmasking-the-top-exploited-vulnerabilities-of-2022-ja-jp">日本語</a>, <a href="https://blog.cloudflare.com/ko-kr/unmasking-the-top-exploited-vulnerabilities-of-2022-ko-kr">한국어</a>, <a href="https://blog.cloudflare.com/fr-fr/unmasking-the-top-exploited-vulnerabilities-of-2022-fr-fr">Français</a> and <a href="https://blog.cloudflare.com/de-de/unmasking-the-top-exploited-vulnerabilities-of-2022-de-de">Deutsch</a></small></p>
	<!--kg-card-end: markdown-->
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/1a.png" class="kg-image" alt="" loading="lazy" width="1200" height="675"></figure>
	<p>The Cybersecurity and Infrastructure Security Agency (CISA) just <a href="https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-215a">released a report highlighting the most commonly exploited vulnerabilities of 2022</a>. With our role as a reverse proxy to a large portion of the Internet, Cloudflare is in a unique position to observe how the Common Vulnerabilities and Exposures (CVEs) mentioned by CISA are being exploited on the Internet.</p>
	<p>We wanted to share a bit of what we’ve learned.</p>
	<p>Based on our analysis, two CVEs mentioned in the CISA report are responsible for the vast majority of attack traffic seen in the wild: Log4J and Atlassian Confluence Code Injection. Although CISA/CSA discuss a larger number of vulnerabilities in the same report, our data clearly suggests a major difference in exploit volume between the top two and the rest of the list.</p>
	<h3 id="the-top-cves-for-2022">The top CVEs for 2022</h3>
	<p>Looking at the volume of requests detected by WAF Managed Rules that were created for the specific CVEs listed in the CISA report, we rank the vulnerabilities in order of prevalence:</p><!--kg-card-begin: html-->
	<table style="border:none;border-collapse:collapse;">
		<colgroup>
			<col width="233">
			<col width="233">
			<col width="233">
		</colgroup>
		<tbody>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;background-color:#d9d9d9;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Popularity rank</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;background-color:#d9d9d9;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Description</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;background-color:#d9d9d9;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:700;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVEs</span></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">1. Improper Input Validation caused Remote Code execution in Apache Log4j logging library</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Log4J</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2021-44228</span></a></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">2. Atlassian Confluence Server and Data Center Remote Code Execution Vulnerability</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Atlassian Confluence Code Injection</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-26134" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2022-26134</span></a></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">3. 3 issues were combined together to achieve Remote Code execution also known as ProxyShell</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Microsoft Exchange servers</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34473" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2021-34473</span></a><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">, </span><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-31207" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2021-31207</span></a><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">, </span><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34523" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2021-34523</span></a></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">4. undisclosed requests may bypass iControl REST authentication and run arbitrary code</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">BIG-IP F5</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-1388" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2022-1388</span></a></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">5. 2 issues were combined to together to achieve remote Root</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">VMware</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22954" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2022-22954</span></a><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">,&nbsp;</span></p>
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22960" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2022-22960</span></a></p>
				</td>
			</tr>
			<tr style="height:0pt">
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.2;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">6. Remote Code execution Issue in Confluence Server and Data Center</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#000000;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">Atlassian Confluence 0-day</span></p>
				</td>
				<td style="border-left:solid #000000 1pt;border-right:solid #000000 1pt;border-bottom:solid #000000 1pt;border-top:solid #000000 1pt;vertical-align:top;padding:5pt 5pt 5pt 5pt;overflow:hidden;overflow-wrap:break-word;">
					<p dir="ltr" style="line-height:1.38;margin-top:0pt;margin-bottom:0pt;"><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-26084" style="text-decoration:none;"><span style="font-size:11pt;font-family:Arial,sans-serif;color:#1155cc;background-color:transparent;font-weight:400;font-style:normal;font-variant:normal;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;vertical-align:baseline;white-space:pre;white-space:pre-wrap;">CVE-2021-26084</span></a></p>
				</td>
			</tr>
		</tbody>
	</table><!--kg-card-end: html-->
	<p>Topping the list is Log4J (<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-44228">CVE-2021-44228</a>). This isn’t surprising, as this is likely one of the most high impact exploits we have seen in decades — leading to full remote compromise. The second most exploited vulnerability is the Atlassian Confluence Code Injection (<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-26134">CVE-2022-26134</a>).</p>
	<p>In third place we find the combination of three CVEs targeting Microsoft Exchange servers (<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34473">CVE-2021-34473</a>, <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-31207">CVE-2021-31207</a>, and <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-34523">CVE-2021-34523</a>). In fourth is a BIG-IP F5 exploit (<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-1388">CVE-2022-1388</a>) followed by the combination of two VMware vulnerabilities (<a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22954">CVE-2022-22954</a> and <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-22960">CVE-2022-22960</a>). Our list ends with another Atlassian Confluence 0-day (<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-26084">CVE-2021-26084</a>).</p>
	<p>When comparing the attack volume for these five groups, we immediately notice that one vulnerability stands out. Log4J is more than an order of magnitude more exploited than the runner up (Atlassian Confluence Code Injection); and all the remaining CVEs are even lower. Although the CISA/CSA report groups all these vulnerabilities together, we think that there are really two groups: one dominant CVE (Log4J), and a secondary group of comparable 0-days. Each of the two groups have similar attack volume.</p>
	<p>The chart below, in logarithmic scale, clearly shows the difference in popularity.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2a.png" class="kg-image" alt="Number of requests blocked across the Cloudflare network for each CVE. The blocks are triggered by managed rules created to protect Cloudflare users." loading="lazy" width="1600" height="849"></figure>
	<h2 id="cve-2021-44228-log4j">CVE-2021-44228: Log4J</h2>
	<p>The first on our list is the notorious CVE-2021-44228 — better known as the Log4j vulnerability. This flaw caused significant disturbance in the cyber world in 2021, and continues to be exploited extensively.</p>
	<p>Cloudflare <a href="https://blog.cloudflare.com/cve-2021-44228-log4j-rce-0-day-mitigation">released new managed rules</a> within hours after the vulnerability was made public. We also released updated detections in the following days (<a href="https://blog.cloudflare.com/protection-against-cve-2021-45046-the-additional-log4j-rce-vulnerability">blog</a>). Overall, we released rules in three stages:</p>
	<ul>
		<li><a href="https://developers.cloudflare.com/waf/change-log/2021-12-10---emergency-release">Emergency release: December 10, 2021</a></li>
		<li><a href="https://developers.cloudflare.com/waf/change-log/2021-12-14---emergency-release">Emergency release: December 14, 2021</a></li>
		<li><a href="https://developers.cloudflare.com/waf/change-log/2021-12-16---emergency-release">Emergency release: December 16, 2021</a></li>
	</ul>
	<p>The rules we deployed detect the exploit in four categories: </p>
	<ul>
		<li>Log4j Headers: Attack pattern in HTTP header</li>
		<li>Log4j Body: Attack pattern in HTTP Body</li>
		<li>Log4j URI: Attack Pattern in URI</li>
		<li>Log4j Body Obfuscation: Obfuscated Attack pattern</li>
	</ul>
	<p>We have found that Log4J attacks in HTTP Headers are more common than in HTTP bodies. The graph below shows the persistence of exploit attempts for this vulnerability over time, with clear peaks and growth into July 2023 (time of writing).<br></p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2b.png" class="kg-image" alt="Log4j exploit attempt trend over the last year" loading="lazy" width="1600" height="652"></figure>
	<p>Due to the high impact of this vulnerability, to step up and lead the charge for a safer, better Internet, on March 15, 2022 <a href="https://blog.cloudflare.com/waf-for-everyone">Cloudflare announced</a> that all plans (including Free) would get WAF Managed Rules for high-impact vulnerabilities. These free rules tackle high-impact vulnerabilities such as the Log4J exploit, the Shellshock vulnerability, and various widespread WordPress exploits. Every business or personal website, regardless of size or budget, can protect their digital assets using Cloudflare’s WAF. </p>
	<p>The <a href="https://logging.apache.org/log4j/2.x/security.html">full security advisory for Log4J published by Apache Software Foundation can be found here</a>.</p>
	<h3 id="cve-2022-26134-atlassian-confluence-code-injection">CVE-2022-26134: Atlassian Confluence Code Injection</h3>
	<p>A code injection vulnerability that afflicted Atlassian Confluence was the second most exploited CVE in 2022. This exploit posed a threat to entire systems, leaving many businesses at the mercy of attackers. This is an indication of how critical knowledge-based systems have become in managing information within organizations. Attackers are targeting these systems as they recognize how &nbsp;important they are.. In response, the Cloudflare WAF team rolled out two emergency releases to protect its customers:</p>
	<ul>
		<li><a href="https://developers.cloudflare.com/waf/change-log/2022-06-04---emergency-release">Emergency Release: June 4, 2022</a></li>
		<li><a href="https://developers.cloudflare.com/waf/change-log/2022-06-07---emergency-release">Emergency Release: June 7, 2022</a></li>
	</ul>
	<p>As part of these releases, two rules were made available to all WAF users:</p>
	<ul>
		<li>Atlassian Confluence - Code Injection - CVE:CVE-2022-26134</li>
		<li>Atlassian Confluence - Code Injection - Extended - CVE:CVE-2022-26134</li>
	</ul>
	<p>The graph below displays the number of hits received each day, showing a clear peak followed by a gradual decline as systems were patched and secured.</p>
	<p>Both Log4J and Confluence Code Injection show some seasonality, where a higher volume of attacks is carried out between September / November 2022 until March 2023. This likely reflects campaigns that are managed by attackers that are still attempting to exploit this vulnerability (an ongoing campaign is visible towards the end of July 2023).</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2c.png" class="kg-image" alt="CVE-2022-26134 exploit attempt trend over the last year" loading="lazy" width="1600" height="584"></figure>
	<p><a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html">Security advisory for reference</a>.</p>
	<h2 id="cve-2021-34473-cve-2021-31207-and-cve-2021-34523-microsoft-exchange-ssrf-and-rce-vulnerabilities">CVE-2021-34473, CVE-2021-31207, and CVE-2021-34523: Microsoft Exchange SSRF and RCE Vulnerabilities</h2>
	<p>Three previously unknown bugs were chained together to achieve a Remote Code Execution (RCE) 0-day attack. Given how widely adopted Microsoft Exchange servers are, these exploits posed serious threats to data security and business operations across all industries, geographies and sectors.</p>
	<p>Cloudflare WAF published a rule for this vulnerability with the <a href="https://developers.cloudflare.com/waf/change-log/2022-10-03---emergency-release">Emergency Release: March 3, 2022</a> that contained the rule <em>Microsoft Exchange SSRF and RCE vulnerability - CVE:CVE-2022-41040, CVE:CVE-2022-41082.</em></p>
	<p>The trend of these attacks over the past year can be seen in the graph below.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2d.png" class="kg-image" alt="Microsoft Exchange exploit attempt trend over the last year" loading="lazy" width="1600" height="643"></figure>
	<p>Security advisories for reference: <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473">CVE-2021-34473</a>, <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31207">CVE-2021-31207</a> and <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523">CVE-2021-34523</a>.</p>
	<h2 id="cve-2022-1388-rce-in-big-ip-f5">CVE-2022-1388: RCE in BIG-IP F5</h2>
	<p>This particular security vulnerability can be exploited where an unauthenticated adversary has network connectivity to the BIG-IP system (the F5 product name of a group of application security and performance solutions). Either via the management interface or self-assigned IP addresses the attacker can execute unrestricted system commands. </p>
	<p>Cloudflare did an emergency release to detect this issue (<a href="https://developers.cloudflare.com/waf/change-log/2022-05-10---emergency-release">Emergency Release: May 5, 2022</a>) with the rule <em>Command Injection - RCE in BIG-IP - CVE:CVE-2022-1388.</em></p>
	<p>There is a relatively persistent pattern of exploitation without signs of specific campaigns, with the exception of a spike occurring in late June 2023.</p>
	<figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://blog.cloudflare.com/content/images/2023/08/2e.png" class="kg-image" alt="BIG-IP F5 exploit attempt trend over the last year" loading="lazy" width="1600" height="637">
		<figcaption>a</figcaption>
	</figure>
	<p><a href="https://my.f5.com/manage/s/article/K23605346">F5 security advisory for reference</a>.</p>
	<h3 id="cve-2022-22954-vmware-workspace-one-access-and-identity-manager-server-side-template-injection-remote-code-execution-vulnerability">CVE-2022-22954: VMware Workspace ONE Access and Identity Manager Server-side Template Injection Remote Code Execution Vulnerability</h3>
	<p>With this vulnerability, an attacker can remotely trigger a server-side template injection that may result in remote code execution. Successful exploitation allows an unauthenticated attacker with network access to the web interface to execute an arbitrary shell command as the VMware user. Later, this issue was combined with CVE-2022-22960 (which was a Local Privilege Escalation Vulnerability (LPE) issue). In combination, these two vulnerabilities allowed remote attackers to execute commands with root privileges.</p>
	<p>Cloudflare WAF published a rule for this vulnerability: <a href="https://developers.cloudflare.com/waf/change-log/2022-04-25">Release: May 5, 2022</a>. Exploit attempt graph over time shown below.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2f.png" class="kg-image" alt="VMware exploit attempt trend over the last year" loading="lazy" width="1600" height="635"></figure>
	<p><a href="https://www.vmware.com/security/advisories/VMSA-2022-0011.html">VMware Security advisory</a>.</p>
	<h3 id="cve-2021-26084-confluence-server-webwork-ognl-injection">CVE-2021-26084: Confluence Server Webwork OGNL injection</h3>
	<p>An OGNL injection vulnerability was found that allows an unauthenticated attacker to execute arbitrary code on a Confluence Server or Data Center instance. Cloudflare WAF performed an <a href="https://developers.cloudflare.com/waf/change-log/2021-09-01---emergency-release">emergency release for this vulnerability on September 9, 2022</a>. When compared to the other CVEs discussed in this post, we have not observed a lot of exploits over the past year.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2023/08/2g.png" class="kg-image" alt="Confluence OGNL exploit attempt trend over the last year" loading="lazy" width="1600" height="643"></figure>
	<p><a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2021-08-25-1077906215.html">Official security advisory</a>.</p>
	<h3 id="recommendations-for-enhanced-protection">Recommendations for enhanced protection</h3>
	<p>We recommend all server admins to keep their software updated when fixes become available. Cloudflare customers — including those on our free tier — can leverage new rules addressing CVEs and 0-day threats, <a href="https://developers.cloudflare.com/waf/change-log">updated weekly in the Managed Ruleset</a>. High-risk CVEs may even prompt emergency releases. In addition to this, Enterprise customers have access to the <a href="https://blog.cloudflare.com/waf-ml">WAF Attack Score</a>: an AI-powered detection feature that supplements traditional signature-based rules, identifying unknown threats and bypass attempts. With the combined strength of rule-based and AI detection, Cloudflare offers robust defense against known and emerging threats.</p>
	<h2 id="conclusions">Conclusions</h2>
	<p>Cloudflare’s data is able to augment CISA’s vulnerability report — of note, we see attempts to exploit the top two vulnerabilities that are several orders of magnitude more compared to the remainder of the list. Organizations should focus their software patching efforts based on the list provided. It is, of course, important to note that all software should be patched, and good WAF implementations will ensure additional security and “buy time” for underlying systems to be secured for both existing and future vulnerabilities.</p>
</div>