<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/12/image1-80.png" class="kg-image" alt="Protection against CVE-2021-45046, the additional Log4J RCE vulnerability"></figure>
	<p>緊接著 CVE-2021-44228 之後，隨之發佈了第二個 Log4J CVE──<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">CVE-2021-45046</a>。對於這個新的 CVE，我們<a href="https://blog.cloudflare.com/zh-tw/cve-2021-44228-log4j-rce-0-day-mitigation-zh-tw/">先前針對 CVE-2021-44228</a> 發佈的規則也能夠提供相同等級的防護。</p>
	<p>該漏洞目前正被大肆利用，因此所有使用 Log4J 的人都應盡快更新至版本 <strong>2.16.0</strong>，即使先前已更新到 2.15.0 亦然。您可以在可在 <a href="https://logging.apache.org/log4j/2.x/download.html" target="_blank">Log4J 下載頁面</a>找到最新版本。</p>
	<p>使用 Cloudflare WAF 的客戶有三條規則來幫助緩解任何漏洞利用嘗試：</p>
	<!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th>規則 ID</th>
				<th>描述</th>
				<th>預設動作</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><code>100514</code> (舊版 WAF)<br><code>6b1cc72dff9746469d4695a474430f12</code> (新版 WAF)</td>
				<td>Log4J Headers</td>
				<td><code>BLOCK</code></td>
			</tr>
			<tr>
				<td><code>100515</code> (舊版 WAF)<br><code>0c054d4e4dd5455c9ff8f01efe5abb10</code> (新版 WAF)</td>
				<td>Log4J Body</td>
				<td><code>BLOCK</code></td>
			</tr>
			<tr>
				<td><code>100516</code> (舊版 WAF)<br><code>5f6744fa026a4638bda5b3d7d5e015dd</code> (新版 WAF)</td>
				<td>Log4J URL</td>
				<td><code>BLOCK</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>該緩解被拆分為三條規則，分別檢查 HTTP 標頭、內文和 URL 。</p>
	<p>除了上述規則以外，我們也發佈了第四條規則，能夠防範更大範圍的攻擊，但代價是誤判率較高。因此我們已提供該規則，但並未預設將其設定為 BLOCK：</p>
	<!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th>規則 ID</th>
				<th>描述</th>
				<th>預設動作</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><code>100517</code> (舊版 WAF)<br><code>2c5413e155db4365befe0df160ba67d7</code> (新版 WAF)</td>
				<td>Log4J 進階 URI、標頭</td>
				<td><code>DISABLED</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="-"><strong>誰受到影響</strong></h3>
	<p>Log4J 是一個強大的 Java，基於 Apache Software Foundation 維護的記錄庫。</p>
	<p>在 &gt;= 2.0-beta9 且 &lt;= 2.14.1 的所有 Log4J 版本中，設定、記錄訊息和參數中使用的 JNDI 功能可能被攻擊者利用來執行遠端代碼。尤其是，當訊息查詢替代啟用時，能夠控制記錄訊息或記錄訊息參數的攻擊者可以執行從 LDAP 伺服器載入的任意代碼。</p>
	<p>此外，先前在版本 2.15.0 中提供的 CVE-2021-22448 緩解方法並不足以防範 CVE-2021-45046。</p>
</div>