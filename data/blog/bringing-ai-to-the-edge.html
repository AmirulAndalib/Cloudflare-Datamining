<div class="mb2 gray5">2 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1CsiZmyYfRC5NwHdHiJf7s/ccc5d338753794408e7c8bce74192013/Ai-at-the-edge-1.png" alt="" class="kg-image" width="1310" height="650" loading="lazy">

	</figure>
	<p>Cloudflare has long used machine learning for <a href="https://blog.cloudflare.com/cloudflare-bot-management-machine-learning-and-more">bot detection</a>, identifying anomalies, <a href="https://blog.cloudflare.com/using-data-science-and-machine-learning-for-improved-customer-support">customer support</a> and business intelligence. &nbsp;And internally we have a cluster of GPUs used for model training and inference.</p>
	<p>For even longer we’ve been running code “at the edge” in more than 200 cities worldwide. Initially, that was code that we wrote and any customization was done through our UI or API. About seven years ago we started deploying custom code, written in Lua, for our enterprise customers.</p>
	<p>But it’s quite obvious that using a language that isn’t widely understood, and going through an account executive to get code written, isn’t a viable solution and so four years ago we announced Cloudflare Workers. Workers allows anyone, on any plan, to write code that gets deployed to our edge network. And they can do it in the language they choose.</p>
	<p>After launching Workers we added storage through <a href="https://blog.cloudflare.com/workers-kv-is-ga">Workers KV</a> as programs need <a href="https://www.amazon.com/Algorithms-Structures-Prentice-Hall-Automatic-Computation/dp/0130224189">algorithms plus data</a>. And we’ve continued to add to the Workers platform with <a href="https://blog.cloudflare.com/introducing-workers-unbound">Workers Unbound</a>, <a href="https://blog.cloudflare.com/introducing-workers-durable-objects">Durable Objects</a>, <a href="https://blog.cloudflare.com/supporting-jurisdictional-restrictions-for-durable-objects">Jurisdictional Restrictions</a> and more.</p>
	<p>But many of today’s applications need access to the latest <a href="https://www.cloudflare.com/learning/ai/what-is-machine-learning">machine learning</a> and <a href="https://www.cloudflare.com/learning/ai/what-is-deep-learning">deep learning</a> methods. Those applications need three things: to scale easily, to securely handle models and to use familiar tools.</p>
	<p>To help anyone build AI-based applications Cloudflare is extending the Workers platform to include support for NVIDIA GPUs and TensorFlow. Soon you’ll be able to build AI-based applications that run across the Cloudflare network using pre-built or custom models for inference.</p>
	<div class="flex anchor relative">
		<h3 id="nvidia-tensorflow">NVIDIA + TensorFlow</h3>
		<a href="https://blog.cloudflare.com/#nvidia-tensorflow" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>For many years we’ve looked for appropriate hardware to run on our edge network to enable AI-powered applications. We’ve examined a wide variety of dedicated AI accelerator chips, as well as approaches that use clever encoding of the models to make them run efficiently on CPUs.</p>
	<p>Ultimately, we decided that with our large footprint of servers in more than 200 cities worldwide and the strong support for NVIDIA GPUs in AI toolkits that the best solution was a deployment of NVIDIA GPUs to enable AI-based applications. Today we <a href="https://www.cloudflare.com/press-releases/2021/cloudflare-partners-with-nvidia">announced</a> that we are partnering with NVIDIA to bring AI to our global edge network.</p>
	<p>Previously machine learning models were deployed on expensive centralized servers or using cloud services that limited them to “regions” around the world. Cloudflare and NVIDIA are putting machine learning at the edge, within milliseconds of the global online population, enabling high performance, low latency AI to be deployed by anyone.</p>
	<p>Because the models themselves remain in Cloudflare’s data centers, developers can deploy custom models without putting them on end user devices where they might risk being stolen. And because we’ll be deploying models across our large network, scaling becomes trivial and built in.</p>
	<p>TensorFlow has become one of the defacto standard libraries and toolsets for building and running AI models. Cloudflare’s edge AI will use TensorFlow allowing developers to train and optimize models using familiar tools and tests before deploying them to our edge network.</p>
	<p>In addition to building your own models using TensorFlow, we plan to offer pre-trained models for tasks such as image labeling/object recognition, text detection, and more.</p>
	<div class="flex anchor relative">
		<h3 id="nata-or-not">Nata Or Not</h3>
		<a href="https://blog.cloudflare.com/#nata-or-not" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>

	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7A8vhJ9vpeOuf2qBIZlig1/1b9ef0434f67c47b2bec8718c66ac217/Nata-or-Not_.png" alt="" class="kg-image" width="1198" height="492" loading="lazy">

	</figure>
	<p>As a demonstration of a real AI-based application running on Cloudflare’s infrastructure, the team in the Cloudflare Lisbon office built a website: <a href="https://nataornot.com">nataornot.com</a>. Upload a picture of food and it’ll tell you whether it’s one of Portugal’s delicious <a href="https://en.wikipedia.org/wiki/Pastel_de_nata">pasteis de nata</a> (an egg custard tart pastry dusted with cinnamon) or not.</p>
	<figure class="kg-card kg-image-card ">

		<img src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7k5R0ZUSDyLgYGpMYB05mK/d438ec206cb8e1a5992b88b41f873638/image1-14.png" alt="" class="kg-image" width="1260" height="1234" loading="lazy">

	</figure>
	<p>The code used a TensorFlow model built from thousands of pictures of pasteis and other foods which runs on a Cloudflare server which has an <a href="https://www.nvidia.com/en-us/data-center/a100">NVIDIA A100</a> Tensor Core GPU in it. If you want to build your own pastel de nata recognizer we’ve open sourced the TensorFlow model <a href="https://github.com/cloudflare/tensorflow-nata">here</a>.</p>
	<p>If you simply want to know whether the picture of food you have is a pastel de nata or not visit <a href="https://nataornot.com">nataornot.com</a>.</p>
	<div class="flex anchor relative">
		<h3 id="going-forward">Going Forward</h3>
		<a href="https://blog.cloudflare.com/#going-forward" aria-hidden="true" class="relative sm:absolute sm:-left-5">
			<svg width="16" height="16" viewBox="0 0 24 24">
				<path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path>
			</svg>
		</a>
	</div>
	<p>If you are interested in Workers AI, you can try it here: <a href="https://developers.cloudflare.com/workers-ai/get-started">https://developers.cloudflare.com/workers-ai/get-started/</a></p>
</div>