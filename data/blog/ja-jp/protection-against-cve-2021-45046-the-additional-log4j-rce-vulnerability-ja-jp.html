<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/12/image1-80.png" class="kg-image" alt="Protection against CVE-2021-45046, the additional Log4J RCE vulnerability" loading="lazy"></figure>
	<p>CVE-2021-44228 に続いて、Log4J の 2 つ目の CVE が、 <a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">CVE-2021-45046</a> として報告されました。<a href="https://blog.cloudflare.com/ja-jp/cve-2021-44228-log4j-rce-0-day-mitigation-ja-jp">CVE-2021-44228 に対して以前に</a>リリースしたルールは、この新しい CVE に対しても同レベルの保護を提供します。 CVE-2021から44228秒Log4JのCVEのかかと上のホットが提出された<a href="https://nvd.nist.gov/vuln/detail/CVE-2021-45046" target="_blank">CVE-2021から45046</a>。<a href="https://blog.cloudflare.com/ja-jp/cve-2021-44228-log4j-rce-0-day-mitigation-ja-jp">以前CVE-2021-44228でリリースしたルール </a> はこの新しいCVEでも同レベルの保護を提供します。</p>
	<p>この脆弱性は活発に不正利用されています。Log4J を使用している人は以前に 2.15.0 に更新していても、できるだけ早くバージョン <strong>2.16.0</strong> に更新する必要があります。最新版は<a href="https://logging.apache.org/log4j/2.x/download.html" target="_blank">Log4J ダウンロードページ</a>から入手可能です。</p>
	<p>Cloudflare WAFをご利用のお客様には、不正利用された場合の被害を軽減するために３三つのルールを設けています。</p><!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th>ルールID</th>
				<th>説明</th>
				<th>デフォルトアクション</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><code>100514</code> (旧バージョンの WAF)<br><code>6b1cc72dff9746469d4695a474430f12</code> (新バージョンの WAF)</td>
				<td>Log4J のヘッダ</td>
				<td><code>ブロック</code></td>
			</tr>
			<tr>
				<td><code>100515</code> (旧バージョンの WAF)<br><code>0c054d4e4dd5455c9ff8f01efe5abb10</code> (新バージョンの WAF)</td>
				<td>Log4J のボディ</td>
				<td><code>ブロック</code></td>
			</tr>
			<tr>
				<td><code>100516</code> (旧バージョンの WAF)<br><code>5f6744fa026a4638bda5b3d7d5e015dd</code> (新バージョンの WAF)</td>
				<td>Log4JのURL</td>
				<td><code>ブロック</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<p>この軽減措置は、HTTPヘッダー、ボディ、URLをそれぞれ検査する3つのルールに分かれています。</p>
	<p>上記のルールに加え、私たちは4つ目のルールをリリースしました。このルールは、誤検知率が高くなりますが、より広範囲の攻撃から保護することができます。そのため、私たちはこのルールを利用できるようにしましたが、デフォルトではブロックに設定されていません。上記のルールに加え４四つ目のルールをリリースしました。このルールはより高い誤検知につながるとはいっても、より広範囲の攻撃から保護することができます。そのため、このルールを利用できるようにしましたが、デフォルトでは &nbsp;BLOCKに設定されていません。</p><!--kg-card-begin: markdown-->
	<table>
		<thead>
			<tr>
				<th>ルール ID</th>
				<th>説明</th>
				<th>デフォルトアクション</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><code>100517</code> (旧バージョンの WAF)<br><code>2c5413e155db4365befe0df160ba67d7</code> (新しい WAF)</td>
				<td>Log4JアドバンストURI、ヘッダー</td>
				<td><code>無効</code></td>
			</tr>
		</tbody>
	</table>
	<!--kg-card-end: markdown-->
	<h3 id="-"><strong>影響の対象</strong></h3>
	<p>Log4jは、Apache Software Foundationが管理するJavaベースの強力なロギングライブラリです。</p>
	<p>すべての Log4j 2.0-beta9 から 2.14.1 までのバージョンにおいて、構成、ログメッセージ、およびパラメータで使用される JNDI 機能は、攻撃者に悪用され、リモートでコードが実行される可能性があります。具体的には、ログメッセージやログメッセージのパラメーターを制御できる攻撃者は、メッセージのルックアップ置換が有効な場合、LDAP サーバーから読み込んだ任意のコードを実行できます。</p>
	<p>また、バージョン 2.15.0 に見られる CVE-2021-22448 での旧緩和策は、CVE-2021-45046 を保護するには十分ではありませんでした。<br></p>
</div>