<div class="mb2 gray5 ">5 分で読了</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/1-8.png" class="kg-image" alt="" loading="lazy"></figure>
	<p>Cloudflare R2 Storageを発表できることを、実に嬉しく思います。開発者が大量の非構造化データを格納できるようにすることで、Cloudflareでできることを拡大しつつ、代表的なクラウドプロバイダーストレージサービスに関わるエグレス帯域幅料金をゼロにします。</p>
	<p>Cloudflare R2 StorageはS3 API完全互換性を備え、既存のツールやアズビルトのアプリケーションと連携して機能します。</p>
	<p>R2の詳細についてみていきましょう。</p>
	<h3 id="r2-really-requestable-">R2は「Really Requestable」（真にリクエスト可能な）という意味</h3>
	<p>オブジェクトストレージはBlobストレージとも呼ばれるもので、任意の大きさの非構造化ファイルを格納します。オブジェクトストレージは、メディアファイルやログファイル、アプリケーション固有のメタデータまで、あらゆるファイルの格納に適しており、ファイル取得時の遅延が均一で耐久性が高く、容量無制限です。</p>
	<p>オブジェクトストレージのためのAPIとAPI R2の実装で最も身近な例は、AmazonのSimple Storgae Service（S3）です。2006年にS3が開始された時、クラウドストレージサービスは開発者にとっては思わぬ幸運でした。一足飛びの変化ではなかったものの、開発者は過去15年間にわたって、クラウドストレージと無制限のストレージ空間を歓迎してきました。</p>
	<p>クラウドストレージは画期的ではありましたが、デメリットもありました。データを取り出す時です。時間とともに、企業はクラウドプロバイダーネットワークに大量のデータを集めるようになりました。企業がクラウドからデータを取り出そうとすると、どんな顧客価値にも見合わない<a href="https://blog.cloudflare.com/aws-egregious-egress">高額なエグレス料金</a>が発生したのです。開発者が支払いに慣れてしまった税金のような感じです。</p>
	<p>R２の登場</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/2-3.png" class="kg-image" alt="Cloudflare R2は、「Removing Ridiculous Fees」（馬鹿げた料金を撤廃する）という意味" loading="lazy"></figure>
	<p>従来のオブジェクトストレージでは、帯域幅、ストレージサイズ、ストレージ操作の3つについて料金を徴収していました。</p>
	<p>R2はCloudflareがこれまで力を注いできた<a href="https://www.cloudflare.com/ja-jp/bandwidth-alliance">Bandwidth Alliance</a>に基づいて構築されたもので、お客様のリクエスト率に関係なく、格納されたオブジェクトのエグレスコストをゼロにします。エグレス帯域幅の料金は、オブジェクトストレージを利用している開発者にとって最も高額なコストになりがちで、予測が最も難しい料金でもあります。エグレス料金の撤廃は、クラウドに保存されたデータへのオープンアクセスにとってこの上ない吉報です。</p>
	<p>だからといって、帯域幅の費用をどこかに転嫁しようとしているわけではありません。Cloudflare R2の利用料金はデータ格納量1GBあたり月額0.015ドルになる予定で、大手プロバイダーの現行水準よりもはるかに安い設定です。 </p>
	<p>オブジェクトへのアクセス頻度が低ければ、プロバイダーのサポートは取るに足らないものですが、同じように操作ごとの料金が課せられます。Cloudflareでは、典型的なオブジェクトストレージ料金は公正ではないと感じていました。1秒に1回リクエストする開発者と1秒に何千回もリクエストする企業（交渉でボリュームディスカウントを得ていて頻度がより高くなることが多いでしょう）が、同じ料金が課せられるからです。<br><br>裏を返せば、アクセス頻度が低いことを想定して設計しているプロバイダーは、使用料が大幅に増えるとスケーリングできないことが多いのです。</p>
	<p>R2では、ストレージ操作の頻度が閾値より低い場合は、ゼロレートを適用します。現在の計画では、閾値は1秒ごとに1桁のリクエストになる見込みです。この範囲を超えると、R2は大手プロバイダーより遥かに低い料金を課します。Cloudflareのオブジェクトストレージは、アクセス頻度が低い場合は非常に安く、それでいてスケーリング可能で、頻繁にアクセスしても大手プロバイダーよりも低料金になります。</p>
	<p>料金が低いからといって、スケーラビリティが劣るわけではありません。舞台裏では、R2は自動的かつインテリジェントにデータの階層化を管理しており、ピーク時の負荷にも耐えられるパフォーマンスを提供しつつ、リクエスト頻度が低いオブジェクトについては低コストを実現します。Cloudflareでは開発者が常にオブジェクトストレージに求めてきたもの、つまり「無制限のスケールを可能な限り低コストで」を実現するために、複雑で手動階層化が必要なポリシーを排除しました。</p>
	<h3 id="r2-repositioning-records-">R2は「Repositioning Records」（レコードを再配置する）という意味</h3>
	<p>エグレス料金がゼロのため、オブジェクトを簡単に取り出すことができますが、オブジェクトをクラウドに載せる時はどうでしょうか？クラウドプロバイダー間のデータ移行は、両者がS3 APIを完全にサポートしていても、エラーが発生しやすく、コストも高くなります。</p>
	<p>この作業を簡単にし、お客様側でツール変更を行わなくて済むように、CloudflareがS3互換クラウドストレージサービスからの移行サービスを提供します。この移行サービスは、リクエストされたオブジェクトをR2に少しずつコピーすることによって、オブジェクトを手作業でアップロードする手間を減らします。このマルチクラウドアーキテクチャによって、移行済みのオブジェクトをR2から配信でき、お金を節約しながらマルチクラウドのメリットを享受できます。</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/3-3.png" class="kg-image" alt="R2は高額なエグレス帯域幅料金を課すプロバイダーからのデータを自動的に複製し、ターゲットバケットの設定だけで瞬時に料金を節約します。" loading="lazy"></figure>
	<p>Cloudflareでは、 R2にマルチリージョンストレージを組み込んでリクエストの多いロケーションへ自動的にオブジェクトを複製するようにしたいと考えています。<a href="https://blog.cloudflare.com/supporting-jurisdictional-restrictions-for-durable-objects">Durable Objects</a>と同様に、Cloudflareでは、法域による制約を導入して、開発者がシンプルなAPIを通じて複雑なデータ主権の要件に準拠できるようにする予定です。</p>
	<h3 id="r2-ridiculously-reliable-">R2は「Ridiculously Reliable」（途方もなく信頼できる）という意味</h3>
	<p>オブジェクトストレージが優れているのは信頼性です。Cloudflareではデータの耐久性とレジリエンスを中核に据えてR2を設計しました。R2は、データ損失の起こりにくさを示す年間耐久性が99.999999999%（9が11個）です。仮に、R2に100万件のオブジェクトを格納した場合、10万年に一度、データを1つ損失する可能性があるということになります。これは他の大手プロバイダーと同レベルの耐久性です。R1は、地域的な障害に耐性があり、高可用性を実現するためにオブジェクトを複数回複製します。</p>
	<p>R2は信頼性を確保するため、多地域にわたる冗長性を備えた設計になっています。Cloudflareでは自動化されたグローバルな分散からはじめ、データをローカルに格納する必要がある場合に備え、上で説明したように、地域に特化した制御の追加を予定しています。</p>
	<h3 id="r2-radically-reprogrammable-">R2は「Radically Reprogrammable」（根本的に再プログラム可能な）という意味</h3>
	<p>R2は、Cloudflare Workersのサーバレスランタイムと完全統合されています。Workerを特定のバケットに結び付けて、オブジェクトがストレージバケットに書き込まれたりバケットから読み込まれたりしている間に動的に変換することができます。WorkersとR2が深く統合することにより、データパイプラインの構築とオブジェクトの操作が驚くほど簡単になります。</p>
	<p>Cloudflare R2は、Cloudflareの他の製品と簡単に統合するように設計されています。少し例を挙げると、当社では、R2をバックアップターゲットとしてDurable Objectsを設定できるように計画しています。さらに、R2とCloudflare Cache間で自動統合ができるようにし、更新頻度の低いオブジェクトのキャッシュ寿命を大幅に伸ばすことも計画しています。</p>
	<h3 id="cloudflare-r2-">Cloudflare R2でお客様は何を構築できるか？</h3>
	<p>特にWorkersのコンピューティングプラットフォームへのアクセスがすぐそばに配置されているため、長期ストレージに関してできることはたくさんあります。</p>
	<p>例えば、R2のおかげで多くのIoT デバイスからデータを配信することがとても簡単になります。まずWorkersでデータを変換、操作し、R2が大量のセンサーデータを取り込み、低コストで格納できます。エグレス料金が不要のため、必要に応じて大量のデータを複数のデータベースに移行したり、分析ソリューションに移行する作業がシンプルになり、格納コストを大幅に削減できます。発信データ上でもWorkersを稼働できることから、データパイプラインの柔軟性もより高いものになっています。</p>
	<p>R2は、CDNアセットや大きなメディアファイルにとっても最高の場所です。大きなファイルについては、R2でエグレス料金を大幅に削減しながら、キャッシュ寿命を大幅に延ばすことができます。Cache APIとWorkersと組み合わせることで、グローバルなアクセスでも少ない遅延でコンテンツを動的にキャッシュすることができます。</p>
	<p>そして何よりも、R2にはエグレス帯域幅料金がないため、頻繁にアクセスするコンテンツの格納に適しています。現在、R2は重いリクエストロードを処理するための高い拡張性を備え、お客様のオブジェクトを動的に階層化して、最低料金で最高のパフォーマンスを提供します。この動的階層化のおかげで、ピークパフォーマンスをサポートしながら、最低価格を提供することができ、ユーザーによる設定も不要になっています。</p>
	<h3 id="cloudflare-r2--1">Cloudflare R2へのアクセス</h3>
	<p>R2は現在開発中です。アクセス順番待ちリストへの登録は、<a href="https://www.cloudflare.com/ja-jp/r2-storage">こちらから</a>サインアップできます。多くの早期ユーザーのみなさまと、製品の改良・テストに取り組めることを楽しみにしています。オープンベータ版を発表する予定ですので、まもなくユーザーはどなたでも、こちらからサービスにサインアップできるようになる予定です。</p>
	<p>Cloudflareでは引き続き製品を構築できることを嬉しく思っており、オープンベータ版の公開に向けて尽力していきます。私たちは、Cloudflareエッジでのストレージについて壮大な未来像を描いています。分散システムエンジニアで、エッジの将来を築くことに貢献したいとお考えの方は、<a href="https://www.cloudflare.com/ja-jp/careers/jobs/?department=Emerging+Technology+and+Incubation&amp;location=default">ぜひ一緒に働きませんか</a>！</p>
</div>