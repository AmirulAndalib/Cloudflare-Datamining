<div class="mb2 gray5">12 min read</div>
<div class="post-content lh-copy gray1">
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/image3-14.png" class="kg-image" alt="Cloudflare Research: Two Years In" loading="lazy"></figure>
	<blockquote>Great technology companies build innovative products and bring them into the world; iconic technology companies change the nature of the world itself.</blockquote>
	<p>Cloudflareâ€™s mission reflects our ambitions: to help build a better Internet. Fulfilling this mission requires a multifaceted approach that includes ongoing product innovation, strategic decision-making, and the audacity to challenge existing assumptions about the structure and potential of the Internet. <a href="https://blog.cloudflare.com/cloudflares-approach-to-research">Two years ago</a>, Cloudflare Research was founded to explore opportunities that leverage fundamental and applied computer science research to help change the playing field.</p>
	<p>Weâ€™re excited to share five operating principles that guide Cloudflareâ€™s approach to applying research to help build a better Internet and five case studies that exemplify these principles. Cloudflare Research will be all over the blog for the next several days, so subscribe and follow along!</p>
	<h2 id="innovation-comes-from-all-places"><strong>Innovation</strong> comes from all places</h2>
	<p>Innovative companies donâ€™t become innovative by having one group of people within the company dedicated to the future; they become that way by having a culture where new ideas are free-flowing and can come from anyone. Research is most effective when it is permitted to grow beyond or outside isolated lab environments, is deeply integrated into all facets of a companyâ€™s work, and connected with the world at large. We think of our research team as a support organization dedicated to identifying and nurturing ideas that are between three and five years away.</p>
	<p>Cloudflare Research prioritizes strong collaboration to stay on top of big questions from our product, ETI, engineering teams and industry. Within Cloudflare, we learn about problems by embedding ourselves within other teams. Externally, we invite visiting researchers and academia, sit on boards and committees, contribute to open standards design and development, attend dozens of tech conferences a year, and publish papers in conferences.</p>
	<p>Research engineering is<em> truly full-stack</em>. We incubate ideas from conception to prototype through to production code. Our team employs specialists from academic and industry backgrounds and generalists that help connect ideas across disciplines. We work closely with the product and engineering organizations on graduation plans where code ownership is critical. We also hire many research interns who help evaluate and de-risk new ideas before we help build them into production systems and eventually hand them off to other teams at the company.</p>
	<p>Research questions can come from all parts of the company and even from customers. Our collaborative approach has led to many positive outcomes for Cloudflare and the Internet at large.</p>
	<h3 id="case-study-1-password-security">Case Study #1: Password security</h3>
	<p>Several years ago, a service called <a href="https://haveibeenpwned.com">Have I Been Pwned</a>, which lets people check if their password has been compromised in a breach, started using Cloudflare to keep the site up and running under load. However, the setup also highlighted a privacy issue: Have I Been Pwned would inevitably have access to every password submitted to the service, making it a juicy target for attackers. This insight raised the question: can such a service be offered in a privacy-preserving way?</p>
	<p>Like much of the research teamâ€™s work, the kernel of a solution came from somewhere else at the company. The first work on the problem came from members of the support engineering organization, who developed a <a href="https://blog.cloudflare.com/validating-leaked-passwords-with-k-anonymity">clever solution</a> that mostly solved the problem. However, this initial investigation outlined a deep and complex problem space that could have applications far beyond passwords. At this point, the research team got involved and reached out to experts, including Thomas Ristenpart at Cornell Tech, to help study it more deeply.</p>
	<p>This collaboration led us down a path to devise a new protocol and publish a paper entitled <a href="https://dl.acm.org/doi/pdf/10.1145/3319535.3354229">Protocols for Checking Compromised Credentials</a> at <a href="https://www.sigsac.org/ccs/CCS2021">ACM CCS 2019</a>. The paper pointed us in a direction, but a desire to take this research and make it applicable to people led us to host our first visiting researcher to help build a prototype. We found even more inspiration and support internally when we learned that another team at Cloudflare was interested in adding capabilities to the Cloudflare <a href="https://www.cloudflare.com/waf">Web Application Firewall</a> to detect breached passwords for customers. This team ended up helping us build the prototype and integrate it into Cloudflareâ€™s service.</p>
	<p>This combination of customer insight, internal alignment, and external collaboration not only resulted in a powerful and unique <a href="https://blog.cloudflare.com/patching-the-internet-against-global-brute-force-campaigns">customer feature</a>, but it also helped advance the state of the art in privacy-preserving technology for an essential aspect of our online lives: Authentication. Weâ€™ll be making an exciting announcement around this technology on Thursday, so stay tuned.</p>
	<h2 id="a-question-oriented-approach-leads-to-better-products"><strong>A question-oriented approach</strong> leads to better products</h2>
	<p>To support Cloudflareâ€™s fast-paced roadmap, the Research team takes a question-first approach. Focusing on questions is the essence of research itself, but itâ€™s important to recognize what that means for an industry-leading company. We never stop asking big questions about the problems our products are already solving. Changes like the move from desktop to mobile computing or the transition from on-premise security solutions to the cloud happened within a decade, so itâ€™s important to ask questions like:</p>
	<ul>
		<li>How will social and geopolitical forces changes impact the products weâ€™re building today?</li>
		<li>What assumptions may be present in existing systems based on the homogenous experiences of their creators?</li>
		<li>What changes are happening in the industry that will affect the way the Internet works?</li>
		<li>What opportunities do we see to leverage new and lower-cost hardware?</li>
		<li>How can we scale to meet growing needs?</li>
		<li>Are there new computing paradigms that need to be understood?</li>
		<li>How are user expectations shifting?</li>
		<li>Is there something we can build to help move the Internet in the right direction?</li>
		<li>Which security or privacy risks are likely to be exacerbated in the coming years?</li>
	</ul>
	<p>By focusing on broader questions and being open to answers that donâ€™t fit within the boundaries of existing solutions, we have the opportunity to see around corners. This type of foresight helps solve more than business problems; it can help improve products and the Internet at large. These types of questions are asked across the R&amp;D functions of the company, but research focuses on the questions that arenâ€™t easily answered in the short-term.</p>
	<h3 id="case-study-2-ssl-tls-recommender">Case Study #2: SSL/TLS Recommender</h3>
	<p>When Cloudflare made <a href="https://blog.cloudflare.com/introducing-universal-ssl">SSL certificates free and automatic</a> for all customers, it was a big step towards securing the web. One of the early criticisms of Cloudflareâ€™s SSL offerings was the so-called â€œmulletâ€ critique. Cloudflare offers a mode called â€œFlexible SSL,â€ which enables encryption between the browser and Cloudflare but keeps the connection between Cloudflare and the origin site unencrypted for backward compatibility. Itâ€™s called the mullet criticism because Flexible SSL provides encryption on the front half of the connection but none on the back half.</p>
	<p>Most security risks for online communication occur between the user and Cloudflare (at the ISP or in the coffee shop, for example), not between Cloudflare and the origin server. The customers who couldnâ€™t enable encryption on their servers had a much better security posture with Cloudflare.</p>
	<p>In a few isolated instances, however, a customer did not take advantage of the most secure configuration possible, which resulted in unexpected and impactful security problems. Given the non-zero risk and acknowledging this valid product critique, we asked: what <em>could we do to improve the security posture of millions of websites?</em></p>
	<p>With the help of research interns with Internet scanning and measurement expertise, we built an advanced scanning/crawling tool to see how much things could be improved. It turned out we could do a lot, so we worked with various teams across the company to connect our scanning infrastructure to Cloudflareâ€™s product. We now offer a service to all customers called the <a href="https://developers.cloudflare.com/ssl/origin-configuration/ssl-tls-recommender">SSL/TLS recommender</a> that has helped thousands of customers secure their sites and trim their mullets. The underlying reason that websites donâ€™t use encryption for parts of their backends is complex, and what makes this project a good example of asking questions in a pragmatic way is that it not only gives Cloudflare an improved product, but it gives researcher set of tools to further explore the fundamental problem.</p>
	<h2 id="build-the-tools-today-to-deal-with-the-issues-of-tomorrow">Build the tools today to deal with the issues of tomorrow</h2>
	<p>Another critical objective of research in the Cloudflare context is to help us prepare for the unknown. We identify and solve "what-if" scenarios based on how society is changing or may change. Thousands of companies rely on our infrastructure to serve their users and meet their business needs. We are continually improving their experience by future-proofing the technology that supports them during the best of times and the potential worst of times.</p>
	<p>To prepare, we:</p>
	<ol>
		<li>Identify areas of future risk.</li>
		<li>Explore the fundamentals of the problem.</li>
		<li>Build expertise and validate that expertise in peer-reviewed venues.</li>
		<li>Build operating experience with prototypes and large-scale experiments.</li>
		<li>Build networks of relationships with those who can help in a crisis.</li>
	</ol>
	<p>We would like to emulate the strategic thinking and planning required of the often unseen groups that support society â€” like the <a href="https://www.cafiresci.org/research-publications">forestry service</a> or a public health department. When the fire hits or the next virus arrives, we have the best chance to not only get through it but to innovate and flourish because of the mitigations put in place and the relationships built while thinking through impending challenges.</p>
	<h3 id="case-study-3-ip-address-agility">Case Study #3: IP Address Agility</h3>
	<p>One area of impending risk for the Internet is the exhaustion of IPv4 addresses. There are only around four billion potential IPv4 addresses, which is fewer than the number of humans globally, let alone the number of Internet-connected devices. We decided to examine this problem more deeply in the context of Cloudflareâ€™s unique approach to networking.</p>
	<p>Cloudflareâ€™s architecture challenges several assumptions about how different aspects of the Internet relate to each other. Historically, a server IP address corresponds to a specific machine. Cloudflareâ€™s anycast architecture and server design allow any server to serve any customer site. This architecture has allowed the service to scale in incredible ways with very little work.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/unnamed-7.png" class="kg-image" alt="IP Bindings Stifle Innovation" loading="lazy"></figure>
	<p>This insight led us to question other fundamental assumptions about how the Internet could potentially work. If an IP address doesnâ€™t need to correspond with a specific server, what else could we decouple from it? Could we decouple hostnames from IPs? Maybe we could! We could also frame the question negatively: what do we lose if we donâ€™t take advantage of this decoupling? It was worth an experiment, at least.</p>
	<p>We decided to validate this assumption empirically. We ran an experiment serving all free customers from the same IP in an entire region in a cross-organizational effort that involved the DNS team, the IP addressing team, and the <a href="https://blog.cloudflare.com/unimog-cloudflares-edge-load-balancer">edge load balancing team</a>. The experiment proved that using a single IP for millions of services was feasible, but it also highlighted some risks. The result was <a href="https://dl.acm.org/doi/10.1145/3452296.3472922">a paper</a> published in <a href="https://conferences.sigcomm.org/sigcomm/2021">ACM SIGCOMM 2021</a> and a project to re-architect our authoritative DNS system to be infinitely more flexible. </p>
	<h2 id="going-further-together">Going further <strong>together</strong></h2>
	<p>The Internet is not simply a loose federation of companies and billions of dollars of deployed hardware; itâ€™s a network of interconnected relationships with a global societal impact. These relationships and the technical standards that govern them are the connective tissue that allows us to build important aspects of modern society on the Internet.</p>
	<p>Millions of Internet properties use Cloudflareâ€™s network, which serves tens of millions of requests per second. The decisions we make, and the products we release, have significant implications on the industry and billions of people. For the majority of cases, we only control one side of the Internet connection. To serve billions of users and Internet-connected devices, we are governed by and need to support protocols such as DNS, BGP, TLS, and QUIC, defined by technical standards organizations like the Internet Engineering Task Force (IETF).</p>
	<p>Protocols evolve, and new protocols are constantly changing to serve the evolving needs of the Internet. An important part of our mission to help build a more secure, more private, more performant, and more available Internet involves taking a leadership role in shaping these protocols, deploying them at scale, and building the open-source software that implements them.</p>
	<h3 id="case-study-4-oblivious-dns">Case Study #4: Oblivious DNS</h3>
	<p>When Cloudflare launched the 1.1.1.1 recursive DNS service in 2019, privacy was again at the forefront. We offered 1.1.1.1 with a new encryption standard called <a href="https://blog.cloudflare.com/dns-encryption-explained">DNS-over-HTTPS</a> (DoH) to keep queries private as they travel over the Internet. However, even with DoH, a DNS query is associated with the IP address of the user who sent it. Cloudflare wrote a privacy policy and created technical measures to ensure that user IP data is only kept for a short amount of time and even engaged a top auditing firm to <a href="https://blog.cloudflare.com/announcing-the-results-of-the-1-1-1-1-public-dns-resolver-privacy-examination">confirm this</a>. But still, the question remained, could we offer the service without needing to have this privacy-sensitive information in the first place? We created the <a href="https://blog.cloudflare.com/welcome-hidden-resolver">Onion Resolver</a> to let users access the service over the Tor anonymity network, but it was extremely slow to use. Could we offer cryptographically private DNS with acceptable performance? It was an open problem.</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/unnamed--1-.png" class="kg-image" alt="The ODoH architecture" loading="lazy"></figure>
	<p>The breakthrough came through a combination of sources. We learned about new results out of academia describing a novel proxying technique called <a href="https://www.sciendo.com/article/10.2478/popets-2019-0028">Oblivious DNS</a>. We also found other folks in the industry from Apple and Fastly who were working on the same problem. The resulting proposal combined Oblivious DNS and DoH into an elegant protocol called Oblivious DoH (or ODoH). ODoH was <a href="https://datatracker.ietf.org/doc/html/draft-pauly-dprive-oblivious-doh-07">published</a> and discussed extensively at the IETF. DNS is an especially standards-dependent protocol since different parties operate so many components of the system. ODoH adds another participant to the equation, making careful interoperability standards even more critical.</p>
	<p>The research team took an early draft of ODoH and, with the help of an intern (whose experience on the team youâ€™ll hear from tomorrow), we built a prototype on Cloudflare Workers. With it, we measured the performance and confirmed the viability of a large-scale ODoH deployment, leading to <a href="https://www.sciendo.com/article/10.2478/popets-2021-0085">this paper</a>, published at <a href="https://petsymposium.org">PoPETS 2021</a>.</p>
	<p>The results of our experimentation gave us the confidence to build a production-quality implementation. Our research engineers worked with the engineers on the resolver team to implement and <a href="https://blog.cloudflare.com/oblivious-dns">launch ODoH</a> for 1.1.1.1. We also <a href="https://github.com/search?q=org%3Acloudflare+odoh">open-sourced</a> ODoH-related code in Go, Rust, and a Cloudflare Workers-compatible implementation. We also worked with the open source community to land the protocol in widely available tools, like <a href="https://www.dnscrypt.org">dnscrypt</a>, to help further ODoH adoption. ODoH is just one example of cross-industry work to develop standards that youâ€™ll learn more about in an upcoming post.</p>
	<h2 id="from-theory-to-practice-at-a-global-scale">From theory to practice at a global scale</h2>
	<p>There are thousands of papers published at dozens of venues every year on Internet technology. The ideas in academic research can change our fundamental understanding of the world scientifically but often havenâ€™t impacted users yet. Innovation comes from all places, and it's important to adopt ideas from the wider/outside community since we're in a fortunate position to do so.</p>
	<p>As an academic, you are rewarded for the breakthrough, not the follow-through. We value the ability to pursue, even drive, the follow-through because of the tangible improvements challenges offer to the Internet. We find that we can often learn much more about an idea by building and deploying it than by only thinking it up and writing it down. The smallest wrinkle in a lab environment or theoretical paper can become a large issue at Internet scale, and seemingly minor insights can unlock enormous potential.</p>
	<p>We are grateful at Cloudflare to be in a rare position to leverage the diversity of the Internet to further existing research and study its real-world impact. We can bring the insights and solutions described in papers to reality because we have the insight into user behavior required to do it: right now, <em>nearly every user on the Internet uses Cloudflare directly or indirectly.</em></p>
	<p>We also have enough scale that problems that could have been solved conventionally must now use new tools. For example, cryptographic tools like identity-based encryption and zero-knowledge proofs have been around on paper for decades. They have only recently been deployed in a few live systems but are now emerging as valuable tools in the conventional Internet and have real-life impact.</p>
	<h3 id="case-study-5-cryptographic-attestation-of-personhood">Case Study #5: Cryptographic Attestation of Personhood</h3>
	<p>In Case Study #4, we explored a deep and fundamental networking question. As fun as exploring the plumbing can be, itâ€™s also important to explore user experience questions because clients and customers can immediately feel them. A big part of Cloudflareâ€™s value is protecting customers from bots, and one of the tools we use is the CAPTCHA. People <a href="https://twitter.com/Nazenko/status/1337987291483136002">hate</a> CAPTCHAs. Few aspects of the web experience inspire more seething anger in the user experience than being stopped and asked to identify street signs and trucks in low-res images when trying to go to a site. Furthermore, the most common CAPTCHAs are inaccessible to many communities, including the blind and the visually impaired. The Bots team at Cloudflare has made great strides to reduce the number of CAPTCHAs shown on the server-side using <a href="https://www.cloudflare.com/learning/ai/what-is-machine-learning">machine learning</a> (a challenging problem in itself). We decided to complement their work by asking if we could leverage accessibility on the client-side to provide equivalent protection to a CAPTCHA?</p>
	<figure class="kg-card kg-image-card"><img src="https://blog.cloudflare.com/content/images/2021/10/unnamed--2-.png" class="kg-image" alt="the user workflow of CAP" loading="lazy"></figure>
	<p>This question led us down the path to developing a new technique we call the <a href="https://blog.cloudflare.com/introducing-cryptographic-attestation-of-personhood">Cryptographic Attestation of Personhood (CAP)</a>. Instead of users proving to Cloudflare that they are human by performing a human task, we could ask them to prove that they have trusted physical hardware. We identified the widely deployed WebAuthn standard to do this so that millions of users could leverage their hard security keys or the hardware biometric system built into their phones and laptops.</p>
	<p>This project raised several exciting and profound privacy and user experience questions. With the help of a research intern experienced in anonymous authentication, we published a <a href="https://eprint.iacr.org/2021/1183">paper</a> at <a href="https://www.sac2021.ca">SAC 2021</a> that leveraged and improved upon zero-knowledge <a href="https://blog.cloudflare.com/introducing-zero-knowledge-proofs-for-private-web-attestation-with-cross-multi-vendor-hardware">cryptography systems</a> to add additional privacy features to our solution. Cloudflareâ€™s ubiquity allows us to expose millions of users to this new idea and understand how itâ€™s understood: for example, do users think sites can collect biometrics from their users this way? We have an upcoming paper submission (with the user research team) about these user experience questions.</p>
	<p>Some answers to these research-shaped questions are surprising, some werenâ€™t, but in all cases, the outcome of taking a questions-oriented approach was tools for solving problems.</p>
	<h2 id="what-to-expect-from-the-blog">What to expect from the blog</h2>
	<p>As mentioned above, Cloudflare Research will be all over the Cloudflare blog in the next several days to make several announcements and share technical explainers, including:</p>
	<ul>
		<li>A new landing page where you can read our research and find additional resources.</li>
		<li>Technical deep dives into research papers and standards, including the projects referenced above (and MANY more).</li>
		<li>Insights into our process and ways to collaborate with us.</li>
	</ul>
	<p>Happy reading!</p>
</div>